000100100713     H*‚--------------------------------------------------------------------    000200100713     H*ˆCOPYRIGHT DATABOROUGH LTD 2010                                          000300100713     H*‚--------------------------------------------------------------------    000400100713     H debug(*yes) copyright('Databorough Ltd. 2010') datedit(*dmy)             000500100713     H option(*srcstmt:*nodebugio:*showcpy)                                     000600100713     F**********************************************************************    000700100713     F*‚F i l e s                                                               000800100713     F**********************************************************************    000900100713     Fslmen     if   e           k disk                                         001000100713     Fconhdrl2  if   e           k disk                                         001100100713     Fcustsl2   if   e           k disk                                         001200100713     Fdelival1  if   e           k disk                                         001300100713     Ftrnhstl5c if   e           k disk                                         001400100713     Fcntlf1    if   e           k disk                                         001500100713     Fqsysprt   o    f  132        printer oflind(*INOF)                        001600100713                                                                                001700100713     D**********************************************************************    001800100713     D*‚D e f i n i t i o n s                                                   001900100713     D**********************************************************************    002000100713     D conhdrcount     s              7p 0                                      002100100713     D custscount      s              7p 0                                      002200100713     D delivacount     s              7p 0                                      002300100713     D trnhstcount     s              7p 0                                      002400100713     D cntlfcount      s              7p 0                                      002500100713     D tyme            s              6s 0                                      002600100713     D today           s              8s 0                                      002700100713                                                                                002800100713     D conhdrk       e ds                  extname(conhdrl2:*key)  prefix(a)    002900100713     D custsk        e ds                  extname(custsl2:*key)   prefix(b)    003000100713     D delivk        e ds                  extname(delival1:*key)  prefix(c)    003100100713     D trnhstk       e ds                  extname(trnhstl5c:*key) prefix(d)    003200100713     D cntlfk        e ds                  extname(cntlf1:*key) prefix(e)       003300100713                                                                                003400100713     C**********************************************************************    003500100713     C*‚M a i n l i n e   C o d e                                               003600100713     C**********************************************************************    003700100713      /free                                                                     003800100713        *inof = *on;                                                            003900100713       //‚For each salesman record                                              004000100713       setll *loval rslmen;                                                     004100100713       read(e) rslmen;                                                          004200100713       dow not %eof(slmen);                                                     004300100713                                                                                004400100713       conhdrcount = *zeros;                                                    004401110914       //conhdrcnt = *zeros;                                                    004500100713       custscount = *zeros;                                                     004600100713       delivacount = *zeros;                                                    004700100713       trnhstcount = *zeros;                                                    004800100713       cntlfcount  = *zeros;                                                    004900100713                                                                                005000100713       //‚Count CONHDR records                                                  005100100713           aperson = person;                                                    005200100713           setll %kds(conhdrk:1) conhdrr;                                       005300100713           reade(e) %kds(conhdrk:1) conhdrr;                                    005400100713           dow not %eof(conhdrl2) and not %eof;                                 005500100713               conhdrcount = conhdrcount + 1;                                   005501110914               //trnhstcount = *zeros;                                          005600100713               reade(e) %kds(conhdrk:1) conhdrr;                                005700100713           enddo;                                                               005800100713                                                                                005900100713                                                                                006000100713       //‚Count CUSTS records                                                   006100100713           bperson = person;                                                    006200100713           setll %kds(custsk:1) custsr;                                         006300100713           reade(e) %kds(conhdrk:1) custsr;                                     006400100713           dow not %eof(custsl2) and not %eof;                                  006500100713               custscount = custscount + 1;                                     006501110914               //trnhstcount = *zeros;                                          006600100713               reade(e) %kds(custsk:1) custsr;                                  006700100713           enddo;                                                               006800100713                                                                                006900100713       //‚Count DELIVA records                                                  007000100713           cperson = person;                                                    007100100713           setll %kds(delivk:1) delivar;                                        007200100713           reade(e) %kds(delivk:1) delivar;                                     007300100713           dow not %eof(delival1) and not %eof;                                 007400110914               delivacount = delivacount + 1;                                   007401110914               //trnhstcount = *zeros;                                          007500100713               reade(e) %kds(delivk:1) delivar;                                 007600100713           enddo;                                                               007700100713                                                                                007800100713       //‚Count TRNHST records                                                  007900100713           dperson = person;                                                    008000100713           setll %kds(trnhstk:1) trnhstr;                                       008100100713           reade(e) %kds(trnhstk:1) trnhstr;                                    008200100713           dow not %eof(trnhstl5c) and not %eof;                                008300100713               trnhstcount = trnhstcount + 1;                                   008400100713               reade(e) %kds(trnhstk:1) trnhstr;                                008500100713           enddo;                                                               008600100713                                                                                008700100713       //‚Count CNTACS records                                                  008800100713           esinit = person;                                                     008900100713           setll %kds(cntlfk:1) rcntac;                                         009000100713           reade(e) %kds(cntlfk:1) rcntac;                                      009100100713           dow not %eof(cntlf1) and not %eof;                                   009200100713               cntlfcount = cntlfcount + 1;                                     009300100713               reade(e) %kds(cntlfk:1) rcntac;                                  009400100713           enddo;                                                               009500100713                                                                                009600100713       //‚Output totals for salesman                                            009700100713          if *inof;                                                             009800100713             except headings;                                                   009900100713             *inof = *off;                                                      010000100713          endif;                                                                010100100713                                                                                010200100713          except totals;                                                        010300100713                                                                                010400100713       read(e) rslmen;                                                          010500100713       enddo;                                                                   010600100713                                                                                010700100713       //‚Terminate program and exit                                            010800100713       *inlr = *on;                                                             010900100713       return;                                                                  011000100713      /end-free                                                                 011100100713     C**********************************************************************    011200100713     C*‚* I N Z S R                                                             011300100713     C**********************************************************************    011400100713     C     *inzsr        begsr                                                  011500100713     C                   time                    tyme                           011600100713     C                   z-add     *date         today                          011700100713     C                   endsr                                                  011800100713     Oqsysprt   e            headings       1 01                                011900100713     O                                           10 'X-Analysis'                012000100713     O                                           60 'Audit log for file: SLMEN' 012100100713     O                                          132 'Databorough LTD.'          012200100713     O          e            headings       1                                   012300100913     O                                           10 'ZAUDSLMEN '                012400100713     O                       tyme               120 '  :  :  '                  012500100713     O                       today              132 '  /  /    '                012600100713     O          e            headings       2                                   012700100713     O                                          127 'Page:'                     012800100713     O                       page          z    132                             012900100713     O          e            headings       1                                   013000100713     O                                           60 'CONHDR'                    013100100713     O                                           75 'CUSTS'                     013200100713     O                                           90 'DELIVA'                    013300100713     O                                          105 'TRNHST'                    013400100713     O                                          130 'CNTACS'                    013500100713     O          e            headings       2                                   013600100713     O                                           60 'Records'                   013700100713     O                                           75 'Records'                   013800100713     O                                           90 'Records'                   013900100713     O                                          105 'Records'                   014000100713     O                                          130 'Records'                   014100100713     O          e            totals         2                                   014200100713     O                       person               4                             014300100713     O                       pname               40                             014400100713     O                       conhdrcount   1     60                             014500100713     O                       custscount    1     75                             014600100713     O                       delivacount   1     90                             014700100713     O                       trnhstcount   1    105                             014800100713     O                       cntlfcount    1    130                             