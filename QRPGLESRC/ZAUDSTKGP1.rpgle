000100100713     H*‚--------------------------------------------------------------------    000200100713     H*ˆCOPYRIGHT DATABOROUGH LTD 2010                                          000300100713     H*‚--------------------------------------------------------------------    000400100713     H debug(*yes) copyright('Databorough Ltd. 2010') datedit(*dmy)             000500100713     H option(*srcstmt:*nodebugio:*showcpy)                                     000600100713     F**********************************************************************    000700100713     F*‚F i l e s                                                               000800100713     F**********************************************************************    000900100714     Fstkgrp1   if   e           k disk                                         001000100714     Fstkgrp2   if   e           k disk                                         001100100714     Fstkgrp3   if   e           k disk                                         001200100714     Ftrnhstl4  if   e           k disk                                         001300100714     Fprojecl2  if   e           k disk                                         001400100713     Fqsysprt   o    f  132        printer oflind(*INOF)                        001500100713                                                                                001600100713     D**********************************************************************    001700100713     D*‚D e f i n i t i o n s                                                   001800100713     D**********************************************************************    001900100714     D grp2count       s              7p 0                                      002000100714     D grp3count       s              7p 0                                      002100100714     D trnhstcount     s              7p 0                                      002200100714     D projeccount     s              7p 0                                      002300100713     D tyme            s              6s 0                                      002400100713     D today           s              8s 0                                      002500100713                                                                                002600100714     D stkgrp2k      e ds                  extname(stkgrp2:*key) prefix(a)      002700100714     D stkgrp3k      e ds                  extname(stkgrp3:*key) prefix(b)      002800100714     D trnhstk       e ds                  extname(trnhstl4:*key) prefix(c)     002900100714     D projeck       e ds                  extname(projecl2:*key) prefix(d)     003000100713                                                                                003100100713     C**********************************************************************    003200100713     C*‚M a i n l i n e   C o d e                                               003300100713     C**********************************************************************    003400100713      /free                                                                     003500100713        *inof = *on;                                                            003600100714       //‚For each STKGRP1 record                                               003700100714       setll *loval stkgrp1r;                                                   003800100714       read(e) stkgrp1r;                                                        003900100714       dow not %eof(stkgrp1);                                                   004000100713                                                                                004100100714       trnhstcount = *zeros;                                                    004200100714       projeccount = *zeros;                                                    004300100714       grp2count = *zeros;                                                      004400100714       grp3count = *zeros;                                                      004401110914       //grp4count = *zeros;                                                    004500100713                                                                                004600100714       //‚Count TRNHST records                                                  004700100714           cxwagcd = xwagcd;                                                    004800100714           setll %kds(trnhstk:1) trnhstr;                                       004900100714           reade(e) %kds(trnhstk:1) trnhstr;                                    005000100714           dow not %eof(trnhstl4) and not %error;                               005100100714               trnhstcount = trnhstcount + 1;                                   005200100714               reade(e) %kds(trnhstk:1) trnhstr;                                005300100714           enddo;                                                               005400100714                                                                                005500100714       //‚Count PROJECT records                                                 005600100714           dxwagcd = xwagcd;                                                    005601110914       //  wagcd = xwagcd;                                                      005700100714           setll %kds(projeck:1) projecr;                                       005800100714           reade(e) %kds(projeck:1) projecr;                                    005900100714           dow not %eof(projecl2) and not %error;                               006000100714               projeccount = projeccount + 1;                                   006100100714               reade(e) %kds(projeck:1) projecr;                                006200100714           enddo;                                                               006300100714                                                                                006400100714       //‚Count STKGRP2 records                                                 006500100714           axwagcd = xwagcd;                                                    006600100714           setll %kds(stkgrp2k:1) stkgrp2r;                                     006700100714           reade(e) %kds(stkgrp2k:1) stkgrp2r;                                  006800100714           dow not %eof(stkgrp2) and not %error;                                006900100714               grp2count = grp2count + 1;                                       007000100714               reade(e) %kds(stkgrp2k:1) stkgrp2r;                              007100100714           enddo;                                                               007200100714                                                                                007300100714       //‚Count STKGRP3 records                                                 007400100714           bxwagcd = xwagcd;                                                    007500100714           setll %kds(stkgrp3k:1) stkgrp2r;                                     007600100714           reade(e) %kds(stkgrp3k:1) stkgrp3r;                                  007700100714           dow not %eof(stkgrp3) and not %error;                                007800100714               grp3count = grp3count + 1;                                       007900100714               reade(e) %kds(stkgrp3k:1) stkgrp3r;                              008000100714           enddo;                                                               008100100713                                                                                008200100714       //‚Output totals for stock group 1  record                               008300100713          if *inof;                                                             008400100713             except headings;                                                   008500100713             *inof = *off;                                                      008600100713          endif;                                                                008700100713                                                                                008800100714          except totals;                                                        008900100713                                                                                009000100714       read(e) stkgrp1r;                                                        009100100713       enddo;                                                                   009200100713                                                                                009300100714                                                                                009400100713       //‚Terminate program and exit                                            009500100713       *inlr = *on;                                                             009600100713       return;                                                                  009700100713      /end-free                                                                 009800100713     C**********************************************************************    009900100713     C*‚* I N Z S R                                                             010000100713     C**********************************************************************    010100100713     C     *inzsr        begsr                                                  010200100713     C                   time                    tyme                           010300100713     C                   z-add     *date         today                          010400100713     C                   endsr                                                  010500100713     Oqsysprt   e            headings       1 01                                010600100713     O                                           10 'X-Analysis'                010700100714     O                                           60 'Audit log for file:'       010800100714     O                                           68 'STKGRP1'                   010900100713     O                                          132 'Databorough LTD.'          011000100713     O          e            headings       1                                   011100100913     O                                           10 'ZAUDSTKGP1'                011200100713     O                       tyme               120 '  :  :  '                  011300100713     O                       today              132 '  /  /    '                011400100713     O          e            headings       2                                   011500100713     O                                          127 'Page:'                     011600100713     O                       page          z    132                             011700100713     O          e            headings       1                                   011800100714     O                                           60 'TRNHST'                    011900100714     O                                           75 'PROJECT'                   012000100714     O                                           90 'STKGRP2'                   012100100714     O                                          105 'STKGRP3'                   012200100713     O          e            headings       2                                   012300100713     O                                           60 'Records'                   012400100713     O                                           75 'Records'                   012500100714     O                                           90 'Records'                   012600100714     O                                          105 'Records'                   012700100714     O          e            totals         2                                   012800100714     O                       xwagcd               4                             012900100714     O                       xwiwtx              30                             013000100714     O                       trnhstcount   1     60                             013100100714     O                       projeccount   1     75                             013200100714     O                       grp2count     1     90                             013300100714     O                       grp3count     1    105                             