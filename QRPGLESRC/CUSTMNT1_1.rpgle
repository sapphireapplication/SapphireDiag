000100070317     H*‚--------------------------------------------------------------------    000200070717     H*ˆCOPYRIGHT DATABOROUGH LTD 2007 - JORGE ESTEBAN SALDEÑA                  000300070717     H*ˆPROGRAM:  Customer Detail Maintenance                                   000400010705     H*‚--------------------------------------------------------------------    000500070131     H DATEDIT(*YMD)                                                            000600980122     F**********************************************************************    000700990528     F*‚F i l e s                                                               000800980122     F**********************************************************************    000900070809     FCUSTMNT1FMCF   E             WORKSTN                                      001000070212     FCUSTS     UF A E           K DISK                                         001100070813     F                                     INFDS(FILEDS)                        001200070213     FSLMEN     IF   E           K DISK                                         001300070213     FCUSFL3    IF   E           K DISK                                         001400070213     FCUSGRP    IF   E           K DISK                                         001500070213     FDISTS     IF   E           K DISK                                         001600070213     FCONHDRL1  IF   E           K DISK                                         001700070213     FTRNHSTL3  IF   E           K DISK                                         001800110922                                                                                001900070213     D**********************************************************************    002000070213     D*‚D e f i n i t i o n s                                                   002100070213     D**********************************************************************    002200070130     D*‚Set constants                                                           002300070131     D RTNMTX          C                   CONST('RTNMSGTEXT')                  002400070213     D INIDAT          C                   CONST('0001-01-01')                  002500070813                                                                                002600070813     d FILEDS          ds                                                       002700070813     d  FILESTS               11     15s 0                                      002800070303                                                                                002900070717     D  pageno         s              3p 0                                      003000070717     D  screen         s              1s 0                                      003100070305     D  noofpages      s              3p 0 inz(2)                               003200070716      *                                                                         003300070205     D                 DS                  INZ                                  003400070213     D  ZDATE                  1     10                                         003500070205     D  ZYR                    1      4                                         003600070205     D  FILLR1                 5      5                                         003700070205     D  ZMTH                   6      7                                         003800070205     D  FILLR2                 8      8                                         003900070205     D  ZDAY                   9     10                                         004000070303                                                                                004100070130     I**********************************************************************    004200070213     IRCUSF                                                                     004300070213     I              DSDCDE                      XSDCDE                          004400070305                                                                                004500070303     C**********************************************************************    004600070130     C*‚M a i n l i n e   C o d e                                               004700070303     C**********************************************************************    004800090304     C*‚Entry parameters                                                        004900090304     C     *ENTRY        PLIST                                                  005000090304     C                   PARM                    KWBCCD           11            005100090304     C*‚Initialise message subfile                                              005200090304     C                   MOVE      '1'           *IN82                          005300090304     C                   MOVEL     'CUSTMNT1'    ZZPGM                          005400090304     C                   MOVEL     KWBCCD        SWBCCD                         005500090304     C                   EXSR      GETREC                                       005600090304     C*-‚Set date                                                               005700090304     C                   MOVE      *DATE         ZZDATE                         005800090304     C                   MOVE      *YEAR         ZYR                            005900090304     C                   MOVE      '-'           FILLR1                         006000090304     C                   MOVE      *MONTH        ZMTH                           006100090304     C                   MOVE      '-'           FILLR2                         006200090304     C                   MOVE      *DAY          ZDAY                           006300090304      *                                                                         006400080117     C*‚Main loop                                                               006500080117     C*                                                                         006600070130     C     *IN03         DOWEQ     '0'                                          006700070130     C     *IN12         ANDEQ     '0'                                          006800070718     C*‚                                                                        006900070131     C     *IN03         IFEQ      '1'                                          007000070131     C     *IN12         OREQ      '1'                                          007100070131     C                   LEAVE                                                  007200070131     C                   ENDIF                                                  007300070219     C*‚Action command keys                                                     007400070130     C     *IN28         IFEQ      '1'                                          007500070717     C                   MOVE      '0'           *IN12                          007600070130     C                   ELSE                                                   007700070717     C*‚Change main data                                                        007800070717     C                   EXSR      CHGMAI                                       007900070130     C                   ENDIF                                                  008000070130     C                   ENDDO                                                  008100070305                                                                                008200070131     C                   MOVE      '1'           *INLR                          008300070717                                                                                008400070131     C                   RETURN                                                 008500070303     C**********************************************************************    008600070130     C*‚L o g i c a l   E n d   o f   P r o g r a m                             008700070303     C**********************************************************************    008800070717                                                                                008900070717     C**********************************************************************    009000070717     C     CHGMAI        BEGSR                                                  009100070717     C**********************************************************************    009200070717     C*‚Subroutine: Change a record                                             009300070717     C**********************************************************************    009400070717                                                                                009500070717     C*‚For each screen page                                                    009600070717     C                   dow       pageno <= noofpages                          009700070717      *                                                                         009800070717     C                   EXFMT     ZZFT01                                       009900070717      *                                                                         010000070717     C*‚Process Command Keys                                                    010100070717     C*‚Prompt                                                                  010200070717     C     *IN04         IFEQ      '1'                                          010300070717     C                   EXSR      SRPROM                                       010400070717     C                   ENDIF                                                  010500070717      *                                                                         010600070717     C     *IN03         IFEQ      '1'                                          010700070717     C     *IN12         OREQ      '1'                                          010800070717     C                   LEAVE                                                  010900070717     C                   ENDIF                                                  011000070717      *                                                                         011100070717     C     *IN04         IFEQ      '1'                                          011200070717     C                   ITER                                                   011300070717     C                   ENDIF                                                  011400070717      *                                                                         011500070717     C                   EXSR      VALID1                                       011600070717      *                                                                         011700070717     C*‚If errors found                                                         011800070717     C     *IN99         IFEQ      '1'                                          011900070717     C*‚Display error message and re-display screen                             012000070717     C                   MOVEL     ERRMSG        ZMSAGE                         012100070717     C                   iter                                                   012200070717     C                   else                                                   012300070718     C                   call      'WCUSTP'                                     012400070718     C                   parm                    SWBCCD                         012500070717     C                   EXSR      CHGSAL                                       012600070717     C     *IN12         IFEQ      '1'                                          012700070717     C                   ITER                                                   012800070717     C                   ENDIF                                                  012900070717     C     *IN03         IFEQ      '1'                                          013000070717     C                   LEAVE                                                  013100070717     C                   ENDIF                                                  013200070717     C                   ENDIF                                                  013300070717      *                                                                         013400070717     C*‚End: For each screen page                                               013500070717     C                   ENDDO                                                  013600070717                                                                                013700070717     C                   ENDSR                                                  013800070717     C**********************************************************************    013900070717                                                                                014000070717     C**********************************************************************    014100070717     C     CHGSAL        BEGSR                                                  014200070717     C**********************************************************************    014300070717     C*‚Subroutine: Change a record                                             014400070717     C**********************************************************************    014500070717                                                                                014600070717     C*‚For each screen page                                                    014700070717     C                   dow       pageno <= noofpages                          014800070717      *                                                                         014900070717     C                   EXFMT     ZZFT02                                       015000070717      *                                                                         015100070717     C*‚Process Command Keys                                                    015200070717     C                   SELECT                                                 015300070717     C*‚Prompt                                                                  015400070717     C     *IN04         WHENEQ    '1'                                          015500070717     C                   EXSR      SRPROM                                       015600070717     C                   ENDSL                                                  015700070717      *                                                                         015800070717     C     *IN03         IFEQ      '1'                                          015900070717     C     *IN12         OREQ      '1'                                          016000070717     C                   LEAVE                                                  016100070717     C                   ENDIF                                                  016200070717      *                                                                         016300070717     C     *IN04         IFEQ      '1'                                          016400070717     C                   ITER                                                   016500070717     C                   ENDIF                                                  016600070717      *                                                                         016700070717     C                   EXSR      VALID2                                       016800070717      *                                                                         016900070717     C*‚If errors found                                                         017000070717     C     *IN99         IFEQ      '1'                                          017100070717     C*‚Display error message and re-display screen                             017200070717     C                   MOVEL     ERRMSG        ZMSAGE                         017300070717     C                   iter                                                   017400070717     C                   else                                                   017500070717     C                   leave                                                  017600070717     C                   ENDIF                                                  017700070717      *                                                                         017800070717     C*‚End: For each screen page                                               017900070717     C                   ENDDO                                                  018000070717                                                                                018100070717     C*‚If not F3/F12                                                           018200070717     C     *IN03         IFNE      '1'                                          018300070717     C     *IN12         ANDNE     '1'                                          018400080901     C*‚If confirmation received then update or write record                    018500080901     C     *IN96         ifeq      *off                                         018600070717     C                   exsr      updrec                                       018700080901     C                   else                                                   018800080901     C                   exsr      wrtrec                                       018900080901     C                   endif                                                  019000070717      *                                                                         019100070717     C*‚End: If not F3/F12                                                      019200070717     C                   ENDIF                                                  019300070717                                                                                019400070717     C                   ENDSR                                                  019500070717     C**********************************************************************    019600070305                                                                                019700070305     C**********************************************************************    019800070216     C     VALID1        BEGSR                                                  019900070305     C**********************************************************************    020000070305     C*‚Subroutine: Validation #1                                               020100070305     C**********************************************************************    020200080901     C                   eval      *in99 = *off                                 020300080901     C                   eval      *in31 = *off                                 020400080901     C                   eval      *in32 = *off                                 020500080901     C                   eval      *in33 = *off                                 020600080901     C                   eval      *in34 = *off                                 020700080901     C                   eval      *in35 = *off                                 020800080901     C                   eval      errmsg = *blanks                             020900080901     C*                                                                         021000070201     C                   DO                                                     021100080901     C*                                                                         021200080901     C*‚If in ADD mode                                                          021300080901     C     *IN96         IFEQ      '1'                                          021400080901     C* CUSTOMER MUST NOT BE BLANK                                              021500070716     C     SWBCCD        IFEQ      *BLANKS                                      021600070209     C                   MOVE      '1'           *IN99                          021700070212     C                   MOVE      *ON           *IN31                          021800070213     C                   MOVE      'OEM0002'     MSGID                          021900070209     C                   CALL      RTNMTX                                       022000070209     C                   PARM                    MSGID             7            022100070209     C                   PARM                    ERRMSG          132            022200070209     C                   LEAVE                                                  022300070209     C                   ENDIF                                                  022400080901     C* CUSTOMER MUST NOT ALREADY EXIST                                         022500070716     C     SWBCCD        SETLL     CUSTS                                  99    022600070209     C     *IN99         IFEQ      '1'                                          022700070212     C                   MOVE      *ON           *IN31                          022800070209     C                   MOVE      'Y2U0003'     MSGID                          022900070716     C                   MOVEL     *ALL'-'       SWG4TX                         023000070209     C                   CALL      RTNMTX                                       023100070209     C                   PARM                    MSGID             7            023200070209     C                   PARM                    ERRMSG          132            023300070209     C                   LEAVE                                                  023400070209     C                   ENDIF                                                  023500080901     C*‚End: If in ADD mode                                                     023600070209     C                   ENDIF                                                  023700080901     C*                                                                         023800080901     C*‚Customer name                                                           023900070716     C     SWG4TX        IFEQ      *BLANKS                                      024000070212     C                   MOVE      *ON           *IN32                          024100070212     C                   MOVE      *ON           *IN99                          024200070212     C                   MOVE      'OEM0012'     MSGID                          024300070212     C                   CALL      RTNMTX                                       024400070212     C                   PARM                    MSGID             7            024500070212     C                   PARM                    ERRMSG          132            024600070212     C                   LEAVE                                                  024700070212     C                   ENDIF                                                  024800070713      *‚Customer group                                                          024900100803     C     SWBNCD        setll     CUSGRP                                       025000100803     C     SWBNCD        reade     CUSGRP                                       025100100803     C                   IF        %eof and                                     025200100803     C                             swbncd <> *blanks                            025300070213     C                   MOVE      '1'           *IN33                          025400070213     C                   MOVE      'OES0374'     MSGID                          025500070716     C                   MOVEL     *ALL'-'       SWKHTX                         025600070213     C                   CALL      RTNMTX                                       025700070213     C                   PARM                    MSGID             7            025800070213     C                   PARM                    ERRMSG          132            025900070213     C                   LEAVE                                                  026000080118     C                   ELSE                                                   026100080118     C                   MOVEL     XWKHTX        SWKHTX                         026200080118     C                   ENDIF                                                  026300070713      *‚Salesman                                                                026400080118     C     SPERSON       CHAIN     SLMEN                              99        026500070213     C     *IN99         IFEQ      '1'                                          026600070213     C                   MOVE      '1'           *IN34                          026700070213     C                   MOVE      'OEM0023'     MSGID                          026800070213     C                   CALL      RTNMTX                                       026900070213     C                   PARM                    MSGID             7            027000070213     C                   PARM                    ERRMSG          132            027100070213     C                   MOVE      *ALL'-'       PNAME                          027200070213     C                   LEAVE                                                  027300070213     C                   ENDIF                                                  027400070713      *‚Distributor                                                             027500080118     C     SDSDCDE       CHAIN     DISTS                              99        027600070213     C     *IN99         IFEQ      '1'                                          027700070213     C                   MOVE      '1'           *IN35                          027800070213     C                   MOVE      'OEM0018'     MSGID                          027900070213     C                   CALL      RTNMTX                                       028000070213     C                   PARM                    MSGID             7            028100070213     C                   PARM                    ERRMSG          132            028200070213     C                   MOVE      *ALL'-'       DNAME                          028300070213     C                   LEAVE                                                  028400070213     C                   ENDIF                                                  028500080901     C*                                                                         028600070201     C                   ENDDO                                                  028700080901     C*                                                                         028800070131     C                   ENDSR                                                  028900070305     C**********************************************************************    029000070305                                                                                029100070305     C**********************************************************************    029200070216     C     VALID2        BEGSR                                                  029300070305     C**********************************************************************    029400070305     C*‚Subroutine: Validation #2                                               029500070305     C**********************************************************************    029600070718     C                   eval      *in99=*off                                   029700070718      *                                                                         029800070216     C                   DO                                                     029900080901     C*‚If in CHANGE mode                                                       030000080901     C     *IN95         IFEQ      '1'                                          030100080901     C*‚Balance                                                                 030200100521     C     SWGIVA        SUB       SWIDV0        SDIFF            15 2          030300070716     C     SDIFF         IFLT      *ZERO                                        030400070216     C                   MOVE      '1'           *IN99                          030500070216     C                   MOVE      '1'           *IN36                          030600070216     C                   MOVE      'OES0373'     MSGID                          030700070216     C                   CALL      RTNMTX                                       030800070216     C                   PARM                    MSGID             7            030900070216     C                   PARM                    ERRMSG          132            031000070216     C                   LEAVE                                                  031100070216     C                   ENDIF                                                  031200070216     C                   ENDIF                                                  031300080901     C*                                                                         031400080901     C*‚Customer cannot be zero                                                 031500070216     C     CUSNO         IFEQ      *ZEROS                                       031600070216     C                   MOVE      '1'           *IN37                          031700070216     C                   MOVE      '1'           *IN99                          031800070216     C                   MOVE      'CNP0008'     MSGID                          031900070216     C                   CALL      RTNMTX                                       032000070216     C                   PARM                    MSGID             7            032100070216     C                   PARM                    ERRMSG          132            032200070216     C                   LEAVE                                                  032300070216     C                   ENDIF                                                  032400080901     C*‚Customer                                                                032500070306     C     CUSNO         CHAIN     CUSFL3                             99        032600070216     C     *IN99         IFEQ      '1'                                          032700070216     C                   MOVE      '1'           *IN37                          032800070216     C                   MOVE      'CNP0002'     MSGID                          032900070216     C                   CALL      RTNMTX                                       033000070216     C                   PARM                    MSGID             7            033100070216     C                   PARM                    ERRMSG          132            033200070216     C                   LEAVE                                                  033300070216     C                   ENDIF                                                  033400070216     C                   ENDDO                                                  033500080901     C*                                                                         033600070216     C                   ENDSR                                                  033700070305     C**********************************************************************    033800070305                                                                                033900070305     C**********************************************************************    034000070305     C     GETREC        BEGSR                                                  034100070305     C**********************************************************************    034200070305     C*‚Subroutine: Retrieve a record                                           034300070305     C**********************************************************************    034400080901     C*‚If no customer number entered                                           034500080901     C     SWBCCD        IFEQ      *BLANKS                                      034600080901      *                                                                         034700080901     C*‚Set to ADD mode                                                         034800080901     C                   EVAL      *IN96 = *ON                                  034900080901     C                   CLEAR                   CUSTSR                         035000080901      *                                                                         035100080901     C                   ELSE                                                   035200080901      *                                                                         035300080901     C*‚Set to CHANGE mode                                                      035400080901     C                   EVAL      *IN95 = *ON                                  035500080901      *                                                                         035600080117     C     SWBCCD        CHAIN(N)  CUSTSR                             9966      035700070717      *                                                                         035800070305     C*‚If file error                                                           035900070305     C     *IN99         IFEQ      '1'                                          036000070813     C                   MOVE      'OES0115'     MSGID                          036100070305     C                   CALL      RTNMTX                                       036200070305     C                   PARM                    MSGID             7            036300070305     C                   PARM                    ERRMSG          132            036400070305     C                   MOVEL     ERRMSG        ZMSAGE                         036500070717     C                   ELSE                                                   036600070813     C     *IN66         IFEQ      *ON                                          036700070813     C     FILESTS       IFEQ      1218                                         036800070813     C                   MOVE      'Y3U9999'     MSGID                          036900070813     C                   CALL      RTNMTX                                       037000070813     C                   PARM                    MSGID             7            037100070813     C                   PARM                    ERRMSG          132            037200070813     C                   MOVEL     ERRMSG        ZMSAGE                         037300070813     C                   ELSE                                                   037400070813     C                   MOVE      'OEM0004'     MSGID                          037500070813     C                   CALL      RTNMTX                                       037600070813     C                   PARM                    MSGID             7            037700070813     C                   PARM                    ERRMSG          132            037800070813     C                   MOVEL     ERRMSG        ZMSAGE                         037900070813     C                   ENDIF                                                  038000070813     C                   ELSE                                                   038100070813     C*‚If file no error                                                        038200070813     C*‚Main data                                                               038300070813     C                   eval      SWBCCD=XWBCCD                                038400070813     C                   eval      SWG4TX=XWG4TX                                038500070813     C                   eval      SWB2CD=XWB2CD                                038600070813     C                   eval      SWB3CD=XWB3CD                                038700070813     C                   eval      SWHITX=XWHITX                                038800070813     C                   eval      SWE0NB=XWE0NB                                038900070813     C                   eval      SWJUN0=XWJUN0                                039000070813     C                   eval      SWDVCD=XWDVCD                                039100070813     C                   eval      SWBNCD=XWBNCD                                039200080117     C                   eval      SPERSON=PERSON                               039300070813     C*                  eval      PNAME =PNAME                                 039400080117     C                   eval      SDSDCDE=DSDCDE                               039500070813     c                   eval      SWBTCD=XWBTCD                                039600070813     C                   eval      SWGIVA=XWGIVA                                039700070813     C                   eval      SWAOCD=XWAOCD                                039800070813     C                   eval      SWBBCD=XWBBCD                                039900070813     C                   eval      SWG4T0=XWG4T0                                040000070813     C                   eval      SWC7ST=XWC7ST                                040100070813     C                   eval      SWDAST=XWDAST                                040200070813     C                   eval      SWBPD0=XWBPD0                                040300070813     C                   eval      SWBAD0=XWBAD0                                040400070813     C                   eval      SWARDT=XWARDT                                040500070813     C                   eval      ZMSAGE=ZMSAGE                                040600070813     C                   eval      SWKHTX=XWKHTX                                040700070813     C*                  eval      DNAME =DNAME                                 040800070813     C*‚Sales data                                                              040900070813     C                   eval      SWF0VA=XWF0VA                                041000070813     C                   eval      SWASDT=XWASDT                                041100070813     C                   eval      SWF0V0=XWF0V0                                041200070813     C                   eval      SWBQDT=XWBQDT                                041300070813     C                   eval      SWF1VA=XWF1VA                                041400070813     C                   eval      SWF1V0=XWF1V0                                041500070813     C                   eval      SWF2VA=XWF2VA                                041600070813     C                   eval      SWF3VA=XWF3VA                                041700070813     C                   eval      SWF4VA=XWF4VA                                041800070813     C                   eval      SWF6VA=XWF6VA                                041900070813     C                   eval      SWIDV0=XWIDV0                                042000070813     C                   eval      SWGAVA=XWGAVA                                042100070813     C                   eval      SWGBVA=XWGBVA                                042200070813     C                   eval      SWGCVA=XWGCVA                                042300070813     C                   eval      SWGDVA=XWGDVA                                042400070813     C                   eval      SWGEVA=XWGEVA                                042500070813     C                   eval      SWGFVA=XWGFVA                                042600070813     C                   eval      SWGGVA=XWGGVA                                042700070813     C*                  eval      CUSNO =CUSNO                                 042800070813     C*                  eval      ZMSAGE=ZMSAGE                                042900080117     C                   exsr      zgetnames                                    043000070813     C                   ENDIF                                                  043100070305     C                   ENDIF                                                  043200080901     C*                                                                         043300080901     C*‚If a numeric customer id                                                043400080901     C                   if        %subst(swbccd:1:1) >= '0'                    043500080901     C*‚Set to DISPLAY mode                                                     043600080901     C                   EVAL      *IN95 = *OFF                                 043700080901     C                   EVAL      *IN94 = *ON                                  043800080901     C                   endif                                                  043900080901     C*                                                                         044000080901     C                   ENDIF                                                  044100080901                                                                                044200070305     C                   ENDSR                                                  044300070305     C**********************************************************************    044400070717     C     UPDREC        BEGSR                                                  044500080117     C     SWBCCD        CHAIN     CUSTSR                             9966      044600080117     C                   IF        %FOUND(CUSTS)                                044700070718     C                   EVAL      XWBCCD=SWBCCD                                044800070718     C                   EVAL      XWG4TX=SWG4TX                                044900070718     C                   EVAL      XWB2CD=SWB2CD                                045000070718     C                   EVAL      XWB3CD=SWB3CD                                045100070718     C                   EVAL      XWHITX=SWHITX                                045200070718     C                   EVAL      XWE0NB=SWE0NB                                045300070718     C                   EVAL      XWJUN0=SWJUN0                                045400070718     C                   EVAL      XWDVCD=SWDVCD                                045500070718     C                   EVAL      XWBNCD=SWBNCD                                045600070718     c                   EVAL      XWBTCD=SWBTCD                                045700120614     C*                  EVAL      XWGIVA=SWGIVA                                045800070718     C                   EVAL      XWAOCD=SWAOCD                                045900070718     C                   EVAL      XWBBCD=SWBBCD                                046000070718     C                   EVAL      XWG4T0=SWG4T0                                046100070718     C                   EVAL      XWC7ST=SWC7ST                                046200070718     C                   EVAL      XWDAST=SWDAST                                046300070718     C                   EVAL      XWBPD0=SWBPD0                                046400070718     C                   EVAL      XWBAD0=SWBAD0                                046500070718     C                   EVAL      XWARDT=SWARDT                                046600070718     C                   EVAL      XWKHTX=SWKHTX                                046700070718     C                   EVAL      XWF0VA=SWF0VA                                046800070718     C                   EVAL      XWASDT=SWASDT                                046900070718     C                   EVAL      XWF0V0=SWF0V0                                047000070718     C                   EVAL      XWBQDT=SWBQDT                                047100070718     C                   EVAL      XWF1VA=SWF1VA                                047200070718     C                   EVAL      XWF1V0=SWF1V0                                047300070718     C                   EVAL      XWF2VA=SWF2VA                                047400070718     C                   EVAL      XWF3VA=SWF3VA                                047500070718     C                   EVAL      XWF4VA=SWF4VA                                047600070718     C                   EVAL      XWF6VA=SWF6VA                                047700070718     C                   EVAL      XWIDV0=SWIDV0                                047800070718     C                   EVAL      XWGAVA=SWGAVA                                047900070718     C                   EVAL      XWGBVA=SWGBVA                                048000070718     C                   EVAL      XWGCVA=SWGCVA                                048100070718     C                   EVAL      XWGDVA=SWGDVA                                048200070718     C                   EVAL      XWGEVA=SWGEVA                                048300070718     C                   EVAL      XWGFVA=SWGFVA                                048400070718     C                   EVAL      XWGGVA=SWGGVA                                048500080117     C                   EVAL      PERSON=SPERSON                               048600080117     C                   EVAL      DSDCDE=SDSDCDE                               048700070717     C                   UPDATE    CUSTSR                               99      048800070717     C     *IN99         IFEQ      '1'                                          048900070717     C                   MOVE      'Y2U0007'     MSGID                          049000070717     C                   CALL      RTNMTX                                       049100070717     C                   PARM                    MSGID             7            049200070717     C                   PARM                    ERRMSG          132            049300070717     C* Display error message                                                   049400070718     C                   MOVEL     ERRMSG        ZMSAGE                         049500070717     C                   ENDIF                                                  049600080117     C                   ENDIF                                                  049700070717     C                   ENDSR                                                  049800070305     C**********************************************************************    049900080901     C*                                                                         050000080901     C**********************************************************************    050100080901     C     WRTREC        BEGSR                                                  050200080901     C                   EVAL      XWBCCD=SWBCCD                                050300080901     C                   EVAL      XWG4TX=SWG4TX                                050400080901     C                   EVAL      XWB2CD=SWB2CD                                050500080901     C                   EVAL      XWB3CD=SWB3CD                                050600080901     C                   EVAL      XWHITX=SWHITX                                050700080901     C                   EVAL      XWE0NB=SWE0NB                                050800080901     C                   EVAL      XWJUN0=SWJUN0                                050900080901     C                   EVAL      XWDVCD=SWDVCD                                051000080901     C                   EVAL      XWBNCD=SWBNCD                                051100080901     c                   EVAL      XWBTCD=SWBTCD                                051200080901     C                   EVAL      XWGIVA=SWGIVA                                051300080901     C                   EVAL      XWAOCD=SWAOCD                                051400080901     C                   EVAL      XWBBCD=SWBBCD                                051500080901     C                   EVAL      XWG4T0=SWG4T0                                051600080901     C                   EVAL      XWC7ST=SWC7ST                                051700080901     C                   EVAL      XWDAST=SWDAST                                051800080901     C                   EVAL      XWBPD0=SWBPD0                                051900080901     C                   EVAL      XWBAD0=SWBAD0                                052000080901     C                   EVAL      XWARDT=SWARDT                                052100080901     C                   EVAL      XWKHTX=SWKHTX                                052200080901     C                   EVAL      XWF0VA=SWF0VA                                052300080901     C                   EVAL      XWASDT=SWASDT                                052400080901     C                   EVAL      XWF0V0=SWF0V0                                052500080901     C                   EVAL      XWBQDT=SWBQDT                                052600080901     C                   EVAL      XWF1VA=SWF1VA                                052700080901     C                   EVAL      XWF1V0=SWF1V0                                052800080901     C                   EVAL      XWF2VA=SWF2VA                                052900080901     C                   EVAL      XWF3VA=SWF3VA                                053000080901     C                   EVAL      XWF4VA=SWF4VA                                053100080901     C                   EVAL      XWF6VA=SWF6VA                                053200080901     C                   EVAL      XWIDV0=SWIDV0                                053300080901     C                   EVAL      XWGAVA=SWGAVA                                053400080901     C                   EVAL      XWGBVA=SWGBVA                                053500080901     C                   EVAL      XWGCVA=SWGCVA                                053600080901     C                   EVAL      XWGDVA=SWGDVA                                053700080901     C                   EVAL      XWGEVA=SWGEVA                                053800080901     C                   EVAL      XWGFVA=SWGFVA                                053900080901     C                   EVAL      XWGGVA=SWGGVA                                054000080901     C                   EVAL      PERSON=SPERSON                               054100080901     C                   EVAL      DSDCDE=SDSDCDE                               054200080901     C                   WRITE(E)  CUSTSR                                       054300080901                                                                                054400080901     C                   IF        %ERROR                                       054500080901     C                   MOVE      'Y2U0003'     MSGID                          054600080901     C                   CALL      RTNMTX                                       054700080901     C                   PARM                    MSGID             7            054800080901     C                   PARM                    ERRMSG          132            054900080901     C* Display error message                                                   055000080901     C                   MOVEL     ERRMSG        ZMSAGE                         055100080901     C                   ELSE                                                   055200080901     C                   MOVEL     *OFF          *IN96                          055300080901     C                   MOVEL     *ON           *IN95                          055400080901     C                   ENDIF                                                  055500080901                                                                                055600080901     C                   ENDSR                                                  055700080901     C**********************************************************************    055800070305                                                                                055900070305     C**********************************************************************    056000070213     C     SRPROM        BEGSR                                                  056100070305     C**********************************************************************    056200070213     C*‚Subroutine: prompts for F04                                             056300070305     C**********************************************************************    056400070213     C                   SELECT                                                 056500080118     C     SFIELD        WHENEQ    'SPERSON'                                    056600070213     C                   CALL      'SLMENSEL'                                   056700080118     C                   PARM                    SPERSON                        056800070213     C                   PARM                    PNAME                          056900070215     C     SFIELD        WHENEQ    'CUSNO'                                      057000070213     C                   CALL      'CUSFSEL'                                    057100070213     C                   PARM      *ZEROS        CUSPRM            5 0          057200070213     C     CUSPRM        IFNE      *ZEROS                                       057300070213     C                   MOVE      CUSPRM        CUSNO                          057400070213     C                   ENDIF                                                  057500070716     C     SFIELD        WHENEQ    'SWBNCD'                                     057600070213     C                   CALL      'CUSGRSEL'                                   057700070716     C                   PARM                    SWBNCD                         057800070716     C                   PARM                    SWKHTX                         057900080118     C     SFIELD        WHENEQ    'SDSDCDE'                                    058000070213     C                   CALL      'DISTSSEL'                                   058100080118     C                   PARM                    SDSDCDE                        058200070213     C                   PARM                    DNAME                          058300070213     C                   ENDSL                                                  058400070213     C                   ENDSR                                                  058500070305     C**********************************************************************    058600080117     C**********************************************************************    058700080117     C     ZGETNAMES     BEGSR                                                  058800080117     C**********************************************************************    058900080117     C*‚Subroutine: Retrieve names for codes                                    059000080117     C**********************************************************************    059100080117     C     SWBNCD        CHAIN(E)  CUSGRP                                       059200080117     C                   IF        NOT %FOUND(CUSGRP)                           059300080117     C                   MOVEL     *ALL'-'       SWKHTX                         059400080118     C                   ELSE                                                   059500080118     C                   MOVEL     XWKHTX        SWKHTX                         059600080118     C                   ENDIF                                                  059700080118     C     SPERSON       CHAIN(E)  SLMEN                                        059800080117     C                   IF        NOT %FOUND(SLMEN)                            059900080117     C                   MOVE      *ALL'-'       PNAME                          060000080117     C                   ENDIF                                                  060100080118     C     SDSDCDE       CHAIN(E)  DISTS                                        060200080117     C                   IF        NOT %FOUND(DISTS)                            060300080117     C                   MOVE      *ALL'-'       DNAME                          060400080117     C                   ENDIF                                                  060500080117     C                   ENDSR                                                  060600080117     C**********************************************************************    