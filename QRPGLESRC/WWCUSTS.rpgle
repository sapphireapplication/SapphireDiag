000100070317     H*‚--------------------------------------------------------------------    000200071221     H*ˆCOPYRIGHT DATABOROUGH LTD 2007                                          000300070212     H*ˆPROGRAM:  Work with Customers                                           000400010705     H*‚--------------------------------------------------------------------    000500070131     H DATEDIT(*YMD)                                                            000600980122     F**********************************************************************    000700990528     F*‚F i l e s                                                               000800980122     F**********************************************************************    000900110824     FWCUSTSD   CF   E             WORKSTN                                      001000070130     F                                     SFILE(ZZSF01:SFLRRN)                 001100070212     FCUSTS     UF A E           K DISK                                         001200070813     F                                     INFDS(FILEDS)                        001300070213     FSLMEN     IF   E           K DISK                                         001400070213     FCUSFL3    IF   E           K DISK                                         001500070213     FCUSGRP    IF   E           K DISK                                         001600070213     FDISTS     IF   E           K DISK                                         001700070213     FCONHDRL1  IF   E           K DISK                                         001800070213     FTRNHSTL3  IF   E           K DISK                                         001900070213     D**********************************************************************    002000070213     D*‚D e f i n i t i o n s                                                   002100070213     D**********************************************************************    002200070130     D*‚Set constants                                                           002300070131     D RTNMTX          C                   CONST('RTNMSGTEXT')                  002400070213     D INIDAT          C                   CONST('0001-01-01')                  002500070813                                                                                002600070813     d FILEDS          ds                                                       002700070813     d  FILESTS               11     15s 0                                      002800070303                                                                                002900070305     D  sflrrn         s              5p 0                                      003000070305     D  sflchg         s              1a   inz('0')                             003100110103     D  sflCTR         s              3P 0                                      003200070303                                                                                003300070205     D                 DS                  INZ                                  003400070213     D  ZDATE                  1     10                                         003500070205     D  ZYR                    1      4                                         003600070205     D  FILLR1                 5      5                                         003700070205     D  ZMTH                   6      7                                         003800070205     D  FILLR2                 8      8                                         003900070205     D  ZDAY                   9     10                                         004000070303                                                                                004100070130     I**********************************************************************    004200070213     IRCUSF                                                                     004300070213     I              DSDCDE                      XSDCDE                          004400070305                                                                                004500070303     C**********************************************************************    004600070130     C*‚M a i n l i n e   C o d e                                               004700070303     C**********************************************************************    004800070202     C*‚Build subfile                                                           004900070202     C                   EXSR      SFLWRT                                       005000070305                                                                                005100070130     C     *IN03         DOWEQ     '0'                                          005200070130     C     *IN12         ANDEQ     '0'                                          005300070212     C                   MOVE      *BLANKS       LOCATE                         005400070219     C*‚Display screens                                                         005500070201     C                   WRITE     ZZTR01                                       005600070215     C   99              WRITE     ZZMC01                                       005700070131     C                   EXFMT     ZZCT01                                       005800070219     C*‚Remove messages                                                         005900070130     C                   CALL      'XBCCLMSG'                                   006000070131     C     *IN03         IFEQ      '1'                                          006100070131     C     *IN12         OREQ      '1'                                          006200070131     C                   LEAVE                                                  006300070131     C                   ENDIF                                                  006400070303     C*‚Action positioner request                                               006500070212     C     LOCATE        IFNE      *BLANKS                                      006600110103     C                   MOVE      *ZEROS        SFLRRN                         006700070212     C                   MOVE      LOCATE        XWBCCD                         006800070202     C                   EXSR      SFLWRT                                       006900070202     C                   ITER                                                   007000070202     C                   ENDIF                                                  007100070219     C*‚Action command keys                                                     007200070130     C     *IN28         IFEQ      '1'                                          007300070130     C                   EXSR      CMDKEY                                       007400070130     C                   ELSE                                                   007500070219     C*‚Else action selections                                                  007600070130     C                   EXSR      ZSELEC                                       007700070130     C                   ENDIF                                                  007800070219     C*‚If changes made then update display                                     007900070209     C     SFLCHG        IFEQ      '1'                                          008000070212     C                   MOVE      *LOVAL        XWBCCD                         008100070209     C                   EXSR      SFLWRT                                       008200070209     C                   ENDIF                                                  008300071221                                                                                008400070130     C                   ENDDO                                                  008500070305                                                                                008600070131     C                   MOVE      '1'           *INLR                          008700070131     C                   RETURN                                                 008800070303     C**********************************************************************    008900070130     C*‚L o g i c a l   E n d   o f   P r o g r a m                             009000070303     C**********************************************************************    009100070303                                                                                009200070303     C**********************************************************************    009300070130     C     SFLWRT        BEGSR                                                  009400070303     C**********************************************************************    009500070130     C*‚Subroutine: Write data to subfile                                       009600070303     C**********************************************************************    009700070130     C*‚Delete subfile                                                          009800110103     C                   IF        SFLRRN = 0                                   009900070131     C                   SETON                                        74        010000070213     C                   SETOFF                                       717281    010100070131     C                   WRITE     ZZCT01                               99      010200070131     C                   SETOFF                                       74        010300070130     C*‚Write subfile                                                           010400070130     C                   MOVE      *ZEROS        SFLRRN                         010500070213     C     XWBCCD        SETLL     CUSTS                                        010600110103     C                   ENDIF                                                  010700110103     C*                                                                         010800110103     C                   MOVE      *ZEROS        SFLCTR                         010900070213     C     *IN81         DOWEQ     '0'                                          011000110103     C     SFLCTR        ANDLT     12                                           011100110103     C                   READ(N)   CUSTS                                  81    011200110104     C     *IN81         IFEQ      '0'                                          011300070130     C                   ADD       1             SFLRRN                         011400110103     C                   ADD       1             SFLCTR                         011401110914     C***                Z-ADD     1             SFLCTR                         011500110103     C                   IF        SFLCTR = 1                                   011600110103     C                   Z-ADD     SFLRRN        SHWREC                         011700110103     C                   ENDIF                                                  011800070130     C                   MOVE      *BLANKS       DSSEL                          011900070130     C                   WRITE     ZZSF01                               99      012000110103     C                   ENDIF                                                  012100070130     C                   ENDDO                                                  012200070303                                                                                012300110103     C     SFLRRN        IFGT      0                                            012400070131     C                   SETON                                        71        012500070130     C                   ENDIF                                                  012600070131     C                   SETON                                        72        012700071221                                                                                012800070130     C                   ENDSR                                                  012900070303     C**********************************************************************    013000070305                                                                                013100070305     C**********************************************************************    013200070305     C     CMDKEY        BEGSR                                                  013300070305     C**********************************************************************    013400070305     C*‚Subroutine: Action command keys                                         013500070305     C**********************************************************************    013600070305     C                   SELECT                                                 013700110103                                                                                013800110103     C     *IN26         WHENEQ    '1'                                          013900110103     C                   EXSR      SFLWRT                                       014000070305                                                                                014100070305     C     *IN06         WHENEQ    '1'                                          014200070305     C                   EXSR      addrec                                       014300070305     C                   Z-ADD     1             SHWREC                         014400070305     C                   MOVE      '1'           SFLCHG                         014500070305     C                   ENDSL                                                  014600070305                                                                                014700070305     C                   MOVE      '0'           *IN12                          014701110914     C**                 MOVE      '1'           *IN13                          014800070305                                                                                014900070305     C                   ENDSR                                                  015000070305     C**********************************************************************    015100070303                                                                                015200070303     C**********************************************************************    015300070130     C     ZSELEC        BEGSR                                                  015400070303     C**********************************************************************    015500070130     C*‚Subroutine: Action selection                                            015600070303     C**********************************************************************    015700070130     C                   MOVE      '0'           SFLCHG                         015800070130     C                   READC     ZZSF01                                 35    015900070305                                                                                016000070130     C*‚For each selection                                                      016100070130     C     *IN35         DOWEQ     '0'                                          016200070130     C                   MOVE      '1'           SFLCHG                         016300070303                                                                                016400070213     C                   SELECT                                                 016500070219     C*‚Change                                                                  016600070213     C     DSSEL         WHENEQ    '2'                                          016700070305     C                   EXSR      chgrec                                       016800070219     C*‚Delete                                                                  016900070303     C     DSSEL         WHENEQ    '4'                                          017000070305     C                   EXSR      delrec                                       017100070219     C*‚Display                                                                 017200070303     C     DSSEL         WHENEQ    '5'                                          017300070305     C                   EXSR      dsprec                                       017400070718     C*‚Customer Detail Maintenance                                             017500070718     C     DSSEL         WHENEQ    '6'                                          017600070809     C                   call      'CUSTMNT1'                                   017700070718     C                   parm                    XWBCCD                         017800070305     C*‚Work with Orders                                                        017900070213     C     DSSEL         WHENEQ    '8'                                          018000090304     C                   EXSR      ZORDER                                       018100070305     C*‚Work with Transaction history                                           018200070213     C     DSSEL         WHENEQ    '9'                                          018300090304     C                   EXSR      ZHISTO                                       018400070213     C                   ENDSL                                                  018500070303                                                                                018600070130     C                   MOVE      *BLANKS       DSSEL                          018700070130     C                   UPDATE    ZZSF01                               99      018800070130     C                   READC     ZZSF01                                 35    018900070305                                                                                019000070219     C*‚End: For each selection                                                 019100070130     C                   ENDDO                                                  019200070303                                                                                019300070130     C                   MOVE      '0'           *IN12                          019400070303                                                                                019500070130     C                   ENDSR                                                  019600070303     C**********************************************************************    019700070303                                                                                019800070303     C**********************************************************************    019900070305     C     dspscns       BEGSR                                                  020000070303     C**********************************************************************    020100070305     C*‚Subroutine: Display detail screens                                      020200070303     C**********************************************************************    020300070305     C*‚Display screen, depending upon page no.                                 020400070305     C                   EXFMT     ZZFT01                                       020500110823                                                                                020600080208     C                   EXSR      MVSCDB                                       020700070305                                                                                020800070130     C                   CALL      'XBCCLMSG'                                   020900070306     C                   EXSR      OFFIND                                       021000070305                                                                                021100070305     C*‚Process Command Keys                                                    021200070212     C                   SELECT                                                 021300070305     C*‚Prompt                                                                  021400070212     C     *IN04         WHENEQ    '1'                                          021500070213     C                   EXSR      SRPROM                                       021600070219     C*‚Orders                                                                  021700070213     C     *IN08         WHENEQ    '1'                                          021800090304     C                   EXSR      ZORDER                                       021900070219     C*‚Transaction history                                                     022000070213     C     *IN09         WHENEQ    '1'                                          022100090304     C                   EXSR      ZHISTO                                       022101110914     C** Custtomer History                                                      022102110914     C**   *IN07         WHENEQ    '1'                                          022103110914     C**                 EXSR      ZCUSTS                                       022200070201     C                   ENDSL                                                  022300070305                                                                                022400070130     C                   ENDSR                                                  022500070305     C**********************************************************************    022600070305                                                                                022700070305     C**********************************************************************    022800070216     C     VALID1        BEGSR                                                  022900070305     C**********************************************************************    023000070305     C*‚Subroutine: Validation #1                                               023100070305     C**********************************************************************    023200070201     C                   DO                                                     023300070219     C* WHEN ADDING CUSTOMER MUST NOT BE ZERO                                   023400070212     C     XWBCCD        IFEQ      *BLANKS                                      023500070209     C                   MOVE      '1'           *IN99                          023600070212     C                   MOVE      *ON           *IN31                          023700070213     C                   MOVE      'OEM0002'     MSGID                          023800070209     C                   CALL      RTNMTX                                       023900070209     C                   PARM                    MSGID             7            024000070209     C                   PARM                    ERRMSG          132            024100070209     C                   LEAVE                                                  024200070209     C                   ENDIF                                                  024300070219     C* WHEN ADDING CUSTOMER MUST NOT EXIST                                     024400090303     C     ACTDSP        IFEQ      'ADDITION'                                   024500070212     C     XWBCCD        SETLL     CUSTS                                  99    024600070209     C     *IN99         IFEQ      '1'                                          024700070212     C                   MOVE      *ON           *IN31                          024800070209     C                   MOVE      'Y2U0003'     MSGID                          024900070213     C                   MOVEL     *ALL'-'       XWG4TX                         025000070209     C                   CALL      RTNMTX                                       025100070209     C                   PARM                    MSGID             7            025200070209     C                   PARM                    ERRMSG          132            025300070209     C                   LEAVE                                                  025400070209     C                   ENDIF                                                  025500070209     C                   ENDIF                                                  025600070219     C*‚Customer name                                                           025700070213     C     XWG4TX        IFEQ      *BLANKS                                      025800070212     C                   MOVE      *ON           *IN32                          025900070212     C                   MOVE      *ON           *IN99                          026000070212     C                   MOVE      'OEM0012'     MSGID                          026100070212     C                   CALL      RTNMTX                                       026200070212     C                   PARM                    MSGID             7            026300070212     C                   PARM                    ERRMSG          132            026400070212     C                   LEAVE                                                  026500070212     C                   ENDIF                                                  026600070219     C*- CUSTOMER GROUP                                                         026700070306     C     XWBNCD        CHAIN     CUSGRP                             99        026800070213     C     *IN99         IFEQ      '1'                                          026900070213     C                   MOVE      '1'           *IN33                          027000070213     C                   MOVE      'OES0374'     MSGID                          027100070213     C                   MOVEL     *ALL'-'       XWKHTX                         027200070213     C                   CALL      RTNMTX                                       027300070213     C                   PARM                    MSGID             7            027400070213     C                   PARM                    ERRMSG          132            027500070213     C                   LEAVE                                                  027600070213     C                   ENDIF                                                  027700070219     C*- SALESMAN                                                               027800070306     C     PERSON        CHAIN     SLMEN                              99        027900070213     C     *IN99         IFEQ      '1'                                          028000070213     C                   MOVE      '1'           *IN34                          028100070213     C                   MOVE      'OEM0023'     MSGID                          028200070213     C                   CALL      RTNMTX                                       028300070213     C                   PARM                    MSGID             7            028400070213     C                   PARM                    ERRMSG          132            028500070213     C                   MOVE      *ALL'-'       PNAME                          028600070213     C                   LEAVE                                                  028700070213     C                   ENDIF                                                  028800070219     C*- Distributor                                                            028900070306     C     DSDCDE        CHAIN     DISTS                              99        029000070213     C     *IN99         IFEQ      '1'                                          029100070213     C                   MOVE      '1'           *IN35                          029200070213     C                   MOVE      'OEM0018'     MSGID                          029300070213     C                   CALL      RTNMTX                                       029400070213     C                   PARM                    MSGID             7            029500070213     C                   PARM                    ERRMSG          132            029600070213     C                   MOVE      *ALL'-'       DNAME                          029700070213     C                   LEAVE                                                  029800070213     C                   ENDIF                                                  029900070201     C                   ENDDO                                                  030000070131     C                   ENDSR                                                  030100070305     C**********************************************************************    030200070305                                                                                030300070305     C**********************************************************************    030400070305     C     ADDREC        BEGSR                                                  030500070305     C**********************************************************************    030600070305     C*‚Subroutine: Add a record                                                030700070305     C**********************************************************************    030800070305     C                   MOVE      '0'           *IN94                          030900070305     C                   MOVE      '1'           *IN96                          031000070305     C                   MOVE      '0'           *IN97                          031100070305     C                   MOVEL     'ADDITION'    ACTDSP                         031200070306     C                   EXSR      OFFIND                                       031300070305                                                                                031400070305     C                   clear                   custsr                         031500080208     C                   eval      pname = *blanks                              031600080208     C                   eval      dname = *blanks                              031700080208     C                   eval      xwkhtx = *blanks                             031800080208     C                   exsr      mvdbsc                                       031900070305                                                                                032000070305     C*‚For each screen page                                                    032100110823     C     *IN03         DOWNE     '1'                                          032200110823     C     *IN12         ANDNE     '1'                                          032300110823                                                                                032400070305     C                   EXSR      DSPSCNS                                      032500070305                                                                                032600110824     C     *IN03         IFEQ      '1'                                          032700110824     C     *IN12         OREQ      '1'                                          032800110823     C                   LEAVE                                                  032900110823     C                   ENDIF                                                  033000070305                                                                                033100070305     C     *IN04         IFEQ      '1'                                          033200070305     C     *IN08         OREQ      '1'                                          033300070305     C     *IN09         OREQ      '1'                                          033400070305     C                   ITER                                                   033500070305     C                   ENDIF                                                  033600070305                                                                                033700070305     C                   EXSR      VALID1                                       033800070305                                                                                033900070305     C*‚If errors found                                                         034000070305     C     *IN99         IFEQ      '1'                                          034100070305     C*‚Display error message and re-display screen                             034200070305     C                   MOVEL     ERRMSG        ZMSAGE                         034300080208     C                   exsr      mvdbsc                                       034400070305     C                   iter                                                   034500070305     C                   ENDIF                                                  034600110823                                                                                034700070309     C*‚Request confirmation                                                    034800070309     C                   EXFMT     ZZCNF1                                       034900110824     C     *IN03         IFNE      '1'                                          035000070309     C     *IN12         ANDNE     '1'                                          035100070309     C*‚If confirmation received then write record                              035200070305     C                   WRITE     CUSTSR                               99      035300070305     C     *IN99         IFEQ      '1'                                          035400070305     C                   MOVE      'Y2U0004'     MSGID                          035500070305     C                   CALL      RTNMTX                                       035600070305     C                   PARM                    MSGID             7            035700070305     C                   PARM                    ERRMSG          132            035800070305     C* Display error message                                                   035900070305     C                   MOVEL     ERRMSG        ZMSAGE                         036000110824     C                   ELSE                                                   036100110824     C                   LEAVE                                                  036200070305     C                   ENDIF                                                  036300070309     C                   ENDIF                                                  036400070305                                                                                036500110823     C                   ENDDO                                                  036600070305                                                                                036700070305     C                   ENDSR                                                  036800070305     C**********************************************************************    036900070305                                                                                037000070305     C**********************************************************************    037100070305     C     CHGREC        BEGSR                                                  037200070305     C**********************************************************************    037300070305     C*‚Subroutine: Change a record                                             037400070305     C**********************************************************************    037500070305     C                   MOVEL     '  UPDATE'    ACTDSP                         037600070305     C                   MOVE      '0'           *IN94                          037700070306     C                   MOVE      '0'           *IN96                          037800070305     C                   MOVE      '0'           *IN97                          037900070306     C                   EXSR      OFFIND                                       038000070305                                                                                038100070305     C                   EXSR      GETREC                                       038200070813                                                                                038300080117     C*‚If no record or file error                                              038400070813     C     *IN99         IFEQ      *OFF                                         038500070813     C     *IN66         ANDEQ     *OFF                                         038600070305                                                                                038700110823     C     *IN03         DOWNE     '1'                                          038800110823     C     *IN12         ANDNE     '1'                                          038900110823                                                                                039000070305     C                   EXSR      DSPSCNS                                      039100070305                                                                                039200070305     C     *IN03         IFEQ      '1'                                          039300070305     C     *IN12         OREQ      '1'                                          039400070305     C                   LEAVE                                                  039500070305     C                   ENDIF                                                  039600070305                                                                                039700070305     C     *IN04         IFEQ      '1'                                          039800070305     C     *IN08         OREQ      '1'                                          039900070305     C     *IN09         OREQ      '1'                                          040000070305     C                   ITER                                                   040100070305     C                   ENDIF                                                  040200070305                                                                                040300070305     C                   EXSR      VALID1                                       040400070305                                                                                040500070305     C*‚If errors found                                                         040600070305     C     *IN99         IFEQ      '1'                                          040700070305     C*‚Display error message and re-display screen                             040800070305     C                   MOVEL     ERRMSG        ZMSAGE                         040900080208     C                   exsr      mvdbsc                                       041000080208     C                   iter                                                   041100070305     C                   ENDIF                                                  041200070305                                                                                041300070305     C*‚Request confirmation                                                    041400070305     C                   EXFMT     ZZCNF1                                       041500070305     C     *IN03         IFNE      '1'                                          041600070305     C     *IN12         ANDNE     '1'                                          041700070305     C*‚If confirmation received then update record                             041800080117     C     xwbccd        chain(e)  custsr                                       041900080117     C                   if        %found(custs)                                042000080208     C                   exsr      mvscdb                                       042100070305     C                   UPDATE    CUSTSR                               99      042200070305     C     *IN99         IFEQ      '1'                                          042300070305     C                   MOVE      'Y2U0007'     MSGID                          042400070305     C                   CALL      RTNMTX                                       042500070305     C                   PARM                    MSGID             7            042600070305     C                   PARM                    ERRMSG          132            042700070305     C* Display error message                                                   042800070305     C                   MOVEL     ERRMSG        ZMSAGE                         042900070305     C                   ENDIF                                                  043000080117     C                   else                                                   043100080117     C                   unlock(e) custs                                        043200080117     C                   endif                                                  043300070305     C                   ENDIF                                                  043400080117                                                                                043500110823     C                   ENDDO                                                  043600110823                                                                                043700080117     C*‚End: If no record or file error                                         043800070813     C                   ENDIF                                                  043900070305                                                                                044000070305     C                   MOVE      SFLRRN        SHWREC                         044100070305                                                                                044200070305     C                   ENDSR                                                  044300070305     C**********************************************************************    044400070305                                                                                044500070305     C**********************************************************************    044600070305     C     DELREC        BEGSR                                                  044700070305     C**********************************************************************    044800070305     C*‚Subroutine: Delete a record                                             044900070305     C**********************************************************************    045000070305     C                   MOVEL     '  DELETE'    ACTDSP                         045100070305     C                   MOVE      '1'           *IN94                          045200070306     C                   MOVE      '0'           *IN96                          045300070305     C                   MOVE      '1'           *IN97                          045400070306     C                   EXSR      OFFIND                                       045500070305                                                                                045600070305     C                   EXSR      GETREC                                       045700070305                                                                                045800110823     C     *IN03         DOWNE     '1'                                          045900110823     C     *IN12         ANDNE     '1'                                          046000110823                                                                                046100070305     C                   EXSR      DSPSCNS                                      046200070305                                                                                046300070305     C     *IN03         IFEQ      '1'                                          046400070305     C     *IN12         OREQ      '1'                                          046500070305     C                   LEAVE                                                  046600070305     C                   ENDIF                                                  046700070305                                                                                046800070305     C     *IN04         IFEQ      '1'                                          046900070305     C     *IN08         OREQ      '1'                                          047000070305     C     *IN09         OREQ      '1'                                          047100070305     C                   ITER                                                   047200070305     C                   ENDIF                                                  047300070305                                                                                047400070309     C*‚Request confirmation                                                    047500070309     C                   EXFMT     ZZCNF1                                       047600080117                                                                                047700070309     C     *IN03         IFNE      '1'                                          047800070309     C     *IN12         ANDNE     '1'                                          047900070309     C*‚If confirmation received then delete record                             048000080117     C     xwbccd        chain(e)  custsr                                       048100080117     C                   if        %found(custs)                                048200080117     C                   delete(e) custsr                                       048300080117     C                   else                                                   048400080117     C                   unlock(e) custs                                        048500080117     C                   endif                                                  048600110824     C                   LEAVE                                                  048700080117     C                   ENDIF                                                  048800070309                                                                                048900070309     C*‚End: If not F3/F12                                                      049000110823     C                   ENDDO                                                  049100070305                                                                                049200070305     C                   MOVE      SFLRRN        SHWREC                         049300070305                                                                                049400070305     C                   ENDSR                                                  049500070305     C**********************************************************************    049600070305                                                                                049700070305     C**********************************************************************    049800070305     C     DSPREC        BEGSR                                                  049900070305     C**********************************************************************    050000070305     C*‚Subroutine: Display a record                                            050100070305     C**********************************************************************    050200070305     C                   MOVE      '1'           *IN94                          050300070306     C                   MOVE      '0'           *IN96                          050400070305     C                   MOVE      '0'           *IN97                          050500070305     C                   MOVEL     ' DISPLAY'    ACTDSP                         050600070306     C                   EXSR      OFFIND                                       050700070305                                                                                050800070305     C                   EXSR      GETREC                                       050900080117                                                                                051000110823     C     *IN03         DOWNE     '1'                                          051100110823     C     *IN12         ANDNE     '1'                                          051200110823                                                                                051300070305     C                   EXSR      DSPSCNS                                      051400070305                                                                                051500070305     C     *IN03         IFEQ      '1'                                          051600070305     C     *IN12         OREQ      '1'                                          051700070305     C                   LEAVE                                                  051800070305     C                   ENDIF                                                  051900070305                                                                                052000070305     C     *IN04         IFEQ      '1'                                          052100070305     C     *IN08         OREQ      '1'                                          052200070305     C     *IN09         OREQ      '1'                                          052300070305     C                   ITER                                                   052400070305     C                   ENDIF                                                  052500070305                                                                                052600110823     C                   ENDDO                                                  052700110823                                                                                052800070305     C                   MOVE      SFLRRN        SHWREC                         052900070305                                                                                053000070305     C                   ENDSR                                                  053100070305     C**********************************************************************    053200070305                                                                                053300070305     C**********************************************************************    053400070305     C     GETREC        BEGSR                                                  053500070305     C**********************************************************************    053600070305     C*‚Subroutine: Retrieve a record                                           053700070305     C**********************************************************************    053800080117     C     XWBCCD        CHAIN(N)  CUSTS                              9966      053900071221                                                                                054000071221     C                   select                                                 054100071221     C*‚If record error                                                         054200071221     C                   when      *in99 = *on                                  054300070813     C                   MOVE      'OES0115'     MSGID                          054400070305     C                   CALL      RTNMTX                                       054500070305     C                   PARM                    MSGID             7            054600070305     C                   PARM                    ERRMSG          132            054700070305     C                   MOVEL     ERRMSG        ZMSAGE                         054800071221                                                                                054900071221     C*‚If file error                                                           055000071221     C                   when      *in66 = *on                                  055100070813     C     FILESTS       IFEQ      1218                                         055200070813     C                   MOVE      'Y3U9999'     MSGID                          055300070813     C                   CALL      RTNMTX                                       055400070813     C                   PARM                    MSGID             7            055500070813     C                   PARM                    ERRMSG          132            055600070813     C                   MOVEL     ERRMSG        ZMSAGE                         055700070813     C                   ELSE                                                   055800070813     C                   MOVE      'OEM0004'     MSGID                          055900070813     C                   CALL      RTNMTX                                       056000070813     C                   PARM                    MSGID             7            056100070813     C                   PARM                    ERRMSG          132            056200070813     C                   MOVEL     ERRMSG        ZMSAGE                         056300070813     C                   ENDIF                                                  056400071221                                                                                056500071221     C*‚If no errors                                                            056600071221     C                   other                                                  056700070305                                                                                056800071221     C*‚Retrieve Salesman's name                                                056900071221     C     PERSON        CHAIN(E)  SLMEN                                        057000071221     C                   if        not %found(slmen)                            057100071221     C                   eval      pname = *all'-'                              057200071221     C                   endif                                                  057300071221                                                                                057400071221     C*‚Retrieve Distributor's name                                             057500071221     C     DSDCDE        CHAIN(E)  DISTS                                        057600071221     C                   if        not %found(dists)                            057700071221     C                   eval      dname = *all'-'                              057800071221     C                   endif                                                  057900071221                                                                                058000071221     C*‚Retrieve Customer Group's name                                          058100071221     C     XWBNCD        CHAIN(E)  CUSGRP                                       058200071221     C                   if        not %found(cusgrp)                           058300071221     C                   eval      xwkhtx = *all'-'                             058400071221     C                   endif                                                  058500080117                                                                                058600080208     C                   exsr      mvdbsc                                       058700071221                                                                                058800071221     C                   endsl                                                  058900071221                                                                                059000070305     C                   ENDSR                                                  059100070305     C**********************************************************************    059200070305                                                                                059300070305     C**********************************************************************    059400070130     C     *INZSR        BEGSR                                                  059500070305     C**********************************************************************    059600070130     C*‚Subroutine: Initialisation routines                                     059700070305     C**********************************************************************    059800070130     C*‚Initialise message subfile                                              059900070213     C                   MOVE      '1'           *IN82                          060000070212     C                   MOVEL     'WWCUSTS '    ZZPGM                          060100070130     C*-‚Set date                                                               060200070130     C                   MOVE      *DATE         ZZDATE                         060300070205     C                   MOVE      *YEAR         ZYR                            060400070205     C                   MOVE      '-'           FILLR1                         060500070205     C                   MOVE      *MONTH        ZMTH                           060600070205     C                   MOVE      '-'           FILLR2                         060700070205     C                   MOVE      *DAY          ZDAY                           060800070130     C                   ENDSR                                                  060900070305     C**********************************************************************    061000070305                                                                                061100070305     C**********************************************************************    061200070213     C     SRPROM        BEGSR                                                  061300070305     C**********************************************************************    061400070213     C*‚Subroutine: prompts for F04                                             061500070305     C**********************************************************************    061600070213     C                   SELECT                                                 061700080208     C     SFIELD        WHENEQ    'ZPERSON'                                    061800070213     C                   CALL      'SLMENSEL'                                   061900080208     C                   PARM                    ZPERSON                        062000070213     C                   PARM                    PNAME                          062400080208     C     SFIELD        WHENEQ    'ZWBNCD'                                     062500070213     C                   CALL      'CUSGRSEL'                                   062600080208     C                   PARM                    ZWBNCD                         062700080208     C                   PARM                    ZWKHTX                         062800080208     C     SFIELD        WHENEQ    'ZDSDCDE'                                    062900070213     C                   CALL      'DISTSSEL'                                   063000080208     C                   PARM                    ZDSDCDE                        063100070213     C                   PARM                    DNAME                          063200070213     C                   ENDSL                                                  063300070213     C                   ENDSR                                                  063400070305     C**********************************************************************    063500070305                                                                                063600070305     C**********************************************************************    063700070306     C     OFFIND        BEGSR                                                  063800070305     C**********************************************************************    063900070213     C*‚Subroutine: Set error indicators to OFF                                 064000070305     C**********************************************************************    064100070212     C                   MOVE      *OFF          *IN99                          064200070212     C                   MOVE      *OFF          *IN31                          064300070212     C                   MOVE      *OFF          *IN32                          064400070212     C                   MOVE      *OFF          *IN33                          064500070212     C                   MOVE      *OFF          *IN34                          064600070212     C                   MOVE      *OFF          *IN35                          064700070306     C                   MOVE      *OFF          *IN36                          064800070306     C                   MOVE      *OFF          *IN37                          064900070306     C                   MOVE      *BLANKS       ZMSAGE                         065000070212     C                   ENDSR                                                  065100070305     C**********************************************************************    065200070305                                                                                065300070305     C**********************************************************************    065400070213     C     ZORDER        BEGSR                                                  065500070305     C**********************************************************************    065600070213     C*‚Subroutine: Customer Orders                                             065700070305     C**********************************************************************    065800090304     C*    XWBCCD        CHAIN     CONHDRL1                           77        065900090304     C*    *IN77         IFEQ      '0'                                          066000070214     C                   CALL      'WWCONHDR'                                   066100070213     C                   PARM                    XWBCCD                         066200090304     C*                  ELSE                                                   066300090304     C*                  MOVE      '1'           *IN99                          066400090304     C*                  MOVE      'YYG0012'     MSGID                          066500090304     C*                  CALL      RTNMTX                                       066600090304     C*                  PARM                    MSGID             7            066700090304     C*                  PARM                    ERRMSG          132            066800070219     C* Display error message                                                   066900090304     C*                  MOVEL     ERRMSG        ZMSAGE                         067000090304     C*                  ENDIF                                                  067100070213     C                   ENDSR                                                  067200070305     C**********************************************************************    067300070305                                                                                067400070305     C**********************************************************************    067500070213     C     ZHISTO        BEGSR                                                  067600070305     C**********************************************************************    067700070213     C*‚Subroutine: Transaction history                                         067800070305     C**********************************************************************    067900090304     C*    XWBCCD        CHAIN     TRNHSTL3                           77        068000090304     C*    *IN77         IFEQ      '0'                                          068100070213     C                   CALL      'WWTRNHST'                                   068200070213     C                   PARM                    XWBCCD                         068300090304     C*                  ELSE                                                   068400090304     C*                  MOVE      '1'           *IN99                          068500090304     C*                  MOVE      'YYG0012'     MSGID                          068600090304     C*                  CALL      RTNMTX                                       068700090304     C*                  PARM                    MSGID             7            068800090304     C*                  PARM                    ERRMSG          132            068900070219     C* Display error message                                                   069000090304     C*                  MOVEL     ERRMSG        ZMSAGE                         069100090304     C*                  ENDIF                                                  069200070213     C                   ENDSR                                                  069300080208     C**********************************************************************    069400080208     C     MVDBSC        BEGSR                                                  069500080208     C                   MOVEL     XWBCCD        ZWBCCD                         069600080208     C                   MOVEL     XWG4TX        ZWG4TX                         069700080208     C                   MOVEL     XWB2CD        ZWB2CD                         069800080208     C                   MOVEL     XWB3CD        ZWB3CD                         069900080208     C                   MOVEL     XWHITX        ZWHITX                         070000080208     C                   MOVEL     XWE0NB        ZWE0NB                         070100080208     C                   MOVEL     XWJUN0        ZWJUN0                         070200080208     C                   MOVEL     XWDVCD        ZWDVCD                         070300080208     C                   MOVEL     XWBNCD        ZWBNCD                         070400080208     C                   MOVEL     PERSON        ZPERSON                        070500080208     C                   MOVEL     DSDCDE        ZDSDCDE                        070600080208     C                   MOVEL     XWBTCD        ZWBTCD                         070700080208     C                   MOVEL     XWGIVA        ZWGIVA                         070800080208     C                   MOVEL     XWAOCD        ZWAOCD                         070900080208     C                   MOVEL     XWBBCD        ZWBBCD                         071000080208     C                   MOVEL     XWG4T0        ZWG4T0                         071100080208     C                   MOVEL     XWC7ST        ZWC7ST                         071200080208     C                   MOVEL     XWDAST        ZWDAST                         071300080208     C                   MOVEL     XWBPD0        ZWBPD0                         071400080208     C                   MOVEL     XWBAD0        ZWBAD0                         071500080208     C                   MOVEL     XWKHTX        ZWKHTX                         071600080208     C                   ENDSR                                                  071700080208     C**********************************************************************    071800080208     C     MVSCDB        BEGSR                                                  071900080208     C                   MOVEL     ZWBCCD        XWBCCD                         072000080208     C                   MOVEL     ZWG4TX        XWG4TX                         072100080208     C                   MOVEL     ZWB2CD        XWB2CD                         072200080208     C                   MOVEL     ZWB3CD        XWB3CD                         072300080208     C                   MOVEL     ZWHITX        XWHITX                         072400080208     C                   MOVEL     ZWE0NB        XWE0NB                         072500080208     C                   MOVEL     ZWJUN0        XWJUN0                         072600080208     C                   MOVEL     ZWDVCD        XWDVCD                         072700080208     C                   MOVEL     ZWBNCD        XWBNCD                         072800080208     C                   MOVEL     ZPERSON       PERSON                         072900080208     C                   MOVEL     ZDSDCDE       DSDCDE                         073000080208     C                   MOVEL     ZWBTCD        XWBTCD                         073100080208     C                   MOVEL     ZWGIVA        XWGIVA                         073200080208     C                   MOVEL     ZWAOCD        XWAOCD                         073300080208     C                   MOVEL     ZWBBCD        XWBBCD                         073400080208     C                   MOVEL     ZWG4T0        XWG4T0                         073500080208     C                   MOVEL     ZWC7ST        XWC7ST                         073600080208     C                   MOVEL     ZWDAST        XWDAST                         073700080208     C                   MOVEL     ZWBPD0        XWBPD0                         073800080208     C                   MOVEL     ZWBAD0        XWBAD0                         073900080208     C                   MOVEL     ZWKHTX        XWKHTX                         074000080208     C                   ENDSR                                                  074100070305     C**********************************************************************    