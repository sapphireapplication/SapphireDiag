000100070317     H*‚--------------------------------------------------------------------    000200040512     H*ˆCOPYRIGHT DATABOROUGH LTD 2004                                          000300040512     H*‚--------------------------------------------------------------------    000400040512     F**********************************************************************    000500040512     F*‚F i l e s                                                               000600040512     F**********************************************************************    000700101101     FCUSFMAINTDCF   E             WORKSTN                                      000800070126     FCUSFL3    UF   E           K DISK                                         000900070126     FDISTS     IF   E           K DISK                                         000901110922                                                                                001000070126     D**********************************************************************    001100070126     D*‚D e f i n i t i o n s                                                   001200070126     D**********************************************************************    001300070126     D STTSES          S              1    DIM(37) CTDATA PERRCD(37)            001400070129     D MTH             S              3    DIM(12) CTDATA PERRCD(12)            001500070130     D VALNUM          S              1    DIM(11) CTDATA PERRCD(11)            001600070126     D**********************************************************************    001700070129     D                 DS                                                       001800070129     D  Y8MMDD                 1      8  0                                      001900070129     D  YY8                    1      4  0                                      002000070130     D  MM8                    5      6  0                                      002100070129     D  DD8                    7      8  0                                      002200070129     D                 DS                                                       002300070129     D  ZTELNO                 1     17                                         002400070129     D  XTELNO                 1     17                                         002500070129     D                                     DIM(17)                              002600070129     D                 DS                                                       002700070129     D  ZFAXNO                 1     15                                         002800070129     D  XFAXNO                 1     15                                         002900070129     D                                     DIM(15)                              003000070129     D                 DS                  INZ                                  003100070129     D  ZDATE                  1     11                                         003200070129     D  ZDAY                   1      2                                         003300070129     D  FLLER1                 3      3                                         003400070129     D  ZMTH                   4      6                                         003500070129     D  FLLER2                 7      7                                         003600070129     D  ZYR                    8     11                                         003700070126     D*********************************************************************     003800070129     D RTNMTX          C                   CONST('RTNMSGTEXT')                  003900070129     D PROFES          C                   CONST('Professor')                   004000070221     D ZZPGM           C                   CONST('CUSFMAINT ')                  004100070126     C*****************************************************                     004200040512     C*‚M a i n l i n e   C o d e                                               004300040512     C*****************************************************                     004400040512     C*‚Retrieve record                                                         004500070126     C     CUSNO         CHAIN     RCUSF                              01        004600070126     C     *IN01         IFEQ      '1'                                          004700070126     C                   MOVE      '1'           *INLR                          004800070126     C                   RETURN                                                 004900070126     C                   ENDIF                                                  005000040512     C*‚Set screen values                                                       005100070129     C                   EXSR      WRTSCN                                       005200070302     C                   clear                   ZMSAGE                         005300070129     C*-                                                                        005400040512     C*‚Until Exit/Cancel                                                       005500070129     C     *IN03         DOWEQ     '0'                                          005600070129     C     *IN12         ANDEQ     '0'                                          005700070129     C*-                                                              |         005800040513     C*‚Display screen                                                |         005900070130     C     CURPAG        IFEQ      1                                            006000070130     C                   EXFMT     ZZFT01                               99      006100070130     C                   ELSE                                                   006200070130     C                   EXFMT     ZZFT02                               99      006300070130     C                   END                                                    006400040512     C*‚If Exit/Cancel                                                |         006500070129     C     *IN03         IFEQ      '1'                                          006600070129     C     *IN12         OREQ      '1'                                          006700070129     C                   LEAVE                                                  006800070129     C                   ENDIF                                                  006900050818     C*‚Other Command Keys                                            |         007000070129     C                   SELECT                                                 007100070130     C     *IN18         WHENEQ    '1'                                          007200070130     C                   MOVE      2             CURPAG                         007300070130     C                   MOVE      '0'           *IN18                          007400070130     C                   ITER                                                   007500070130     C     *IN17         WHENEQ    '1'                                          007600070130     C                   MOVE      1             CURPAG                         007700070130     C                   MOVE      '0'           *IN17                          007800070130     C                   ITER                                                   007900070130     C     *IN08         WHENEQ    '1'                                          008000070129     C                   CALL      'WWCCONS'                            99      008100070129     C                   PARM                    ZCUSNO                         008200070129     C                   ITER                                                   008300070129     C     *IN09         WHENEQ    '1'                                          008400070129     C                   CALL      'DSPDISTS'                           99      008500070129     C                   PARM                    ZDSCDE                         008600070129     C                   ITER                                                   008700070129     C     *IN10         WHENEQ    '1'                                          008800070129     C                   CALL      'WWRAREAS'                           99      008900070129     C                   PARM                    ZSINIT                         009000070129     C                   ITER                                                   009100070129     C                   ENDSL                                                  009200040512     C*‚Else validate                                                 |         009300070129     C                   EXSR      VALIDT                                       009400040513     C*‚If valid                                                      |         009500070129     C     VALID         IFEQ      '1'                                          009600040513     C*‚Update file and leave                                        ||         009700070129     C                   EXSR      UPDFIL                                       009800070129     C                   LEAVE                                                  009900040513     C*‚Else: If not valid                                           ||         010000070129     C                   ELSE                                                   010100040513     C*‚Display error message                                        ||         010200070129     C                   MOVEL     ERRMSG        ZMSAGE                         010300040513     C*‚End: If valid                                                ||         010400070129     C                   ENDIF                                                  010500040512     C*‚End: Until Exit/Cancel                                        |         010600070129     C                   ENDDO                                                  010700070129     C                   MOVE      '1'           *INLR                          010800070129     C                   RETURN                                                 010900040512     C*****************************************************                     011000040512     C*‚L o g i c al   E n d   o f   P r o g r a m                              011100040512     C*****************************************************                     011200070129     C*                                                                         011300040512     C*****************************************************                     011400070129     C     WRTSCN        BEGSR                                                  011500040512     C*****************************************************                     011600040512     C*‚Subroutine: Write screen                                                011700040512     C*****************************************************                     011800070129     C                   MOVE      CUSNO         ZCUSNO                         011900070129     C                   MOVE      CNAME         ZCNAME                         012000070129     C                   MOVE      ADD1          ZADD1                          012100070129     C                   MOVE      ADD2          ZADD2                          012200070129     C                   MOVE      ADD3          ZADD3                          012300070129     C                   MOVE      ADD4          ZADD4                          012400070129     C                   MOVE      CNTRY         ZCNTRY                         012500070129     C                   MOVE      PSCD          ZPSCD                          012600070129     C                   MOVE      TELNO         ZTELNO                         012700070129     C                   MOVE      FAXNO         ZFAXNO                         012800070129     C                   MOVE      EMAIL         ZEMAIL                         012900070129     C                   MOVE      WEBSIT        ZWEBST                         013000070129     C                   MOVE      DSDCDE        ZDSCDE                         013100070129     C                   MOVE      SINIT         ZSINIT                         013200070129     C                   MOVE      STATUS        ZSTTUS                         013300070129     C                   MOVE      USERNM        ZUSRNM                         013400070129     C                   MOVE      SALUT         ZSALUT                         013500070129     C                   MOVE      JTITLE        ZJTTLE                         013600070129     C* VER *YMD                                                                013700070130     C                   Z-ADD     LCTDAT        Y8MMDD                         013800070129     C                   EXSR      SDT6T8                                       013900070129     C                   Z-ADD     Y8MMDD        ZLCTDT                         014000070129     C* VER *YMD                                                                014100070130     C                   Z-ADD     APDATE        Y8MMDD                         014200070129     C                   EXSR      SDT6T8                                       014300070129     C                   Z-ADD     Y8MMDD        ZAPDAT                         014400070129     C*                                                                         014500070129     C                   ENDSR                                                  014600040512     C*****************************************************                     014700040513     C*****************************************************                     014800070129     C     SDT6T8        BEGSR                                                  014900070129     C*****************************************************                     015000070129     C*‚Subroutine: Converts dates                                              015100070129     C*****************************************************                     015200070130     C     YY8           IFLT      50                                           015300070129     C                   ADD       2000          YY8                            015400070129     C                   ELSE                                                   015500070129     C                   ADD       1900          YY8                            015600070129     C                   ENDIF                                                  015700070129     C                   ENDSR                                                  015800070129     C*****************************************************                     015900070129     C*****************************************************                     016000070129     C     UPDFIL        BEGSR                                                  016100040513     C*****************************************************                     016200040513     C*‚Subroutine: Update file                                                 016300040513     C*****************************************************                     016400070129     C                   MOVE      ZCUSNO        CUSNO                          016500070129     C                   MOVE      ZCNAME        CNAME                          016600070129     C                   MOVE      ZADD1         ADD1                           016700070129     C                   MOVE      ZADD2         ADD2                           016800070129     C                   MOVE      ZADD3         ADD3                           016900070129     C                   MOVE      ZADD4         ADD4                           017000070129     C                   MOVE      ZCNTRY        CNTRY                          017100070129     C                   MOVE      ZPSCD         PSCD                           017200070129     C                   MOVE      ZTELNO        TELNO                          017300070129     C                   MOVE      ZFAXNO        FAXNO                          017400070129     C                   MOVE      ZEMAIL        EMAIL                          017500070129     C                   MOVE      ZWEBST        WEBSIT                         017600070129     C                   MOVE      ZDSCDE        DSDCDE                         017700070129     C                   MOVE      ZSINIT        SINIT                          017800070129     C                   MOVE      ZSTTUS        STATUS                         017900070129     C                   MOVE      ZUSRNM        USERNM                         018000070129     C                   MOVE      ZSALUT        SALUT                          018100070129     C                   MOVE      ZJTTLE        JTITLE                         018200070129     C* VER *YMD                                                                018300070130     C                   MOVE      ZLCTDT        LCTDAT                         018400070129     C* VER *YMD                                                                018500070130     C                   MOVE      ZAPDAT        APDATE                         018600070129     C                   UPDATE    RCUSF                                99      018700070129     C     *IN99         IFEQ      '0'                                          018800070129     C                   MOVE      'Y'           UPDTED                         018900070129     C                   ENDIF                                                  019000070129     C                   ENDSR                                                  019100040513     C*****************************************************                     019200040512     C*****************************************************                     019300040512     C*‚Subroutine: Validate screen                                             019400040512     C*****************************************************                     019500070129     C     VALIDT        BEGSR                                                  019600040512     C*****************************************************                     019700070130     C                   MOVE      CURPAG        PRVPAG            1 0          019800070129     C                   DO                                                     019900070129     C                   MOVE      *OFF          *IN32                          020000070129     C                   MOVE      *OFF          *IN33                          020100070129     C                   MOVE      *OFF          *IN34                          020200070129     C                   MOVE      *OFF          *IN35                          020300070129     C                   MOVE      *OFF          *IN36                          020400070129     C                   MOVE      *OFF          *IN37                          020500070129     C                   MOVE      *OFF          *IN38                          020600070129     C                   MOVE      *OFF          *IN39                          020700070129     C                   MOVE      *OFF          *IN40                          020800070129     C                   MOVE      *OFF          *IN41                          020900070129     C                   MOVE      *OFF          *IN42                          021000070129     C                   MOVE      *OFF          *IN43                          021100070129     C                   MOVE      *OFF          *IN44                          021200070129     C                   MOVE      '1'           VALID             1            021300040512     C*‚Customer name                                                 |         021400070129     C     ZCNAME        IFEQ      *BLANKS                                      021500070129     C                   MOVE      *ON           *IN32                          021600070129     C                   MOVE      'OEM0012'     MSGID                          021700070129     C                   CALL      RTNMTX                                       021800070129     C                   PARM                    MSGID             7            021900070129     C                   PARM                    ERRMSG          132            022000070129     C                   MOVE      '0'           VALID                          022100070129     C                   LEAVE                                                  022200070129     C                   ENDIF                                                  022300040513     C*‚Telephone number                                              |         022400070129     C     ZTELNO        IFNE      *BLANKS                                      022500070129     C                   Z-ADD     1             Z1                             022600070129     C     Z1            DOWLE     17                                           022700070129     C     XTELNO(Z1)    LOOKUP    VALNUM                                 99    022800070129     C     *IN99         IFEQ      '0'                                          022900070129     C                   MOVE      *ON           *IN34                          023000070129     C                   MOVE      'OEM0014'     MSGID                          023100070129     C                   CALL      RTNMTX                                       023200070129     C                   PARM                    MSGID                          023300070129     C                   PARM                    ERRMSG                         023400070129     C                   MOVE      '0'           VALID                          023500070129     C                   LEAVE                                                  023600070129     C                   ENDIF                                                  023700070129     C                   ADD       1             Z1                             023800070129     C                   ENDDO                                                  023900070129     C   34              LEAVE                                                  024000070129     C                   ENDIF                                                  024100040513     C*‚Fax number                                                    |         024200070129     C     ZFAXNO        IFNE      *BLANKS                                      024300070129     C                   Z-ADD     1             Z1                             024400070129     C     Z1            DOWLE     15                                           024500070129     C     XFAXNO(Z1)    LOOKUP    VALNUM                                 99    024600070129     C     *IN99         IFEQ      '0'                                          024700070129     C                   MOVE      *ON           *IN35                          024800070129     C                   MOVE      'OEM0015'     MSGID                          024900070129     C                   CALL      RTNMTX                                       025000070129     C                   PARM                    MSGID                          025100070129     C                   PARM                    ERRMSG                         025200070129     C                   MOVE      '0'           VALID                          025300070129     C                   LEAVE                                                  025400070129     C                   ENDIF                                                  025500070129     C                   ADD       1             Z1                             025600070129     C                   ENDDO                                                  025700070129     C   35              LEAVE                                                  025800070129     C                   ENDIF                                                  025900070130     C*-                                                              |         026000070130     C                   MOVE      2             CURPAG                         026100040513     C*‚Distributor                                                   |         026200070129     C     ZDSCDE        IFNE      *BLANKS                                      026300070129     C     ZDSCDE        SETLL     RPRODS                                 99    026400070130     C     *IN99         IFEQ      '0'                                          026500070129     C                   MOVE      *ON           *IN38                          026600070129     C                   MOVE      'OEM0018'     MSGID                          026700070129     C                   CALL      RTNMTX                                       026800070129     C                   PARM                    MSGID                          026900070129     C                   PARM                    ERRMSG                         027000070129     C                   MOVE      '0'           VALID                          027100070129     C                   LEAVE                                                  027200070129     C                   ENDIF                                                  027300070129     C                   ENDIF                                                  027400040513     C*‚Status                                                        |         027500070129     C     ZSTTUS        IFNE      *BLANKS                                      027600070129     C                   MOVE      1             Z1                5 0          027700070130     C     ZSTTUS        LOOKUP    STTSES                                 77    027800070129     C     *IN77         IFEQ      '0'                                          027900070129     C                   MOVE      *ON           *IN39                          028000070129     C                   MOVE      'OEM0019'     MSGID                          028100070129     C                   CALL      RTNMTX                                       028200070129     C                   PARM                    MSGID                          028300070129     C                   PARM                    ERRMSG                         028400070129     C                   MOVE      '0'           VALID                          028500070129     C                   LEAVE                                                  028600070129     C                   ENDIF                                                  028700070129     C                   ENDIF                                                  028800040513     C*‚Contact                                                       |         028900070130     C     ZUSRNM        IFEQ      *BLANKS                                      029000070129     C                   MOVE      *ON           *IN40                          029100070129     C                   MOVE      'OEM0020'     MSGID                          029200070129     C                   CALL      RTNMTX                                       029300070129     C                   PARM                    MSGID                          029400070129     C                   PARM                    ERRMSG                         029500070129     C                   MOVE      '0'           VALID                          029600070129     C                   LEAVE                                                  029700070129     C                   ENDIF                                                  029800040513     C*‚Title                                                         |         029900070129     C     ZSALUT        IFNE      *BLANKS                                      030000070129     C     ZSALUT        ANDNE     'Mr'                                         030100070129     C     ZSALUT        ANDNE     'Mrs'                                        030200070129     C     ZSALUT        ANDNE     'Ms'                                         030300070129     C     ZSALUT        ANDNE     'Dr'                                         030400070129     C     ZSALUT        ANDNE     'Doctor'                                     030500070129     C     ZSALUT        ANDNE     PROFES                                       030600070129     C     ZSALUT        ANDNE     'Sir'                                        030700070129     C     ZSALUT        ANDNE     'Lord'                                       030800070129     C     ZSALUT        ANDNE     'Lady'                                       030900070129     C                   MOVE      *ON           *IN41                          031000070129     C                   MOVE      'OEM0021'     MSGID                          031100070129     C                   CALL      RTNMTX                                       031200070129     C                   PARM                    MSGID                          031300070129     C                   PARM                    ERRMSG                         031400070129     C                   MOVE      '0'           VALID                          031500070129     C                   LEAVE                                                  031600070129     C                   ENDIF                                                  031700070130     C                   MOVE      PRVPAG        CURPAG                         031800070129     C                   ENDDO                                                  031900070129     C                   ENDSR                                                  032000040512     C*****************************************************                     032100040512     C*****************************************************                     032200070129     C     *INZSR        BEGSR                                                  032300040512     C*****************************************************                     032400040512     C*‚Subroutine: Perform Initialisation Routines                             032500040512     C*****************************************************                     032600040512     C*‚Set screen values                                                       032700070317     C                   MOVE      *DAY          ZDAY                           032800070317     C                   MOVE      *YEAR         ZYR                            032900070129     C                   MOVE      *MONTH        XMTH              2 0          033000070317     C                   MOVE      MTH(XMTH)     ZMTH                           033100070129     C                   MOVE      ZDATE         ZZDATE                         033200040512     C*‚- Protect customr number                                                033300070129     C                   MOVE      *ON           *IN31                          033400050801     C*‚If customer number not provided then prompt                             033500070129     C     CSTMER        IFEQ      *ZEROS                                       033600070129     C                   CALL      'CUSFSEL'                            99      033700070129     C                   PARM                    CSTMER                         033800070129     C                   ENDIF                                                  033900050801     C*‚Set customer number                                                     034000070129     C                   MOVE      CSTMER        CUSNO                          034100040512     C*‚Initialise updated flag                                                 034200070129     C                   MOVE      'N'           UPDTED                         034300070130     C                   MOVE      1             CURPAG            1 0          034400070129     C                   ENDSR                                                  034500040512     C*****************************************************                     034600040512     C*****************************************************                     034700040512     C*‚N o n - E x e c u t a b l e   C o d e                                   034800040512     C*****************************************************                     034900070129     C     *ENTRY        PLIST                                                  035000070129     C                   PARM                    CSTMER            5 0          035100070129     C                   PARM                    UPDTED            1            035200040512     C*****************************************************                     035300070129**                                                                              035400040513 0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ                                           035500070129**                                                                              035600070129JanFebMarAprMayJunJulAugSepOctNovDec                                            035700070129**                                                                              035800070129 0123456789                                                                     