000100080118     H*‚--------------------------------------------------------------------    000200070130     H*ˆCOPYRIGHT DATABOROUGH LTD 2007 - ROYMAN E. MOTA RUIZ                    000300070213     H*ˆPROGRAM:  Work with Customer Orders                                     000400010705     H*‚--------------------------------------------------------------------    000500070131     H DATEDIT(*YMD)                                                            000600980122     F**********************************************************************    000700990528     F*‚F i l e s                                                               000800980122     F**********************************************************************    000900070214     FWCONHDRD  CF   E             WORKSTN                                      001000070214     F                                     SFILE(ZZSF01:SFLRRN)                 001100070209     FCONHDR    UF A E           K DISK                                         001200070813     F                                     INFDS(FILEDS)                        001300070213     FCONHDRL1  IF   E           K DISK                                         001400070213     F                                     RENAME(CONHDRR:CONHDR2)              001500070131     FCUSTS     IF   E           K DISK                                         001600070214     FCUSFL3    IF   E           K DISK                                         001601110914     F*CUSFL5    IF   E           K DISK                                        001700070131     FSLMEN     IF   E           K DISK                                         001800070215     FORDSTS    IF   E           K DISK                                         001900070313                                                                                002000070313     D**********************************************************************    002100070313     D*‚D e f i n i t i o n s                                                   002200070313     D**********************************************************************    002300070313     D  sflrrn         s              5p 0                                      002400070313     D  sflchg         s              1a   inz('0')                             002500070313                                                                                002600070130     D*‚Set constants                                                           002700070131     D RTNMTX          C                   CONST('RTNMSGTEXT')                  002800070313                                                                                002900070813     d FILEDS          ds                                                       003000070813     d  FILESTS               11     15s 0                                      003100070813                                                                                003200070214     D                 DS                  INZ                                  003300070205     D  ZDATE                  1     10                                         003400070205     D  ZYR                    1      4                                         003500070205     D  FILLR1                 5      5                                         003600070205     D  ZMTH                   6      7                                         003700070205     D  FILLR2                 8      8                                         003800070205     D  ZDAY                   9     10                                         003900070313                                                                                004000070130     I**********************************************************************    004100070201     ICUSTSR                                                                    004200070201     I              PERSON                      PERCUS                          004300070313                                                                                004400070313     C*********************************************************************     004500070130     C*‚M a i n l i n e   C o d e                                               004600070313     C*********************************************************************     004700070313     C*‚Retrieve customer number data                                           004800070313     C     XWBCCD        CHAIN     CUSTS                              99        004900070306     C     CUSNO         CHAIN     CUSFL3                             99        005000070306     C     PERCUS        CHAIN     SLMEN                              99        005100070214     C   99              MOVEL     *ALL'-'       PNAME                          005200070214     C                   MOVEL     PNAME         SNAME                          005201110914     C*                  MOVE      PCUSN         SCUSN                          005300070313                                                                                005400070202     C*‚Build subfile                                                           005500070313     C                   EXSR      SFLWRT                                       005600070313                                                                                005700070130     C     *IN03         DOWEQ     '0'                                          005800070130     C     *IN12         ANDEQ     '0'                                          005900070202     C                   MOVE      *ZEROS        LOCATE                         006000070219     C*‚Display screens                                                         006100070201     C                   WRITE     ZZTR01                                       006200070313     C   99              WRITE     ZZMC01                                       006300070313     C                   EXFMT     ZZCT01                                       006400070219     C*‚Remove messages                                                         006500070130     C                   CALL      'XBCCLMSG'                                   006600070313                                                                                006700070131     C     *IN03         IFEQ      '1'                                          006800070131     C     *IN12         OREQ      '1'                                          006900070131     C                   LEAVE                                                  007000070131     C                   ENDIF                                                  007100070313                                                                                007200070313     C*‚Action positioner request                                               007300070202     C     LOCATE        IFNE      *ZEROS                                       007400070313     C                   MOVE      LOCATE        XWORDN                         007500070313     C                   EXSR      SFLWRT                                       007600070202     C                   ITER                                                   007700070202     C                   ENDIF                                                  007800070313                                                                                007900070219     C*‚Action command keys                                                     008000070130     C     *IN28         IFEQ      '1'                                          008100070130     C                   EXSR      CMDKEY                                       008200070130     C                   ELSE                                                   008300070219     C*‚Else action selections                                                  008400070130     C                   EXSR      ZSELEC                                       008500070130     C                   ENDIF                                                  008600070313                                                                                008700070219     C*‚If changes made then update display                                     008800070209     C     SFLCHG        IFEQ      '1'                                          008900070314     C                   MOVE      *ZEROS        XWORDN                         009000070314     C                   EXSR      SFLWRT                                       009100070209     C                   ENDIF                                                  009200070313                                                                                009300070130     C                   ENDDO                                                  009400070313                                                                                009500070131     C                   MOVE      '1'           *INLR                          009600070131     C                   RETURN                                                 009700070313     C*********************************************************************     009800070130     C*‚L o g i c a l   E n d   o f   P r o g r a m                             009900070313     C*********************************************************************     010000070313                                                                                010100070313     C*********************************************************************     010200070313     C     SFLWRT        BEGSR                                                  010300070313     C*********************************************************************     010400070313     C*‚Subroutine: Write data to subfile                                       010500070313     C*********************************************************************     010600070313     C     KEY01         KLIST                                                  010700070313     C                   KFLD                    XWBCCD                         010800070313     C                   KFLD                    XWORDN                         010900070313                                                                                011000070130     C*‚Delete subfile                                                          011100070131     C                   SETON                                        74        011200070131     C                   SETOFF                                       717231    011300070313     C                   WRITE     ZZCT01                               99      011400070313                                                                                011500070313     C     KEY01         SETLL     CONHDRL1                                     011600070313     C     XWBCCD        READE     CONHDRL1                               31    011700070313                                                                                011800070131     C                   SETOFF                                       74        011900070313                                                                                012000070130     C*‚Write subfile                                                           012100070130     C                   MOVE      *ZEROS        SFLRRN                         012200070313                                                                                012300070212     C     *IN31         DOWEQ     '0'                                          012400070130     C                   ADD       1             SFLRRN                         012500070130     C                   MOVE      *BLANKS       DSSEL                          012600070313     C                   WRITE     ZZSF01                               99      012700070313     C     XWBCCD        READE     CONHDRL1                               31    012800070130     C                   ENDDO                                                  012900070313                                                                                013000070130     C     SFLRRN        IFGT      *ZEROS                                       013100070215     C     SFLCHG        IFEQ      '0'                                          013200070313     C                   Z-ADD     1             SHWREC                         013300070215     C                   ENDIF                                                  013400070313     C                   ENDIF                                                  013500070313                                                                                013600070313     C     SHWREC        IFGT      SFLRRN                                       013700070313     C     SHWREC        ORLT      1                                            013800070313     C                   Z-ADD     1             SHWREC                         013900070215     C                   ENDIF                                                  014000070313                                                                                014100100927      * Richard T 27/09/10                                                      014200100927      * Set SFLDSP(*ON) only when there are records in the SFL!                 014300100927     C*                  SETON                                        71        014400100927     C                   If        SFLRRN > 0                                   014500100927     C                   Eval      *IN71 = *ON                                  014600100927     C                   Else                                                   014700100927     C                   Eval      *IN71 = *OFF                                 014701110914     C**                 Eval      *in72 = *off                                 014800100927     C                   EndIf                                                  014900100927                                                                                015000070131     C                   SETON                                        72        015100070313                                                                                015200070130     C                   ENDSR                                                  015300070313     C*********************************************************************     015400070313                                                                                015500070313     C*********************************************************************     015600070313     C     ZSELEC        BEGSR                                                  015700070313     C*********************************************************************     015800070313     C*‚Subroutine: Action selection                                            015900070313     C*********************************************************************     016000070130     C                   MOVE      '0'           SFLCHG                         016100070313     C                   READC     ZZSF01                                 35    016200070313                                                                                016300070130     C*‚For each selection                                                      016400070130     C     *IN35         DOWEQ     '0'                                          016500070130     C                   MOVE      '1'           SFLCHG                         016600070313                                                                                016700070130     C                   SELECT                                                 016800070219     C*‚Change                                                                  016900070130     C     DSSEL         WHENEQ    '2'                                          017000070313     C                   EXSR      CHGREC                                       017100070219     C*‚Delete                                                                  017200070313     C     DSSEL         WHENEQ    '4'                                          017300070313     C                   EXSR      DELREC                                       017400070219     C*‚Display                                                                 017500070313     C     DSSEL         WHENEQ    '5'                                          017600070313     C                   EXSR      DSPREC                                       017700070219     C*‚Lines                                                                   017800070130     C     DSSEL         WHENEQ    '7'                                          017900070201     C                   MOVE      *BLANKS       XWG4TX                         018000070130     C                   EXSR      ZLINES                                       018100070130     C                   ENDSL                                                  018200070313                                                                                018300070130     C                   MOVE      *BLANKS       DSSEL                          018400070313     C                   UPDATE    ZZSF01                               99      018500070313     C                   READC     ZZSF01                                 35    018600070219     C*‚End: For each selection                                                 018700070130     C                   ENDDO                                                  018800070313                                                                                018900070130     C                   MOVE      '0'           *IN12                          019000070313                                                                                019100070130     C                   ENDSR                                                  019200070313     C**********************************************************************    019300070313                                                                                019400070313     C**********************************************************************    019500070313     C     DSPSCN        BEGSR                                                  019600070313     C**********************************************************************    019700070201     C*‚Subroutine: Process screen                                              019800070313     C**********************************************************************    019900070131     C   99              WRITE     ZZMC01                               99      020000070131     C                   EXFMT     ZZFT01                                       020100070313                                                                                020200070130     C                   CALL      'XBCCLMSG'                                   020300070313                                                                                020400070209     C                   MOVE      '0'           *IN99                          020500070209     C                   MOVEA     '0000'        *IN(40)                        020600070313                                                                                020700070313     C                   SELECT                                                 020800070219     C*- Prompt                                                                 020900070313     C     *IN04         WHENEQ    '1'                                          021000070215     C                   EXSR      SRPROM                                       021100070219     C* Lines                                                                   021200070201     C     *IN07         WHENEQ    '1'                                          021300070201     C                   EXSR      ZLINES                                       021400070209     C                   ENDSL                                                  021500070313                                                                                021600070130     C                   ENDSR                                                  021700070313     C**********************************************************************    021800070313                                                                                021900070313     C**********************************************************************    022000070130     C     ZLINES        BEGSR                                                  022100070313     C**********************************************************************    022200070130     C*‚Subroutine: Contract Detail                                             022300070313     C**********************************************************************    022400080121     C     XWORDN        CHAIN(N)  CONHDR                             36        022500070130     C     *IN36         IFEQ      '0'                                          022600070201     C                   CALL      'WWCONDET'                                   022700070201     C                   PARM                    XWORDN                         022800070201     C                   PARM                    XWBCCD                         022900070201     C                   PARM                    XWG4TX                         023000070130     C                   ENDIF                                                  023100070130     C                   ENDSR                                                  023200070313     C**********************************************************************    023300070313                                                                                023400070313     C**********************************************************************    023500070313     C     ADDREC        BEGSR                                                  023600070313     C**********************************************************************    023700070130     C*‚Subroutine: Add record                                                  023800070313     C**********************************************************************    023900070130     C                   MOVE      '0'           *IN34                          024000070131     C                   MOVE      '1'           *IN36                          024100070302     C                   MOVE      '0'           *IN37                          024200070131     C                   MOVEL     'ADDITION'    ACTDSP                         024300070313                                                                                024400070130     C                   CLEAR                   XWCREF                         024500070202     C                   CLEAR                   XWDLDT                         024600070205     C                   MOVEL     ZDATE         XWDLDT                         024700070212     C                   CLEAR                   XWG4TX                         024800070209     C                   MOVE      '01'          XWSTAT                         024900070306     C     XWSTAT        CHAIN     ORDSTS                             99        025000070215     C   99              MOVEL     *ALL'-'       XWSDSC                         025100070130     C                   CLEAR                   PERSON                         025200070131     C                   CLEAR                   PNAME                          025300070130     C                   CLEAR                   XWTAMT                         025400070130     C                   CLEAR                   XWADD1                         025500070130     C                   CLEAR                   XWADD2                         025600070130     C                   CLEAR                   XWADD3                         025700070130     C                   CLEAR                   XWADD4                         025800070130     C                   CLEAR                   XWPCDE                         025900070130     C                   CLEAR                   XWCNTR                         026000070130     C                   CLEAR                   XWORDN                         026001110914     C***                CLEAR                   XWCUSN                         026100070313                                                                                026200070313     C     *IN03         DOWNE     '1'                                          026300070313     C     *IN12         ANDNE     '1'                                          026400070313     C                   EXSR      DSPSCN                                       026500070313     C     *IN04         IFEQ      '1'                                          026600070313     C     *IN07         OREQ      '1'                                          026700070313     C                   ITER                                                   026800070313     C                   ENDIF                                                  026900070313     C                   EXSR      VALIDT                                       027000070313     C     *IN99         IFEQ      '0'                                          027100070313     C                   LEAVE                                                  027200070314     C                   ELSE                                                   027300070314     C                   MOVEL     ERRMSG        ZMSAGE                         027400070313     C                   ENDIF                                                  027500070313     C                   ENDDO                                                  027600070313                                                                                027700070313     C     *IN03         IFNE      '1'                                          027800070313     C     *IN12         ANDNE     '1'                                          027900070313                                                                                028000070313     C                   EXFMT     ZZCNF1                                       028100070314     C     *IN03         IFNE      '1'                                          028200070314     C     *IN12         ANDNE     '1'                                          028300070131     C                   WRITE     CONHDRR                              99      028400070209     C     *IN99         IFEQ      '1'                                          028500070209     C                   MOVE      'Y2U0004'     MSGID                          028600070209     C                   CALL      RTNMTX                                       028700070209     C                   PARM                    MSGID             7            028800070209     C                   PARM                    ERRMSG          132            028900070219     C* Display error message                                                   029000070209     C                   MOVEL     ERRMSG        ZMSAGE                         029100070209     C                   ENDIF                                                  029200070313     C                   ENDIF                                                  029300070313                                                                                029400070131     C                   ENDIF                                                  029500070313                                                                                029600070130     C                   ENDSR                                                  029700070313     C**********************************************************************    029800070313                                                                                029900070313     C**********************************************************************    030000070313     C     DSPREC        BEGSR                                                  030100070313     C**********************************************************************    030200070313     C*‚Subroutine: Display a record                                            030300070313     C**********************************************************************    030400070313     C                   MOVE      '1'           *IN34                          030500070314     C                   MOVE      '0'           *IN36                          030600070313     C                   MOVE      '0'           *IN37                          030700070813     C                   MOVEL     ' DISPLAY'    ACTDSP                         030800070313                                                                                030900080121     C     XWORDN        CHAIN(N)  CONHDR                             9966      031000070313     C     *IN99         IFEQ      '1'                                          031100070813     C                   MOVE      'OES0115'     MSGID                          031200070313     C                   CALL      RTNMTX                                       031300070313     C                   PARM                    MSGID             7            031400070313     C                   PARM                    ERRMSG          132            031500070313     C                   MOVEL     ERRMSG        ZMSAGE                         031600070813     C                   ELSE                                                   031700070813     C     *IN66         IFEQ      *ON                                          031800070813     C     FILESTS       IFEQ      1218                                         031900070813     C                   MOVE      'Y3U9999'     MSGID                          032000070813     C                   CALL      RTNMTX                                       032100070813     C                   PARM                    MSGID             7            032200070813     C                   PARM                    ERRMSG          132            032300070813     C                   MOVEL     ERRMSG        ZMSAGE                         032400070813     C                   ELSE                                                   032500070813     C                   MOVE      'OEM0004'     MSGID                          032600070813     C                   CALL      RTNMTX                                       032700070813     C                   PARM                    MSGID             7            032800070813     C                   PARM                    ERRMSG          132            032900070813     C                   MOVEL     ERRMSG        ZMSAGE                         033000070813     C                   ENDIF                                                  033100080121     C                   ELSE                                                   033200080121     C     XWSTAT        CHAIN     ORDSTS                             77        033300080121     C     *IN77         IFEQ      '1'                                          033400080121     C                   MOVE      *ALL'-'       XWSDSC                         033500080121     C                   ENDIF                                                  033600080121     C     PERSON        CHAIN     SLMEN                              77        033700080121     C     *IN77         IFEQ      '1'                                          033800080121     C                   MOVE      *ALL'-'       PNAME                          033900080121     C                   ENDIF                                                  034000080121     C                   ENDIF                                                  034100070313     C                   ENDIF                                                  034200070313                                                                                034300070813     C     *IN03         DOWNE     *ON                                          034400070813     C     *IN12         ANDNE     *ON                                          034500070813     C     *IN99         ANDNE     *ON                                          034600070813     C     *IN66         ANDNE     *ON                                          034700070313     C                   EXSR      DSPSCN                                       034800070313     C                   ENDDO                                                  034900070313                                                                                035000070313     C                   MOVE      SFLRRN        SHWREC                         035100070313                                                                                035200070313     C                   ENDSR                                                  035300070313     C**********************************************************************    035400070313                                                                                035500070313     C**********************************************************************    035600070313     C     CHGREC        BEGSR                                                  035700070313     C**********************************************************************    035800070313     C*‚Subroutine: Change a record                                             035900070313     C**********************************************************************    036000070313     C                   MOVE      '0'           *IN34                          036100070314     C                   MOVE      '0'           *IN36                          036200070313     C                   MOVE      '0'           *IN37                          036300070314     C                   MOVEL     ' UPDATE '    ACTDSP                         036400070313                                                                                036500080121     C     XWORDN        CHAIN(N)  CONHDR                             9966      036600070313     C     *IN99         IFEQ      '1'                                          036700070813     C                   MOVE      'OES0115'     MSGID                          036800070313     C                   CALL      RTNMTX                                       036900070313     C                   PARM                    MSGID             7            037000070313     C                   PARM                    ERRMSG          132            037100070313     C                   MOVEL     ERRMSG        ZMSAGE                         037200070813     C                   ELSE                                                   037300070813     C     *IN66         IFEQ      *ON                                          037400070813     C     FILESTS       IFEQ      1218                                         037500070813     C                   MOVE      'Y3U9999'     MSGID                          037600070813     C                   CALL      RTNMTX                                       037700070813     C                   PARM                    MSGID             7            037800070813     C                   PARM                    ERRMSG          132            037900070813     C                   MOVEL     ERRMSG        ZMSAGE                         038000070813     C                   ELSE                                                   038100070813     C                   MOVE      'OEM0004'     MSGID                          038200070813     C                   CALL      RTNMTX                                       038300070813     C                   PARM                    MSGID             7            038400070813     C                   PARM                    ERRMSG          132            038500070813     C                   MOVEL     ERRMSG        ZMSAGE                         038600070813     C                   ENDIF                                                  038700080121     C                   ELSE                                                   038800080121     C     XWSTAT        CHAIN     ORDSTS                             77        038900080121     C     *IN77         IFEQ      '1'                                          039000080121     C                   MOVE      *ALL'-'       XWSDSC                         039100080121     C                   ENDIF                                                  039200080121     C     PERSON        CHAIN     SLMEN                              77        039300080121     C     *IN77         IFEQ      '1'                                          039400080121     C                   MOVE      *ALL'-'       PNAME                          039500080121     C                   ENDIF                                                  039600070813     C                   ENDIF                                                  039700070313     C                   ENDIF                                                  039800070313                                                                                039900070313     C     *IN03         DOWNE     '1'                                          040000070313     C     *IN12         ANDNE     '1'                                          040100070813     C     *IN99         ANDNE     *ON                                          040200070813     C     *IN66         ANDNE     *ON                                          040300070313     C                   EXSR      DSPSCN                                       040400070313     C     *IN04         IFEQ      '1'                                          040500070313     C     *IN07         OREQ      '1'                                          040600070313     C                   ITER                                                   040700070313     C                   ENDIF                                                  040800070313     C                   EXSR      VALIDT                                       040900070313     C     *IN99         IFEQ      '0'                                          041000070313     C                   LEAVE                                                  041100070314     C                   ELSE                                                   041200070314     C                   MOVEL     ERRMSG        ZMSAGE                         041300070313     C                   ENDIF                                                  041400070313     C                   ENDDO                                                  041500070313                                                                                041600070313     C     *IN03         IFNE      '1'                                          041700070313     C     *IN12         ANDNE     '1'                                          041800070313                                                                                041900070313     C                   EXFMT     ZZCNF1                                       042000070314     C     *IN03         IFNE      '1'                                          042100070314     C     *IN12         ANDNE     '1'                                          042200080121     C                   EXSR      SAVEDATA                                     042300080121     C     XWORDN        CHAIN     CONHDR                             9966      042400080121     C     *IN99         IFNE      *ON                                          042500080121     C     *IN66         ANDNE     *ON                                          042600080121     C                   EXSR      RESTOREDATA                                  042700070313     C                   UPDATE    CONHDRR                              99      042800070313     C     *IN99         IFEQ      '1'                                          042900070313     C                   MOVE      'Y2U0007'     MSGID                          043000070313     C                   CALL      RTNMTX                                       043100070313     C                   PARM                    MSGID             7            043200070313     C                   PARM                    ERRMSG          132            043300070313     C* Display error message                                                   043400070313     C                   MOVEL     ERRMSG        ZMSAGE                         043500070313     C                   ENDIF                                                  043600080121     C                   ENDIF                                                  043700070313     C                   ENDIF                                                  043800070313                                                                                043900070313     C                   ENDIF                                                  044000070313                                                                                044100070313     C                   MOVE      SFLRRN        SHWREC                         044200070313                                                                                044300070313     C                   ENDSR                                                  044400070313     C**********************************************************************    044500070313                                                                                044600070313     C**********************************************************************    044700070313     C     DELREC        BEGSR                                                  044800070313     C**********************************************************************    044900070313     C*‚Subroutine: Delete a record                                             045000070313     C**********************************************************************    045100070314     C                   MOVE      '1'           *IN34                          045200070314     C                   MOVE      '0'           *IN36                          045300070313     C                   MOVE      '1'           *IN37                          045400070314     C                   MOVEL     ' DELETE '    ACTDSP                         045500070313                                                                                045600080121     C     XWORDN        CHAIN(N)  CONHDR                             9966      045700070313     C     *IN99         IFEQ      '1'                                          045800070813     C                   MOVE      'OES0115'     MSGID                          045900070313     C                   CALL      RTNMTX                                       046000070313     C                   PARM                    MSGID             7            046100070313     C                   PARM                    ERRMSG          132            046200070313     C                   MOVEL     ERRMSG        ZMSAGE                         046300070813     C                   ELSE                                                   046400070813     C     *IN66         IFEQ      *ON                                          046500070813     C     FILESTS       IFEQ      1218                                         046600070813     C                   MOVE      'Y3U9999'     MSGID                          046700070813     C                   CALL      RTNMTX                                       046800070813     C                   PARM                    MSGID             7            046900070813     C                   PARM                    ERRMSG          132            047000070813     C                   MOVEL     ERRMSG        ZMSAGE                         047100070813     C                   ELSE                                                   047200070813     C                   MOVE      'OEM0004'     MSGID                          047300070813     C                   CALL      RTNMTX                                       047400070813     C                   PARM                    MSGID             7            047500070813     C                   PARM                    ERRMSG          132            047600070813     C                   MOVEL     ERRMSG        ZMSAGE                         047700070813     C                   ENDIF                                                  047800080121     C                   ELSE                                                   047900080121     C     XWSTAT        CHAIN     ORDSTS                             77        048000080121     C     *IN77         IFEQ      '1'                                          048100080121     C                   MOVE      *ALL'-'       XWSDSC                         048200080121     C                   ENDIF                                                  048300080121     C     PERSON        CHAIN     SLMEN                              77        048400080121     C     *IN77         IFEQ      '1'                                          048500080121     C                   MOVE      *ALL'-'       PNAME                          048600080121     C                   ENDIF                                                  048700070813     C                   ENDIF                                                  048800070313     C                   ENDIF                                                  048900070313                                                                                049000070313     C     *IN03         DOWNE     '1'                                          049100070313     C     *IN12         ANDNE     '1'                                          049200070813     C     *IN99         ANDNE     *ON                                          049300070813     C     *IN66         ANDNE     *ON                                          049400070313     C                   EXSR      DSPSCN                                       049500070313     C     *IN23         IFEQ      '1'                                          049600070313     C                   LEAVE                                                  049700070313     C                   ENDIF                                                  049800070313     C                   ENDDO                                                  049900070313                                                                                050000070313     C     *IN23         IFEQ      '1'                                          050100070313                                                                                050200070313     C                   EXFMT     ZZCNF1                                       050300070314     C     *IN03         IFNE      '1'                                          050400070314     C     *IN12         ANDNE     '1'                                          050500080121     C     XWORDN        CHAIN     CONHDR                             9966      050600080121     C     *IN99         IFNE      *ON                                          050700080121     C     *IN66         ANDNE     *ON                                          050800070313     C                   DELETE    CONHDRR                              99      050900070313     C                   ENDIF                                                  051000080121     C                   ENDIF                                                  051100070313                                                                                051200070313     C                   ENDIF                                                  051300070313                                                                                051400070314     C                   MOVE      SFLRRN        SHWREC                         051500070314                                                                                051600070313     C                   ENDSR                                                  051700070313     C**********************************************************************    051800070313                                                                                051900070313     C**********************************************************************    052000070130     C     CMDKEY        BEGSR                                                  052100070313     C**********************************************************************    052200070130     C*‚Subroutine: Action command keys                                         052300070313     C**********************************************************************    052400070130     C                   SELECT                                                 052500070130     C     *IN06         WHENEQ    '1'                                          052600070313     C                   EXSR      ADDREC                                       052700070314     C                   Z-ADD     1             SHWREC                         052800070314     C                   MOVE      '1'           SFLCHG                         052900070130     C                   ENDSL                                                  053000070130     C                   ENDSR                                                  053100070313     C**********************************************************************    053200070313                                                                                053300070313     C**********************************************************************    053400070131     C     VALIDT        BEGSR                                                  053500070313     C**********************************************************************    053600070131     C*‚Subroutine: Validation                                                  053700070313     C**********************************************************************    053800070131     C                   MOVE      '0'           *IN99                          053900070209     C                   MOVEA     '0000'        *IN(40)                        054000070201     C                   MOVE      *BLANKS       ZMSAGE                         054100070201     C                   DO                                                     054200070219     C* WHEN ADDING CONTRACT MUST NOT BE ZERO                                   054300070209     C     XWORDN        IFEQ      *ZEROS                                       054400070209     C                   MOVE      '1'           *IN99                          054500070209     C                   MOVE      '1'           *IN40                          054600070209     C                   MOVE      'OEM0010'     MSGID                          054700070209     C                   CALL      RTNMTX                                       054800070209     C                   PARM                    MSGID             7            054900070209     C                   PARM                    ERRMSG          132            055000070209     C                   LEAVE                                                  055100070209     C                   ENDIF                                                  055200070219     C* WHEN ADDING CONTRACT MUST NOT EXIST                                     055300070209     C     *IN36         IFEQ      '1'                                          055400070209     C     XWORDN        SETLL     CONHDR                                 99    055500070209     C     *IN99         IFEQ      '1'                                          055600070209     C                   MOVE      '1'           *IN40                          055700070209     C                   MOVE      'Y2U0003'     MSGID                          055800070209     C                   CALL      RTNMTX                                       055900070209     C                   PARM                    MSGID             7            056000070209     C                   PARM                    ERRMSG          132            056100070209     C                   LEAVE                                                  056200070209     C                   ENDIF                                                  056300070209     C                   ENDIF                                                  056400070219     C*- CUSTOMER                                                               056500070306     C     XWBCCD        CHAIN     CUSTS                              99        056600070131     C     *IN99         IFEQ      '1'                                          056700070209     C                   MOVE      '1'           *IN41                          056800070131     C                   MOVE      'OEM0002'     MSGID                          056900070131     C                   CALL      RTNMTX                                       057000070131     C                   PARM                    MSGID             7            057100070131     C                   PARM                    ERRMSG          132            057200070201     C                   MOVE      *ALL'-'       XWG4TX                         057300070201     C                   LEAVE                                                  057400070201     C                   ENDIF                                                  057500070219     C*- STATUS                                                                 057600070306     C     XWSTAT        CHAIN     ORDSTS                             99        057700070215     C     *IN99         IFEQ      '1'                                          057800070209     C                   MOVE      '1'           *IN42                          057900070215     C                   MOVE      *ALL'-'       XWSDSC                         058000070209     C                   MOVE      'OEM0019'     MSGID                          058100070209     C                   CALL      RTNMTX                                       058200070209     C                   PARM                    MSGID             7            058300070209     C                   PARM                    ERRMSG          132            058400070209     C                   LEAVE                                                  058500070215     C                   ENDIF                                                  058600070219     C*- SALESMAN                                                               058700070306     C     PERSON        CHAIN     SLMEN                              99        058800070131     C     *IN99         IFEQ      '1'                                          058900070209     C                   MOVE      '1'           *IN43                          059000070131     C                   MOVE      'OEM0023'     MSGID                          059100070131     C                   CALL      RTNMTX                                       059200070131     C                   PARM                    MSGID             7            059300070131     C                   PARM                    ERRMSG          132            059400070201     C                   MOVE      *ALL'-'       PNAME                          059500070201     C                   LEAVE                                                  059600070201     C                   ENDIF                                                  059700070201     C                   ENDDO                                                  059800070131     C                   ENDSR                                                  059900070313     C*********************************************************************     060000070313                                                                                060100070313     C*********************************************************************     060200070130     C     *INZSR        BEGSR                                                  060300070313     C*********************************************************************     060400070130     C*‚Subroutine: Initialisation routines                                     060500070313     C*********************************************************************     060600070213     C     *ENTRY        PLIST                                                  060700070213     C                   PARM                    SWBCCD           11            060800070731                                                                                060900070731     C*‚Set first key value                                                     061000070731     C                   MOVE      SWBCCD        XWBCCD                         061100070313                                                                                061200070313     C*‚Initialise second key value                                             061300070313     C                   MOVE      *ZEROS        XWORDN                         061400070313                                                                                061500070130     C*‚Initialise message subfile                                              061600070130     C                   MOVE      '1'           *IN32                          061700070131     C                   MOVEL     'WWCONHDR'    ZZPGM                          061800070313                                                                                061900070130     C*-‚Set date                                                               062000070130     C                   MOVE      *DATE         ZZDATE                         062100070205     C                   MOVE      *YEAR         ZYR                            062200070205     C                   MOVE      '-'           FILLR1                         062300070205     C                   MOVE      *MONTH        ZMTH                           062400070205     C                   MOVE      '-'           FILLR2                         062500070205     C                   MOVE      *DAY          ZDAY                           062600070313                                                                                062700070130     C                   ENDSR                                                  062800070313     C*********************************************************************     062900070313                                                                                063000070313     C*********************************************************************     063100070215     C     SRPROM        BEGSR                                                  063200070313     C*********************************************************************     063300070215     C*‚Subroutine: prompts for F04                                             063400070313     C*********************************************************************     063500070215     C                   SELECT                                                 063600070219     C*- CUSTOMER                                                               063700070215     C     SFIELD        WHENEQ    'XWBCCD'                                     063800070215     C                   CALL      'CUSTSSEL'                                   063900070215     C                   PARM                    XWBCCD                         064000070215     C                   PARM                    XWG4TX                         064100070219     C*- STATUS                                                                 064200070215     C     SFIELD        WHENEQ    'XWSTAT'                                     064300070215     C                   CALL      'ORDSTSEL'                                   064400070215     C                   PARM                    XWSTAT                         064500070215     C                   PARM                    XWSDSC                         064600070219     C*- REPRESENTATIVE                                                         064700070215     C     SFIELD        WHENEQ    'PERSON'                                     064800070215     C                   CALL      'SLMENSEL'                                   064900070215     C                   PARM                    PERSON                         065000070215     C                   PARM                    PNAME                          065100070215     C                   ENDSL                                                  065200070215     C                   ENDSR                                                  065300070313     C*********************************************************************     065400080121                                                                                065500080121     C*********************************************************************     065600080121     C     SAVEDATA      BEGSR                                                  065700080121     C*********************************************************************     065800080121     C*‚Subroutine: Save current data                                           065900080121     C*********************************************************************     066000080121     C                   MOVE      XWORDN        ZWORDN                         066100080121     C                   MOVE      XWBCCD        ZWBCCD                         066200080121     C                   MOVE      XWCREF        ZWCREF                         066300080121     C                   MOVE      XWDLDT        ZWDLDT                         066400080121     C                   MOVE      XWSTAT        ZWSTAT                         066500080121     C                   MOVE      PERSON        ZPERSON                        066600080121     C                   MOVE      XWTAMT        ZWTAMT                         066700080121     C                   MOVE      XWADD1        ZWADD1                         066800080121     C                   MOVE      XWADD2        ZWADD2                         066900080121     C                   MOVE      XWADD3        ZWADD3                         067000080121     C                   MOVE      XWADD4        ZWADD4                         067100080121     C                   MOVE      XWPCDE        ZWPCDE                         067200080121     C                   MOVE      XWCNTR        ZWCNTR                         067300080121                                                                                067400080121     C     *LIKE         DEFINE    XWORDN        ZWORDN                         067500080121     C     *LIKE         DEFINE    XWBCCD        ZWBCCD                         067600080121     C     *LIKE         DEFINE    XWCREF        ZWCREF                         067700080121     C     *LIKE         DEFINE    XWDLDT        ZWDLDT                         067800080121     C     *LIKE         DEFINE    XWSTAT        ZWSTAT                         067900080121     C     *LIKE         DEFINE    PERSON        ZPERSON                        068000080121     C     *LIKE         DEFINE    XWTAMT        ZWTAMT                         068100080121     C     *LIKE         DEFINE    XWADD1        ZWADD1                         068200080121     C     *LIKE         DEFINE    XWADD2        ZWADD2                         068300080121     C     *LIKE         DEFINE    XWADD3        ZWADD3                         068400080121     C     *LIKE         DEFINE    XWADD4        ZWADD4                         068500080121     C     *LIKE         DEFINE    XWPCDE        ZWPCDE                         068600080121     C     *LIKE         DEFINE    XWCNTR        ZWCNTR                         068700080121                                                                                068800080121     C                   ENDSR                                                  068900080121     C*********************************************************************     069000080121                                                                                069100080121     C*********************************************************************     069200080121     C     RESTOREDATA   BEGSR                                                  069300080121     C*********************************************************************     069400080121     C*‚Subroutine: Restore current data                                        069500080121     C*********************************************************************     069600080121     C                   MOVE      ZWORDN        XWORDN                         069700080121     C                   MOVE      ZWBCCD        XWBCCD                         069800080121     C                   MOVE      ZWCREF        XWCREF                         069900080121     C                   MOVE      ZWDLDT        XWDLDT                         070000080121     C                   MOVE      ZWSTAT        XWSTAT                         070100080121     C                   MOVE      ZPERSON       PERSON                         070200080121     C                   MOVE      ZWTAMT        XWTAMT                         070300080121     C                   MOVE      ZWADD1        XWADD1                         070400080121     C                   MOVE      ZWADD2        XWADD2                         070500080121     C                   MOVE      ZWADD3        XWADD3                         070600080121     C                   MOVE      ZWADD4        XWADD4                         070700080121     C                   MOVE      ZWPCDE        XWPCDE                         070800080121     C                   MOVE      ZWCNTR        XWCNTR                         070900080121                                                                                071000080121     C                   ENDSR                                                  071100080121     C*********************************************************************     