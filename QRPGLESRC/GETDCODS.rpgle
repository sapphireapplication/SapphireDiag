000100100728                                                                                000200100728     H Nomain                                                                   000300100728     H Option(*NoDebugIO : *SrcStmt)                                            000400100728     H Copyright('(C) COPYRIGHT DATABOROUGH LIMITED, 2010.')                    000500100728                                                                                000600100728     FCUSFL3    IF   E           K DISK    UsrOpn                               000700100728     FCUSFL5    IF   E           K DISK    UsrOpn                               000800100728     F                                     Rename(RCUSF:@REDRE2)                000900100728                                                                                001000100728     D GetDistributorCode...                                                    001100100728     D                 PR                  ExtProc('getDistributorCode')        001200100728     D XCUSNO                         5P 0 Const                                001300100728     D XDCODE                         2A                                        001400100728                                                                                001500100728      //------------------------------------------------------------------------001600100728     P GetDistributorCode...                                                    001700100728     P                 B                   Export                               001800100728                                                                                001900100728     D GetDistributorCode...                                                    002000100728     D                 PI                                                       002100100728     D XCUSNO                         5P 0 Const                                002200100728     D XDCODE                         2A                                        002300100728                                                                                002400100728      //   Key data structures:                                                 002500100728     D Key_CUSFL3    E DS                  ExtName(CUSFL3:*Key) Qualified       002600100728     D Key_CUSFL5    E DS                  ExtName(CUSFL5:*Key) Qualified       002700100728                                                                                002800100728      /Free                                                                     002900100728                                                                                003000100728        //   Open files:                                                        003100100728        If not %Open(CUSFL3);                                                   003200100728          Open(e) CUSFL3;                                                       003300100728        EndIf;                                                                  003400100728                                                                                003500100728        If not %Open(CUSFL5);                                                   003600100728          Open(e) CUSFL5;                                                       003700100728        EndIf;                                                                  003800100728                                                                                003900100728        Key_CUSFL3.CUSNO = XCUSNO;                                              004000100728                                                                                004100100728        Chain(e) %Kds(Key_CUSFL3) CUSFL3;                                       004200100728                                                                                004300100728        If %Found(CUSFL3) and DSDCDE <> *Blanks;                                004400100728          Key_CUSFL5.DSDCDE = DSDCDE;                                           004500100728          Key_CUSFL5.STATUS = 'A';                                              004600100728                                                                                004700100728          Chain(e) %Kds(Key_CUSFL5:2) CUSFL5;                                   004800100728          If %Found(CUSFL5);                                                    004900100728            XDCODE = DSDCDE;                                                    005000100728            Else;                                                               005100100728              XDCODE = *BLANKS;                                                 005200100728          EndIf;                                                                005300100728        EndIf;                                                                  005400100728                                                                                005500100728        //   Close files:                                                       005600100728        If %Open(CUSFL3);                                                       005700100728          Close(e) CUSFL3;                                                      005800100728        EndIf;                                                                  005900100728                                                                                006000100728        If %Open(CUSFL5);                                                       006100100728          Close(e) CUSFL5;                                                      006200100728        EndIf;                                                                  006300100728                                                                                006400100728        Return;                                                                 006500100728                                                                                006600100728      /End-Free                                                                 006700100728     P GetDistributorCode...                                                    006800100728     P                 E                                                        