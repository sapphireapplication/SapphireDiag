000100070317     H*‚--------------------------------------------------------------------    000200050726     H*ˆCOPYRIGHT DATABOROUGH LTD 2005                                          000300050818     H*ˆPROGRAM:  Display Distributor                                           000400010705     H*‚--------------------------------------------------------------------    000500050804     H debug(*yes) copyright('Databorough Ltd. 2005')                           000600980127                                                                                000700980122     F**********************************************************************    000800990528     F*‚F i l e s                                                               000900980122     F**********************************************************************    001000050818     Fdspdistsd cf   e             workstn                                      001100050804     Fdists     if   e           k disk                                         001200980126                                                                                001300980126     D**********************************************************************    001400990528     D*‚D e f i n i t i o n s                                                   001500980126     D**********************************************************************    001600050818     D distributor     s              2a                                        001700050818     D mainloop        s              5p 0 inz(*zeros)                          001800050804     D cdate           s               d   datfmt(*iso) inz(*sys)               001900011119                                                                                002000050804      /free                                                                     002100050804       // ******************************************************************    002200050804       //‚M a i n l i n e   C o d e                                             002300050804       // ******************************************************************    002400050804       dow mainloop < *hival;                                                   002500050804                                                                                002600050818       //‚Display screen                                                        002700050818       exfmt(e) zzft01;                                                         002800050804       //‚Action command keys                                                   002900050804       if *in28;                                                                003000050804       exsr zcmdkeys;                                                           003100050804       endif;                                                                   003200050804                                                                                003300050804       enddo;                                                                   003400050804       // ******************************************************************    003500050804       //‚L o g i c a l   E n d   o f   P r o g r a m                           003600050804       // ******************************************************************    003700050804                                                                                003800050804       // ******************************************************************    003900050818       begsr zgetrec;                                                           004000050804       // ******************************************************************    004100050818       //‚Subroutine: Retrieve record                                           004200050804       // ******************************************************************    004300050818       chain(e) distributor rprods;                                             004400020906                                                                                004500050818       if %found(dists);                                                        004600050818       zdsdcde = dsdcde;                                                        004700050818       zdname = dname;                                                          004800050804       endif;                                                                   004900991115                                                                                005000050804       endsr;                                                                   005100050804       // ******************************************************************    005200050804                                                                                005300050804       // ******************************************************************    005400050804       begsr zcmdkeys;                                                          005500050804       // ******************************************************************    005600050804       //‚Subroutine: Action command keys                                       005700050804       // ******************************************************************    005800050804       select;                                                                  005900050804       when *in03;                                                              006000050804       exsr zf03;                                                               006001110922       //when *in03;                                                            006002110922       //exsr zf03;                                                             006100050804       when *in12;                                                              006200050804       exsr zf12;                                                               006300050804       endsl;                                                                   006400020906                                                                                006500050804       endsr;                                                                   006600050804       // ******************************************************************    006700050804                                                                                006800050804       // ******************************************************************    006900050804       begsr zf03;                                                              007000050804       // ******************************************************************    007100050804       //‚Subroutine: F3=Exit                                                   007200050804       // ******************************************************************    007300050804       *inlr = *on;                                                             007400050804       return;                                                                  007500050804                                                                                007600050804       endsr;                                                                   007700050804       // ******************************************************************    007800050804                                                                                007900050804       // ******************************************************************    008000050804       begsr zf12;                                                              008100050804       // ******************************************************************    008200050804       //‚Subroutine: F12=Cancel                                                008300050804       // ******************************************************************    008400050804       *inlr = *on;                                                             008500050804       return;                                                                  008600050804                                                                                008700050804       endsr;                                                                   008800050804       // ******************************************************************    008900020906                                                                                009000050804       begsr *inzsr;                                                            009100050804       // ******************************************************************    009200050804       //‚Subroutine: Initialisation routines                                   009300050804       // ******************************************************************    009400050804       //‚Set constants                                                         009401110922       //zmessage = 'F3=Exit  F4=Prompt F12=Cancel';                            009500050818       zmessage = 'F3=Exit  F12=Cancel';                                        009600050818       zzpgm = 'DSPDISTS';                                                      009700050804       zzdate = %char(cdate);                                                   009800050818                                                                                009900050818       //‚Retrieve record                                                       010000050818       exsr zgetrec;                                                            010100020320                                                                                010200050804       endsr;                                                                   010300050804       // ******************************************************************    010400050804                                                                                010500050804      /end-free                                                                 010600050818                                                                                010700050818     C**********************************************************************    010800050818     C*‚N o n - E x e c u t a b l e   C o d e                                   010900050818     C**********************************************************************    011000050818     C     *entry        plist                                                  011100050818     C                   parm                    distributor                    011200050818     C**********************************************************************    