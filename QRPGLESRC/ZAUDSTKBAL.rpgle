000100100713     H*‚--------------------------------------------------------------------    000200100713     H*ˆCOPYRIGHT DATABOROUGH LTD 2010                                          000300100713     H*‚--------------------------------------------------------------------    000400100713     H debug(*yes) copyright('Databorough Ltd. 2010') datedit(*dmy)             000500100713     H option(*srcstmt:*nodebugio:*showcpy)                                     000600100713     F**********************************************************************    000700100713     F*‚F i l e s                                                               000800100713     F**********************************************************************    000900100714     Fstkbal    if   e           k disk                                         001000100714     Fcondetl2  if   e           k disk                                         001100100714     Ftrnhstl2a if   e           k disk                                         001200100714     Fprojecl1b if   e           k disk                                         001300100713     Fqsysprt   o    f  132        printer oflind(*INOF)                        001400100713                                                                                001500100713     D**********************************************************************    001600100713     D*‚D e f i n i t i o n s                                                   001700100713     D**********************************************************************    001800100714     D condetcount     s              7p 0                                      001900100713     D projeccount     s              7p 0                                      002000100713     D trnhstcount     s              7p 0                                      002100100713     D tyme            s              6s 0                                      002200100713     D today           s              8s 0                                      002300100713                                                                                002400100713                                                                                002500100713     C**********************************************************************    002600100713     C*‚M a i n l i n e   C o d e                                               002700100713     C**********************************************************************    002800100713      /free                                                                     002900100713        *inof = *on;                                                            003000100714       //‚For each stock balance record                                         003100100714       setll *loval stkbalr;                                                    003200100714       read(e) stkbalr;                                                         003300100714       dow not %eof(stkbal);                                                    003400100713                                                                                003500100714       condetcount = *zeros;                                                    003600100713       projeccount = *zeros;                                                    003700100713       trnhstcount = *zeros;                                                    003800100713                                                                                003900100714       //‚Count CONDET records                                                  004000100714           setll CONDETK condetr;                                               004100100714           reade(e) CONDETK condetr;                                            004200100714           dow not %eof(condetl2) and not %eof;                                 004300100714               condetcount = condetcount + 1;                                   004400100714               reade(e) CONDETK condetr;                                        004500100713           enddo;                                                               004600100713                                                                                004700100713       //‚Count PROJECT records                                                 004800100714           setll PROJECTK projecr;                                              004900100714           reade(e) PROJECTK projecr;                                           005000100714           dow not %eof(projecl1b) and not %eof;                                005100100713               projeccount = projeccount + 1;                                   005200100714               reade(e) PROJECTK projecr;                                       005300100713           enddo;                                                               005400100713                                                                                005500100713       //‚Count TRNHST records                                                  005600100714           setll TRNHSTK trnhstr;                                               005700100714           reade(e) TRNHSTK trnhstr;                                            005800100714           dow not %eof(trnhstl2a) and not %eof;                                005900100713               trnhstcount = trnhstcount + 1;                                   005901110914           //  trnhstcnt = trnhstcnt + 1;                                       006000100714               reade(e) TRNHSTK trnhstr;                                        006100100713           enddo;                                                               006200100713                                                                                006300100713       //‚Output totals for salesman                                            006400100713          if *inof;                                                             006500100713             except headings;                                                   006600100713             *inof = *off;                                                      006700100713          endif;                                                                006800100713                                                                                006900100713          except totals;                                                        007000100713                                                                                007100100714       read(e) stkbalr;                                                         007200100713       enddo;                                                                   007300100713                                                                                007400100713       //‚Terminate program and exit                                            007500100713       *inlr = *on;                                                             007600100713       return;                                                                  007700100713      /end-free                                                                 007800100713     C**********************************************************************    007900100713     C*‚* I N Z S R                                                             008000100713     C**********************************************************************    008100100713     C     *inzsr        begsr                                                  008200100713     C                   time                    tyme                           008300100713     C                   z-add     *date         today                          008400100714     C     CONDETK       klist                                                  008500100714     C                   kfld                    xwabcd                         008600100714     C                   kfld                    xwaacs                         008700100714     C     PROJECTK      klist                                                  008800100714     C                   kfld                    xwabcd                         008900100714     C                   kfld                    xwaacs                         009000100714     C     TRNHSTK       klist                                                  009100100714     C                   kfld                    xwabcd                         009200100714     C                   kfld                    xwaacs                         009201110914     C**   TRNCUSK       klist                                                  009202110914     C**                 kfld                    xwabcd                         009203110914     C**                 kfld                    xwaacs                         009300100713     C                   endsr                                                  009400100713     Oqsysprt   e            headings       1 01                                009500100713     O                                           10 'X-Analysis'                009600100714     O                                           60 'Audit log for file: STKBAL'009700100713     O                                          132 'Databorough LTD.'          009800100713     O          e            headings       1                                   009900100913     O                                           10 'ZAUDSTKBAL'                010000100713     O                       tyme               120 '  :  :  '                  010100100713     O                       today              132 '  /  /    '                010200100713     O          e            headings       2                                   010300100713     O                                          127 'Page:'                     010400100713     O                       page          z    132                             010500100713     O          e            headings       1                                   010600100714     O                                           60 'CONDET'                    010700100714     O                                           75 'PROJECT'                   010800100714     O                                           90 'TRNHST'                    010900100713     O          e            headings       2                                   011000100714     O                                           60 'Records'                   011100100714     O                                           75 'Records'                   011200100714     O                                           90 'Records'                   011300100713     O          e            totals         2                                   011400100714     O                       xwabcd              25                             011500100714     O                       xwaacs              40                             011600100714     O                       condetcount   1     60                             011700100714     O                       projeccount   1     75                             011800100714     O                       trnhstcount   1     90                             