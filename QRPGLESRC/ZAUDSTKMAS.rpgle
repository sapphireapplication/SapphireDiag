000100100713     H*‚--------------------------------------------------------------------    000200100713     H*ˆCOPYRIGHT DATABOROUGH LTD 2010                                          000300100713     H*‚--------------------------------------------------------------------    000400100713     H debug(*yes) copyright('Databorough Ltd. 2010') datedit(*dmy)             000500100713     H option(*srcstmt:*nodebugio:*showcpy)                                     000600100713     F**********************************************************************    000700100713     F*‚F i l e s                                                               000800100713     F**********************************************************************    000900100714     Fstkmas    if   e           k disk                                         001000100714     Fstkbal    if   e           k disk                                         001100100714     Fcondetl3  if   e           k disk                                         001200100714     Ftrnhstl2a if   e           k disk                                         001300100714     Fprojecl1b if   e           k disk                                         001400100713     Fqsysprt   o    f  132        printer oflind(*INOF)                        001500100713                                                                                001600100713     D**********************************************************************    001700100713     D*‚D e f i n i t i o n s                                                   001800100713     D**********************************************************************    001900100714     D stkbalcount     s              7p 0                                      002000100714     D condetcount     s              7p 0                                      002100100713     D projeccount     s              7p 0                                      002200100713     D trnhstcount     s              7p 0                                      002300100713     D tyme            s              6s 0                                      002400100713     D today           s              8s 0                                      002500100713                                                                                002600100713                                                                                002700100713     C**********************************************************************    002800100713     C*‚M a i n l i n e   C o d e                                               002900100713     C**********************************************************************    003000100713      /free                                                                     003100100713        *inof = *on;                                                            003200100714       //‚For each stock master record                                          003300100714       setll *loval stkmasr;                                                    003400100714       read(e) stkmasr;                                                         003500100714       dow not %eof(stkmas);                                                    003600100713                                                                                003700100714       stkbalcount = *zeros;                                                    003800100714       condetcount = *zeros;                                                    003900100713       projeccount = *zeros;                                                    004000100713       trnhstcount = *zeros;                                                    004100100713                                                                                004200100714       //‚Count CONDET records                                                  004300100714           setll CONDETK condetr;                                               004301110914       //  setll %kds(k@condet:1) condetr;                                      004400100714           reade(e) CONDETK condetr;                                            004500100714           dow not %eof(condetl3) and not %error;                               004600100714               condetcount = condetcount + 1;                                   004700100714               reade(e) CONDETK condetr;                                        004800100713           enddo;                                                               004900100713                                                                                005000100713       //‚Count PROJECT records                                                 005100100714           setll PROJECK projecr;                                               005200100714           reade(e) PROJECK projecr;                                            005300100714           dow not %eof(projecl1b) and not %error;                              005400100713               projeccount = projeccount + 1;                                   005500100714               reade(e) PROJECK projecr;                                        005600100713           enddo;                                                               005700100713                                                                                005800100713       //‚Count TRNHST records                                                  005900100714           setll TRNHSTK trnhstr;                                               006000100714           reade(e) TRNHSTK trnhstr;                                            006100100714           dow not %eof(trnhstl2a) and not %error;                              006200100713               trnhstcount = trnhstcount + 1;                                   006201110914           //  trnhstcount += 1;                                                006300100714               reade(e) TRNHSTK trnhstr;                                        006400100713           enddo;                                                               006500100714                                                                                006600100714       //‚Count STKBAL records                                                  006700100714           setll STKBALK stkbalr;                                               006800100714           reade(e) STKBALK stkbalr;                                            006900100714           dow not %eof(stkbal) and not %error;                                 007000100714               stkbalcount = stkbalcount + 1;                                   007100100714               reade(e) STKBALK stkbalr;                                        007200100714           enddo;                                                               007300100713                                                                                007400100714       //‚Output totals for stock master                                        007500100713          if *inof;                                                             007600100713             except headings;                                                   007700100713             *inof = *off;                                                      007800100713          endif;                                                                007900100713                                                                                008000100713          except totals;                                                        008100100713                                                                                008200100714       read(e) stkmasr;                                                         008300100713       enddo;                                                                   008400100713                                                                                008500100713       //‚Terminate program and exit                                            008600100713       *inlr = *on;                                                             008700100713       return;                                                                  008800100713      /end-free                                                                 008900100713     C**********************************************************************    009000100713     C*‚* I N Z S R                                                             009100100713     C**********************************************************************    009200100713     C     *inzsr        begsr                                                  009300100713     C                   time                    tyme                           009400100713     C                   z-add     *date         today                          009500100714     C     PROJECK       klist                                                  009600100714     C                   kfld                    XWABCD                         009700100714     C                   kfld                    XWAACS                         009800100714     C     CONDETK       klist                                                  009900100714     C                   kfld                    XWABCD                         010000100714     C     TRNHSTK       klist                                                  010100100714     C                   kfld                    XWABCD                         010200100714     C                   kfld                    XWAACS                         010300100714     C     STKBALK       klist                                                  010400100714     C                   kfld                    XWABCD                         010500100713     C                   endsr                                                  010600100713     Oqsysprt   e            headings       1 01                                010700100713     O                                           10 'X-Analysis'                010800100714     O                                           60 'Audit log for file: STKBAL'010900100713     O                                          132 'Databorough LTD.'          011000100713     O          e            headings       1                                   011100100913     O                                           10 'ZAUDSTKMAS'                011200100713     O                       tyme               120 '  :  :  '                  011300100713     O                       today              132 '  /  /    '                011400100713     O          e            headings       2                                   011500100713     O                                          127 'Page:'                     011600100713     O                       page          z    132                             011700100713     O          e            headings       1                                   011800100714     O                                           60 'CONDET'                    011900100714     O                                           75 'PROJECT'                   012000100714     O                                           90 'TRNHST'                    012100100714     O                                          105 'STKBAL'                    012200100713     O          e            headings       2                                   012300100714     O                                           60 'Records'                   012400100714     O                                           75 'Records'                   012500100714     O                                           90 'Records'                   012600100714     O                                          105 'Records'                   012700100713     O          e            totals         2                                   012800100714     O                       xwabcd              25                             012900100714     O                       xwhltx              40                             013000100714     O                       condetcount   1     60                             013100100714     O                       projeccount   1     75                             013200100714     O                       trnhstcount   1     90                             013300100714     O                       stkbalcount   1    105                             