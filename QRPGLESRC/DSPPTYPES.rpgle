000100070317     H*‚--------------------------------------------------------------------    000200050726     H*ˆCOPYRIGHT DATABOROUGH LTD 2005                                          000300050831     H*ˆPROGRAM:  Display Product                                               000400010705     H*‚--------------------------------------------------------------------    000500050804     H debug(*yes) copyright('Databorough Ltd. 2005')                           000600980127                                                                                000700980122     F**********************************************************************    000800990528     F*‚F i l e s                                                               000900980122     F**********************************************************************    001000050831     Fdspptypesdcf   e             workstn                                      001100050831     Fptypes    if   e           k disk                                         001200050831     Fcusfla    if   e           k disk                                         001300980126                                                                                001400980126     D**********************************************************************    001500990528     D*‚D e f i n i t i o n s                                                   001600980126     D**********************************************************************    001700050831     D product         s              2a                                        001800050818     D mainloop        s              5p 0 inz(*zeros)                          001900050804     D cdate           s               d   datfmt(*iso) inz(*sys)               001901110922     D*cdate1          s               d   datfmt(*iso) inz(*sys)               002000011119                                                                                002100050804      /free                                                                     002200050804       // ******************************************************************    002300050804       //‚M a i n l i n e   C o d e                                             002400050804       // ******************************************************************    002500050804       dow mainloop < *hival;                                                   002600050804                                                                                002700050818       //‚Display screen                                                        002800050818       exfmt(e) zzft01;                                                         002801110922       //write(e) zzft02;                                                       002900050804       //‚Action command keys                                                   003000050804       if *in28;                                                                003100050804       exsr zcmdkeys;                                                           003200050804       endif;                                                                   003300050804                                                                                003400050804       enddo;                                                                   003500050804       // ******************************************************************    003600050804       //‚L o g i c a l   E n d   o f   P r o g r a m                           003700050804       // ******************************************************************    003800050804                                                                                003900050804       // ******************************************************************    004000050818       begsr zgetrec;                                                           004100050804       // ******************************************************************    004200050818       //‚Subroutine: Retrieve record                                           004300050804       // ******************************************************************    004400050831       chain(e) product rprods;                                                 004500020906                                                                                004600050831       if %found(ptypes);                                                       004700050831       zprpcde = prpcde;                                                        004800050831       zpdesf = pdesf;                                                          004900050831       zpqty = pqty;                                                            005000050831       zpunt = punt;                                                            005100050831       zpprc = pprc;                                                            005101110922       //zpprc1 = pprc1;                                                        005200050831       endif;                                                                   005300050831                                                                                005400050831       //‚Determine if current product                                          005500050831       exsr zcurrent;                                                           005600050831                                                                                005700050804       endsr;                                                                   005800050804       // ******************************************************************    005900050831                                                                                006000050831       // ******************************************************************    006100050831       begsr zcurrent;                                                          006200050831       // ******************************************************************    006300050831       //‚Subroutine: Determine if current product                              006400050831       // ******************************************************************    006500050831       setll(e) prpcde rcusf;                                                   006600050831       if %found(cusfla);                                                       006700050831       zcurprod = 'YES';                                                        006800050831       else;                                                                    006900050831       zcurprod = 'NO';                                                         007000050831       endif;                                                                   007100050831                                                                                007200050831       endsr;                                                                   007300050831       // ******************************************************************    007400050831                                                                                007500050804       // ******************************************************************    007600050804       begsr zcmdkeys;                                                          007700050804       // ******************************************************************    007800050804       //‚Subroutine: Action command keys                                       007900050804       // ******************************************************************    008000050804       select;                                                                  008100050804       when *in03;                                                              008200050804       exsr zf03;                                                               008300050804       when *in12;                                                              008400050804       exsr zf12;                                                               008401110922       //exsr zfix;                                                             008500050804       endsl;                                                                   008600020906                                                                                008700050804       endsr;                                                                   008800050804       // ******************************************************************    008900050804                                                                                009000050804       // ******************************************************************    009100050804       begsr zf03;                                                              009200050804       // ******************************************************************    009300050804       //‚Subroutine: F3=Exit                                                   009400050804       // ******************************************************************    009500050804       *inlr = *on;                                                             009600050804       return;                                                                  009700050804                                                                                009800050804       endsr;                                                                   009900050804       // ******************************************************************    010000050804                                                                                010100050804       // ******************************************************************    010200050804       begsr zf12;                                                              010300050804       // ******************************************************************    010400050804       //‚Subroutine: F12=Cancel                                                010500050804       // ******************************************************************    010600050804       *inlr = *on;                                                             010700050804       return;                                                                  010800050804                                                                                010900050804       endsr;                                                                   011000050804       // ******************************************************************    011100020906                                                                                011200050804       begsr *inzsr;                                                            011300050804       // ******************************************************************    011400050804       //‚Subroutine: Initialisation routines                                   011500050804       // ******************************************************************    011600050804       //‚Set constants                                                         011700050818       zmessage = 'F3=Exit  F12=Cancel';                                        011800050831       zzpgm = 'DSPPTYPES';                                                     011900050804       zzdate = %char(cdate);                                                   012000050818                                                                                012100050818       //‚Retrieve record                                                       012200050818       exsr zgetrec;                                                            012300020320                                                                                012400050804       endsr;                                                                   012500050804       // ******************************************************************    012600050804                                                                                012700050804      /end-free                                                                 012800050818                                                                                012900050818     C**********************************************************************    013000050818     C*‚N o n - E x e c u t a b l e   C o d e                                   013100050818     C**********************************************************************    013200050818     C     *entry        plist                                                  013300050831     C                   parm                    product                        013400050818     C**********************************************************************    