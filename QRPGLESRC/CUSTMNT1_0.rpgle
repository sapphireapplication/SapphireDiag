000100070317     H*‚--------------------------------------------------------------------    000200070717     H*ˆCOPYRIGHT DATABOROUGH LTD 2007 - JORGE ESTEBAN SALDEÑA                  000300070717     H*ˆPROGRAM:  Customer Detail Maintenance                                   000400010705     H*‚--------------------------------------------------------------------    000500070131     H DATEDIT(*YMD)                                                            000600980122     F**********************************************************************    000700990528     F*‚F i l e s                                                               000800980122     F**********************************************************************    000900070809     FCUSTMNT1FMCF   E             WORKSTN                                      001000070212     FCUSTS     UF A E           K DISK                                         001100070813     F                                     INFDS(FILEDS)                        001200070213     FSLMEN     IF   E           K DISK                                         001300070213     FCUSFL3    IF   E           K DISK                                         001400070213     FCUSGRP    IF   E           K DISK                                         001500070213     FDISTS     IF   E           K DISK                                         001600070213     FCONHDRL1  IF   E           K DISK                                         001700070213     FTRNHSTL3  IF   E           K DISK                                         001701110922                                                                                001800070213     D**********************************************************************    001900070213     D*‚D e f i n i t i o n s                                                   002000070213     D**********************************************************************    002100070130     D*‚Set constants                                                           002200070131     D RTNMTX          C                   CONST('RTNMSGTEXT')                  002300070213     D INIDAT          C                   CONST('0001-01-01')                  002400070813                                                                                002500070813     d FILEDS          ds                                                       002600070813     d  FILESTS               11     15s 0                                      002700070303                                                                                002800070717     D  pageno         s              3p 0                                      002900070717     D  screen         s              1s 0                                      003000070305     D  noofpages      s              3p 0 inz(2)                               003100070716      *                                                                         003200070205     D                 DS                  INZ                                  003300070213     D  ZDATE                  1     10                                         003400070205     D  ZYR                    1      4                                         003500070205     D  FILLR1                 5      5                                         003600070205     D  ZMTH                   6      7                                         003700070205     D  FILLR2                 8      8                                         003800070205     D  ZDAY                   9     10                                         003900070303                                                                                004000070130     I**********************************************************************    004100070213     IRCUSF                                                                     004200070213     I              DSDCDE                      XSDCDE                          004300070305                                                                                004400070303     C**********************************************************************    004500070130     C*‚M a i n l i n e   C o d e                                               004600070303     C**********************************************************************    004700090304     C*‚Entry parameters                                                        004800090304     C     *ENTRY        PLIST                                                  004900090304     C                   PARM                    KWBCCD           11            005000090304     C*‚Initialise message subfile                                              005100090304     C                   MOVE      '1'           *IN82                          005200090304     C                   MOVEL     'CUSTMNT1'    ZZPGM                          005300090304     C                   MOVEL     KWBCCD        SWBCCD                         005400090304     C                   EXSR      GETREC                                       005500090304     C*-‚Set date                                                               005600090304     C                   MOVE      *DATE         ZZDATE                         005700090304     C                   MOVE      *YEAR         ZYR                            005800090304     C                   MOVE      '-'           FILLR1                         005900090304     C                   MOVE      *MONTH        ZMTH                           006000090304     C                   MOVE      '-'           FILLR2                         006100090304     C                   MOVE      *DAY          ZDAY                           006200090304      *                                                                         006300080117     C*‚Main loop                                                               006400080117     C*                                                                         006500070130     C     *IN03         DOWEQ     '0'                                          006600070130     C     *IN12         ANDEQ     '0'                                          006700070718     C*‚                                                                        006800070131     C     *IN03         IFEQ      '1'                                          006900070131     C     *IN12         OREQ      '1'                                          007000070131     C                   LEAVE                                                  007100070131     C                   ENDIF                                                  007200070219     C*‚Action command keys                                                     007300070130     C     *IN28         IFEQ      '1'                                          007400070717     C                   MOVE      '0'           *IN12                          007500070130     C                   ELSE                                                   007600070717     C*‚Change main data                                                        007700070717     C                   EXSR      CHGMAI                                       007800070130     C                   ENDIF                                                  007900070130     C                   ENDDO                                                  008000070305                                                                                008100070131     C                   MOVE      '1'           *INLR                          008200070717                                                                                008300070131     C                   RETURN                                                 008400070303     C**********************************************************************    008500070130     C*‚L o g i c a l   E n d   o f   P r o g r a m                             008600070303     C**********************************************************************    008700070717                                                                                008800070717     C**********************************************************************    008900070717     C     CHGMAI        BEGSR                                                  009000070717     C**********************************************************************    009100070717     C*‚Subroutine: Change a record                                             009200070717     C**********************************************************************    009300070717                                                                                009400070717     C*‚For each screen page                                                    009500070717     C                   dow       pageno <= noofpages                          009600070717      *                                                                         009700070717     C                   EXFMT     ZZFT01                                       009800070717      *                                                                         009900070717     C*‚Process Command Keys                                                    010000070717     C*‚Prompt                                                                  010100070717     C     *IN04         IFEQ      '1'                                          010200070717     C                   EXSR      SRPROM                                       010300070717     C                   ENDIF                                                  010400070717      *                                                                         010500070717     C     *IN03         IFEQ      '1'                                          010600070717     C     *IN12         OREQ      '1'                                          010700070717     C                   LEAVE                                                  010800070717     C                   ENDIF                                                  010900070717      *                                                                         011000070717     C     *IN04         IFEQ      '1'                                          011100070717     C                   ITER                                                   011200070717     C                   ENDIF                                                  011300070717      *                                                                         011400070717     C                   EXSR      VALID1                                       011500070717      *                                                                         011600070717     C*‚If errors found                                                         011700070717     C     *IN99         IFEQ      '1'                                          011800070717     C*‚Display error message and re-display screen                             011900070717     C                   MOVEL     ERRMSG        ZMSAGE                         012000070717     C                   iter                                                   012100070717     C                   else                                                   012200070718     C                   call      'WCUSTP'                                     012300070718     C                   parm                    SWBCCD                         012400070717     C                   EXSR      CHGSAL                                       012500070717     C     *IN12         IFEQ      '1'                                          012600070717     C                   ITER                                                   012700070717     C                   ENDIF                                                  012800070717     C     *IN03         IFEQ      '1'                                          012900070717     C                   LEAVE                                                  013000070717     C                   ENDIF                                                  013100070717     C                   ENDIF                                                  013200070717      *                                                                         013300070717     C*‚End: For each screen page                                               013400070717     C                   ENDDO                                                  013500070717                                                                                013600070717     C                   ENDSR                                                  013700070717     C**********************************************************************    013800070717                                                                                013900070717     C**********************************************************************    014000070717     C     CHGSAL        BEGSR                                                  014100070717     C**********************************************************************    014200070717     C*‚Subroutine: Change a record                                             014300070717     C**********************************************************************    014400070717                                                                                014500070717     C*‚For each screen page                                                    014600070717     C                   dow       pageno <= noofpages                          014700070717      *                                                                         014800070717     C                   EXFMT     ZZFT02                                       014900070717      *                                                                         015000070717     C*‚Process Command Keys                                                    015100070717     C                   SELECT                                                 015200070717     C*‚Prompt                                                                  015300070717     C     *IN04         WHENEQ    '1'                                          015400070717     C                   EXSR      SRPROM                                       015500070717     C                   ENDSL                                                  015600070717      *                                                                         015700070717     C     *IN03         IFEQ      '1'                                          015800070717     C     *IN12         OREQ      '1'                                          015900070717     C                   LEAVE                                                  016000070717     C                   ENDIF                                                  016100070717      *                                                                         016200070717     C     *IN04         IFEQ      '1'                                          016300070717     C                   ITER                                                   016400070717     C                   ENDIF                                                  016500070717      *                                                                         016600070717     C                   EXSR      VALID2                                       016700070717      *                                                                         016800070717     C*‚If errors found                                                         016900070717     C     *IN99         IFEQ      '1'                                          017000070717     C*‚Display error message and re-display screen                             017100070717     C                   MOVEL     ERRMSG        ZMSAGE                         017200070717     C                   iter                                                   017300070717     C                   else                                                   017400070717     C                   leave                                                  017500070717     C                   ENDIF                                                  017600070717      *                                                                         017700070717     C*‚End: For each screen page                                               017800070717     C                   ENDDO                                                  017900070717                                                                                018000070717     C*‚If not F3/F12                                                           018100070717     C     *IN03         IFNE      '1'                                          018200070717     C     *IN12         ANDNE     '1'                                          018300080901     C*‚If confirmation received then update or write record                    018400080901     C     *IN96         ifeq      *off                                         018500070717     C                   exsr      updrec                                       018600080901     C                   else                                                   018700080901     C                   exsr      wrtrec                                       018800080901     C                   endif                                                  018900070717      *                                                                         019000070717     C*‚End: If not F3/F12                                                      019100070717     C                   ENDIF                                                  019200070717                                                                                019300070717     C                   ENDSR                                                  019400070717     C**********************************************************************    019500070305                                                                                019600070305     C**********************************************************************    019700070216     C     VALID1        BEGSR                                                  019800070305     C**********************************************************************    019900070305     C*‚Subroutine: Validation #1                                               020000070305     C**********************************************************************    020100080901     C                   eval      *in99 = *off                                 020200080901     C                   eval      *in31 = *off                                 020300080901     C                   eval      *in32 = *off                                 020400080901     C                   eval      *in33 = *off                                 020500080901     C                   eval      *in34 = *off                                 020600080901     C                   eval      *in35 = *off                                 020700080901     C                   eval      errmsg = *blanks                             020800080901     C*                                                                         020900070201     C                   DO                                                     021000080901     C*                                                                         021100080901     C*‚If in ADD mode                                                          021200080901     C     *IN96         IFEQ      '1'                                          021300080901     C* CUSTOMER MUST NOT BE BLANK                                              021400070716     C     SWBCCD        IFEQ      *BLANKS                                      021500070209     C                   MOVE      '1'           *IN99                          021600070212     C                   MOVE      *ON           *IN31                          021700070213     C                   MOVE      'OEM0002'     MSGID                          021800070209     C                   CALL      RTNMTX                                       021900070209     C                   PARM                    MSGID             7            022000070209     C                   PARM                    ERRMSG          132            022100070209     C                   LEAVE                                                  022200070209     C                   ENDIF                                                  022300080901     C* CUSTOMER MUST NOT ALREADY EXIST                                         022400070716     C     SWBCCD        SETLL     CUSTS                                  99    022500070209     C     *IN99         IFEQ      '1'                                          022600070212     C                   MOVE      *ON           *IN31                          022700070209     C                   MOVE      'Y2U0003'     MSGID                          022800070716     C                   MOVEL     *ALL'-'       SWG4TX                         022900070209     C                   CALL      RTNMTX                                       023000070209     C                   PARM                    MSGID             7            023100070209     C                   PARM                    ERRMSG          132            023200070209     C                   LEAVE                                                  023300070209     C                   ENDIF                                                  023400080901     C*‚End: If in ADD mode                                                     023500070209     C                   ENDIF                                                  023600080901     C*                                                                         023700080901     C*‚Customer name                                                           023800070716     C     SWG4TX        IFEQ      *BLANKS                                      023900070212     C                   MOVE      *ON           *IN32                          024000070212     C                   MOVE      *ON           *IN99                          024100070212     C                   MOVE      'OEM0012'     MSGID                          024200070212     C                   CALL      RTNMTX                                       024300070212     C                   PARM                    MSGID             7            024400070212     C                   PARM                    ERRMSG          132            024500070212     C                   LEAVE                                                  024600070212     C                   ENDIF                                                  024700070713      *‚Customer group                                                          024800100803     C     SWBNCD        setll     CUSGRP                                       024900100803     C     SWBNCD        reade     CUSGRP                                       025000100803     C                   IF        %eof and                                     025100100803     C                             swbncd <> *blanks                            025200070213     C                   MOVE      '1'           *IN33                          025300070213     C                   MOVE      'OES0374'     MSGID                          025400070716     C                   MOVEL     *ALL'-'       SWKHTX                         025500070213     C                   CALL      RTNMTX                                       025600070213     C                   PARM                    MSGID             7            025700070213     C                   PARM                    ERRMSG          132            025800070213     C                   LEAVE                                                  025900080118     C                   ELSE                                                   026000080118     C                   MOVEL     XWKHTX        SWKHTX                         026100080118     C                   ENDIF                                                  026200070713      *‚Salesman                                                                026300080118     C     SPERSON       CHAIN     SLMEN                              99        026400070213     C     *IN99         IFEQ      '1'                                          026500070213     C                   MOVE      '1'           *IN34                          026600070213     C                   MOVE      'OEM0023'     MSGID                          026700070213     C                   CALL      RTNMTX                                       026800070213     C                   PARM                    MSGID             7            026900070213     C                   PARM                    ERRMSG          132            027000070213     C                   MOVE      *ALL'-'       PNAME                          027100070213     C                   LEAVE                                                  027200070213     C                   ENDIF                                                  027300070713      *‚Distributor                                                             027400080118     C     SDSDCDE       CHAIN     DISTS                              99        027500070213     C     *IN99         IFEQ      '1'                                          027600070213     C                   MOVE      '1'           *IN35                          027700070213     C                   MOVE      'OEM0018'     MSGID                          027800070213     C                   CALL      RTNMTX                                       027900070213     C                   PARM                    MSGID             7            028000070213     C                   PARM                    ERRMSG          132            028100070213     C                   MOVE      *ALL'-'       DNAME                          028200070213     C                   LEAVE                                                  028300070213     C                   ENDIF                                                  028400080901     C*                                                                         028500070201     C                   ENDDO                                                  028600080901     C*                                                                         028700070131     C                   ENDSR                                                  028800070305     C**********************************************************************    028900070305                                                                                029000070305     C**********************************************************************    029100070216     C     VALID2        BEGSR                                                  029200070305     C**********************************************************************    029300070305     C*‚Subroutine: Validation #2                                               029400070305     C**********************************************************************    029500070718     C                   eval      *in99=*off                                   029600070718      *                                                                         029700070216     C                   DO                                                     029800080901     C*‚If in CHANGE mode                                                       029900080901     C     *IN95         IFEQ      '1'                                          030000080901     C*‚Balance                                                                 030100100521     C     SWGIVA        SUB       SWIDV0        SDIFF            15 2          030200070716     C     SDIFF         IFLT      *ZERO                                        030300070216     C                   MOVE      '1'           *IN99                          030400070216     C                   MOVE      '1'           *IN36                          030500070216     C                   MOVE      'OES0373'     MSGID                          030600070216     C                   CALL      RTNMTX                                       030700070216     C                   PARM                    MSGID             7            030800070216     C                   PARM                    ERRMSG          132            030900070216     C                   LEAVE                                                  031000070216     C                   ENDIF                                                  031100070216     C                   ENDIF                                                  031200080901     C*                                                                         031300080901     C*‚Customer cannot be zero                                                 031400070216     C     CUSNO         IFEQ      *ZEROS                                       031500070216     C                   MOVE      '1'           *IN37                          031600070216     C                   MOVE      '1'           *IN99                          031700070216     C                   MOVE      'CNP0008'     MSGID                          031800070216     C                   CALL      RTNMTX                                       031900070216     C                   PARM                    MSGID             7            032000070216     C                   PARM                    ERRMSG          132            032100070216     C                   LEAVE                                                  032200070216     C                   ENDIF                                                  032300080901     C*‚Customer                                                                032400070306     C     CUSNO         CHAIN     CUSFL3                             99        032500070216     C     *IN99         IFEQ      '1'                                          032600070216     C                   MOVE      '1'           *IN37                          032700070216     C                   MOVE      'CNP0002'     MSGID                          032800070216     C                   CALL      RTNMTX                                       032900070216     C                   PARM                    MSGID             7            033000070216     C                   PARM                    ERRMSG          132            033100070216     C                   LEAVE                                                  033200070216     C                   ENDIF                                                  033300070216     C                   ENDDO                                                  033400080901     C*                                                                         033500070216     C                   ENDSR                                                  033600070305     C**********************************************************************    033700070305                                                                                033800070305     C**********************************************************************    033900070305     C     GETREC        BEGSR                                                  034000070305     C**********************************************************************    034100070305     C*‚Subroutine: Retrieve a record                                           034200070305     C**********************************************************************    034300080901     C*‚If no customer number entered                                           034400080901     C     SWBCCD        IFEQ      *BLANKS                                      034500080901      *                                                                         034600080901     C*‚Set to ADD mode                                                         034700080901     C                   EVAL      *IN96 = *ON                                  034800080901     C                   CLEAR                   CUSTSR                         034900080901      *                                                                         035000080901     C                   ELSE                                                   035100080901      *                                                                         035200080901     C*‚Set to CHANGE mode                                                      035300080901     C                   EVAL      *IN95 = *ON                                  035400080901      *                                                                         035500080117     C     SWBCCD        CHAIN(N)  CUSTSR                             9966      035600070717      *                                                                         035700070305     C*‚If file error                                                           035800070305     C     *IN99         IFEQ      '1'                                          035900070813     C                   MOVE      'OES0115'     MSGID                          036000070305     C                   CALL      RTNMTX                                       036100070305     C                   PARM                    MSGID             7            036200070305     C                   PARM                    ERRMSG          132            036300070305     C                   MOVEL     ERRMSG        ZMSAGE                         036400070717     C                   ELSE                                                   036500070813     C     *IN66         IFEQ      *ON                                          036600070813     C     FILESTS       IFEQ      1218                                         036700070813     C                   MOVE      'Y3U9999'     MSGID                          036800070813     C                   CALL      RTNMTX                                       036900070813     C                   PARM                    MSGID             7            037000070813     C                   PARM                    ERRMSG          132            037100070813     C                   MOVEL     ERRMSG        ZMSAGE                         037200070813     C                   ELSE                                                   037300070813     C                   MOVE      'OEM0004'     MSGID                          037400070813     C                   CALL      RTNMTX                                       037500070813     C                   PARM                    MSGID             7            037600070813     C                   PARM                    ERRMSG          132            037700070813     C                   MOVEL     ERRMSG        ZMSAGE                         037800070813     C                   ENDIF                                                  037900070813     C                   ELSE                                                   038000070813     C*‚If file no error                                                        038100070813     C*‚Main data                                                               038200070813     C                   eval      SWBCCD=XWBCCD                                038300070813     C                   eval      SWG4TX=XWG4TX                                038400070813     C                   eval      SWB2CD=XWB2CD                                038500070813     C                   eval      SWB3CD=XWB3CD                                038600070813     C                   eval      SWHITX=XWHITX                                038700070813     C                   eval      SWE0NB=XWE0NB                                038800070813     C                   eval      SWJUN0=XWJUN0                                038900070813     C                   eval      SWDVCD=XWDVCD                                039000070813     C                   eval      SWBNCD=XWBNCD                                039100080117     C                   eval      SPERSON=PERSON                               039200070813     C*                  eval      PNAME =PNAME                                 039300080117     C                   eval      SDSDCDE=DSDCDE                               039400070813     c                   eval      SWBTCD=XWBTCD                                039500070813     C                   eval      SWGIVA=XWGIVA                                039600070813     C                   eval      SWAOCD=XWAOCD                                039700070813     C                   eval      SWBBCD=XWBBCD                                039800070813     C                   eval      SWG4T0=XWG4T0                                039900070813     C                   eval      SWC7ST=XWC7ST                                040000070813     C                   eval      SWDAST=XWDAST                                040100070813     C                   eval      SWBPD0=XWBPD0                                040200070813     C                   eval      SWBAD0=XWBAD0                                040300070813     C                   eval      SWARDT=XWARDT                                040400070813     C                   eval      ZMSAGE=ZMSAGE                                040500070813     C                   eval      SWKHTX=XWKHTX                                040600070813     C*                  eval      DNAME =DNAME                                 040700070813     C*‚Sales data                                                              040800070813     C                   eval      SWF0VA=XWF0VA                                040900070813     C                   eval      SWASDT=XWASDT                                041000070813     C                   eval      SWF0V0=XWF0V0                                041100070813     C                   eval      SWBQDT=XWBQDT                                041200070813     C                   eval      SWF1VA=XWF1VA                                041300070813     C                   eval      SWF1V0=XWF1V0                                041400070813     C                   eval      SWF2VA=XWF2VA                                041500070813     C                   eval      SWF3VA=XWF3VA                                041600070813     C                   eval      SWF4VA=XWF4VA                                041700070813     C                   eval      SWF6VA=XWF6VA                                041800070813     C                   eval      SWIDV0=XWIDV0                                041900070813     C                   eval      SWGAVA=XWGAVA                                042000070813     C                   eval      SWGBVA=XWGBVA                                042100070813     C                   eval      SWGCVA=XWGCVA                                042200070813     C                   eval      SWGDVA=XWGDVA                                042300070813     C                   eval      SWGEVA=XWGEVA                                042400070813     C                   eval      SWGFVA=XWGFVA                                042500070813     C                   eval      SWGGVA=XWGGVA                                042600070813     C*                  eval      CUSNO =CUSNO                                 042700070813     C*                  eval      ZMSAGE=ZMSAGE                                042800080117     C                   exsr      zgetnames                                    042900070813     C                   ENDIF                                                  043000070305     C                   ENDIF                                                  043100080901     C*                                                                         043200080901     C*‚If a numeric customer id                                                043300080901     C                   if        %subst(swbccd:1:1) >= '0'                    043400080901     C*‚Set to DISPLAY mode                                                     043500080901     C                   EVAL      *IN95 = *OFF                                 043600080901     C                   EVAL      *IN94 = *ON                                  043700080901     C                   endif                                                  043800080901     C*                                                                         043900080901     C                   ENDIF                                                  044000080901                                                                                044100070305     C                   ENDSR                                                  044200070305     C**********************************************************************    044300070717     C     UPDREC        BEGSR                                                  044400080117     C     SWBCCD        CHAIN     CUSTSR                             9966      044500080117     C                   IF        %FOUND(CUSTS)                                044600070718     C                   EVAL      XWBCCD=SWBCCD                                044700070718     C                   EVAL      XWG4TX=SWG4TX                                044800070718     C                   EVAL      XWB2CD=SWB2CD                                044900070718     C                   EVAL      XWB3CD=SWB3CD                                045000070718     C                   EVAL      XWHITX=SWHITX                                045100070718     C                   EVAL      XWE0NB=SWE0NB                                045200070718     C                   EVAL      XWJUN0=SWJUN0                                045300070718     C                   EVAL      XWDVCD=SWDVCD                                045400070718     C                   EVAL      XWBNCD=SWBNCD                                045500070718     c                   EVAL      XWBTCD=SWBTCD                                045600070718     C                   EVAL      XWGIVA=SWGIVA                                045700070718     C                   EVAL      XWAOCD=SWAOCD                                045800070718     C                   EVAL      XWBBCD=SWBBCD                                045900070718     C                   EVAL      XWG4T0=SWG4T0                                046000070718     C                   EVAL      XWC7ST=SWC7ST                                046100070718     C                   EVAL      XWDAST=SWDAST                                046200070718     C                   EVAL      XWBPD0=SWBPD0                                046300070718     C                   EVAL      XWBAD0=SWBAD0                                046400070718     C                   EVAL      XWARDT=SWARDT                                046500070718     C                   EVAL      XWKHTX=SWKHTX                                046600070718     C                   EVAL      XWF0VA=SWF0VA                                046700070718     C                   EVAL      XWASDT=SWASDT                                046800070718     C                   EVAL      XWF0V0=SWF0V0                                046900070718     C                   EVAL      XWBQDT=SWBQDT                                047000070718     C                   EVAL      XWF1VA=SWF1VA                                047100070718     C                   EVAL      XWF1V0=SWF1V0                                047200070718     C                   EVAL      XWF2VA=SWF2VA                                047300070718     C                   EVAL      XWF3VA=SWF3VA                                047400070718     C                   EVAL      XWF4VA=SWF4VA                                047500070718     C                   EVAL      XWF6VA=SWF6VA                                047600070718     C                   EVAL      XWIDV0=SWIDV0                                047700070718     C                   EVAL      XWGAVA=SWGAVA                                047800070718     C                   EVAL      XWGBVA=SWGBVA                                047900070718     C                   EVAL      XWGCVA=SWGCVA                                048000070718     C                   EVAL      XWGDVA=SWGDVA                                048100070718     C                   EVAL      XWGEVA=SWGEVA                                048200070718     C                   EVAL      XWGFVA=SWGFVA                                048300070718     C                   EVAL      XWGGVA=SWGGVA                                048400080117     C                   EVAL      PERSON=SPERSON                               048500080117     C                   EVAL      DSDCDE=SDSDCDE                               048600070717     C                   UPDATE    CUSTSR                               99      048700070717     C     *IN99         IFEQ      '1'                                          048800070717     C                   MOVE      'Y2U0007'     MSGID                          048900070717     C                   CALL      RTNMTX                                       049000070717     C                   PARM                    MSGID             7            049100070717     C                   PARM                    ERRMSG          132            049200070717     C* Display error message                                                   049300070718     C                   MOVEL     ERRMSG        ZMSAGE                         049400070717     C                   ENDIF                                                  049500080117     C                   ENDIF                                                  049600070717     C                   ENDSR                                                  049700070305     C**********************************************************************    049800080901     C*                                                                         049900080901     C**********************************************************************    050000080901     C     WRTREC        BEGSR                                                  050100080901     C                   EVAL      XWBCCD=SWBCCD                                050200080901     C                   EVAL      XWG4TX=SWG4TX                                050300080901     C                   EVAL      XWB2CD=SWB2CD                                050400080901     C                   EVAL      XWB3CD=SWB3CD                                050500080901     C                   EVAL      XWHITX=SWHITX                                050600080901     C                   EVAL      XWE0NB=SWE0NB                                050700080901     C                   EVAL      XWJUN0=SWJUN0                                050800080901     C                   EVAL      XWDVCD=SWDVCD                                050900080901     C                   EVAL      XWBNCD=SWBNCD                                051000080901     c                   EVAL      XWBTCD=SWBTCD                                051100080901     C                   EVAL      XWGIVA=SWGIVA                                051200080901     C                   EVAL      XWAOCD=SWAOCD                                051300080901     C                   EVAL      XWBBCD=SWBBCD                                051400080901     C                   EVAL      XWG4T0=SWG4T0                                051500080901     C                   EVAL      XWC7ST=SWC7ST                                051600080901     C                   EVAL      XWDAST=SWDAST                                051700080901     C                   EVAL      XWBPD0=SWBPD0                                051800080901     C                   EVAL      XWBAD0=SWBAD0                                051900080901     C                   EVAL      XWARDT=SWARDT                                052000080901     C                   EVAL      XWKHTX=SWKHTX                                052100080901     C                   EVAL      XWF0VA=SWF0VA                                052200080901     C                   EVAL      XWASDT=SWASDT                                052300080901     C                   EVAL      XWF0V0=SWF0V0                                052400080901     C                   EVAL      XWBQDT=SWBQDT                                052500080901     C                   EVAL      XWF1VA=SWF1VA                                052600080901     C                   EVAL      XWF1V0=SWF1V0                                052700080901     C                   EVAL      XWF2VA=SWF2VA                                052800080901     C                   EVAL      XWF3VA=SWF3VA                                052900080901     C                   EVAL      XWF4VA=SWF4VA                                053000080901     C                   EVAL      XWF6VA=SWF6VA                                053100080901     C                   EVAL      XWIDV0=SWIDV0                                053200080901     C                   EVAL      XWGAVA=SWGAVA                                053300080901     C                   EVAL      XWGBVA=SWGBVA                                053400080901     C                   EVAL      XWGCVA=SWGCVA                                053500080901     C                   EVAL      XWGDVA=SWGDVA                                053600080901     C                   EVAL      XWGEVA=SWGEVA                                053700080901     C                   EVAL      XWGFVA=SWGFVA                                053800080901     C                   EVAL      XWGGVA=SWGGVA                                053900080901     C                   EVAL      PERSON=SPERSON                               054000080901     C                   EVAL      DSDCDE=SDSDCDE                               054100080901     C                   WRITE(E)  CUSTSR                                       054200080901                                                                                054300080901     C                   IF        %ERROR                                       054400080901     C                   MOVE      'Y2U0003'     MSGID                          054500080901     C                   CALL      RTNMTX                                       054600080901     C                   PARM                    MSGID             7            054700080901     C                   PARM                    ERRMSG          132            054800080901     C* Display error message                                                   054900080901     C                   MOVEL     ERRMSG        ZMSAGE                         055000080901     C                   ELSE                                                   055100080901     C                   MOVEL     *OFF          *IN96                          055200080901     C                   MOVEL     *ON           *IN95                          055300080901     C                   ENDIF                                                  055400080901                                                                                055500080901     C                   ENDSR                                                  055600080901     C**********************************************************************    055700070305                                                                                055800070305     C**********************************************************************    055900070213     C     SRPROM        BEGSR                                                  056000070305     C**********************************************************************    056100070213     C*‚Subroutine: prompts for F04                                             056200070305     C**********************************************************************    056300070213     C                   SELECT                                                 056400080118     C     SFIELD        WHENEQ    'SPERSON'                                    056500070213     C                   CALL      'SLMENSEL'                                   056600080118     C                   PARM                    SPERSON                        056700070213     C                   PARM                    PNAME                          056800070215     C     SFIELD        WHENEQ    'CUSNO'                                      056900070213     C                   CALL      'CUSFSEL'                                    057000070213     C                   PARM      *ZEROS        CUSPRM            5 0          057100070213     C     CUSPRM        IFNE      *ZEROS                                       057200070213     C                   MOVE      CUSPRM        CUSNO                          057300070213     C                   ENDIF                                                  057400070716     C     SFIELD        WHENEQ    'SWBNCD'                                     057500070213     C                   CALL      'CUSGRSEL'                                   057600070716     C                   PARM                    SWBNCD                         057700070716     C                   PARM                    SWKHTX                         057800080118     C     SFIELD        WHENEQ    'SDSDCDE'                                    057900070213     C                   CALL      'DISTSSEL'                                   058000080118     C                   PARM                    SDSDCDE                        058100070213     C                   PARM                    DNAME                          058200070213     C                   ENDSL                                                  058300070213     C                   ENDSR                                                  058400070305     C**********************************************************************    058500080117     C**********************************************************************    058600080117     C     ZGETNAMES     BEGSR                                                  058700080117     C**********************************************************************    058800080117     C*‚Subroutine: Retrieve names for codes                                    058900080117     C**********************************************************************    059000080117     C     SWBNCD        CHAIN(E)  CUSGRP                                       059100080117     C                   IF        NOT %FOUND(CUSGRP)                           059200080117     C                   MOVEL     *ALL'-'       SWKHTX                         059300080118     C                   ELSE                                                   059400080118     C                   MOVEL     XWKHTX        SWKHTX                         059500080118     C                   ENDIF                                                  059600080118     C     SPERSON       CHAIN(E)  SLMEN                                        059700080117     C                   IF        NOT %FOUND(SLMEN)                            059800080117     C                   MOVE      *ALL'-'       PNAME                          059900080117     C                   ENDIF                                                  060000080118     C     SDSDCDE       CHAIN(E)  DISTS                                        060100080117     C                   IF        NOT %FOUND(DISTS)                            060200080117     C                   MOVE      *ALL'-'       DNAME                          060300080117     C                   ENDIF                                                  060400080117     C                   ENDSR                                                  060500080117     C**********************************************************************    