000100070317     H*‚--------------------------------------------------------------------    000200050726     H*ˆCOPYRIGHT DATABOROUGH LTD 2005                                          000300050818     H*ˆPROGRAM:  Work with Rep. Delivery Areas                                 000400010705     H*‚--------------------------------------------------------------------    000500050804     H debug(*yes) copyright('Databorough Ltd. 2005')                           000600980127                                                                                000700980122     F**********************************************************************    000800990528     F*‚F i l e s                                                               000900980122     F**********************************************************************    001000050818     Fwwrareasd cf   e             workstn sfile(zzsf01:sflrrn)                 001100050818     Fdelival1  if   e           k disk                                         001200980126                                                                                001300980126     D**********************************************************************    001400990528     D*‚D e f i n i t i o n s                                                   001500980126     D**********************************************************************    001600050818     D rep             s              3a                                        001700020906     D sflchanged      s               n   inz(*off)                            001800020906     D sflrrn          s              5p 0                                      001900020906     D zcmd            s            200a                                        002000050804     D mainloop        s              5p 0 inz(*zeros)                          002100050804     D cdate           s               d   datfmt(*iso) inz(*sys)               002200050818                                                                                002300050804     D xbcclmsg        pr                  extpgm('XBCCLMSG')                   002400020906                                                                                002500020906     D xmcsnmsg        pr                  extpgm('XMCSNMSG')                   002600050726     D                                7a   const                                002700050726     D                               10a   const                                002800050726     D                               10a   const                                002900050726     D                               50a   const                                003000050726     D                               10a   const                                003100050726     D                                7a   const                                003200050826                                                                                003300050826     D smensel         pr                  extpgm('SMENSEL')                    003400050826     D                                3a                                        003500050826                                                                                003600011119                                                                                003700050804      /free                                                                     003800050804       // ******************************************************************    003900050804       //‚M a i n l i n e   C o d e                                             004000050804       // ******************************************************************    004100050804       dow mainloop < *hival;                                                   004200050804                                                                                004300050804       //‚Build subfile                                                         004400050804       exsr zsflwrt;                                                            004500050804       //‚Display screens                                                       004600050804       write(e) zztr01;                                                         004700050804       write(e) zzmc01;                                                         004800050804       exfmt(e) zzct01;                                                         004900050804       //‚Remove messages                                                       005000050804       xbcclmsg();                                                              005100050804       //‚Action command keys                                                   005200050804       if *in28;                                                                005300050804       exsr zcmdkeys;                                                           005400050804       else;                                                                    005500050804       //‚Else action selections                                                005600050804       exsr zselect;                                                            005700050804       endif;                                                                   005800050804                                                                                005900050804       enddo;                                                                   006000050804       // ******************************************************************    006100050804       //‚L o g i c a l   E n d   o f   P r o g r a m                           006200050804       // ******************************************************************    006300050804                                                                                006400050804       // ******************************************************************    006500050804       begsr zsflwrt;                                                           006600050804       // ******************************************************************    006700050804       //‚Subroutine: Write data to subfile                                     006800050804       // ******************************************************************    006900050804       //‚Delete subfile                                                        007000050804       if *in40;                                                                007100050804       *in30 = *on;                                                             007200050804       write(e) zzct01;                                                         007300050804       *in30 = *off;                                                            007400050804       endif;                                                                   007500050804       //‚Write subfile                                                         007600050804       *in31 = *off;                                                            007700050804       sflrrn = *zeros;                                                         007800991115                                                                                007900050818       setll(e) rep delivar;                                                    008000050818       reade(e) rep delivar;                                                    008100020906                                                                                008200050818       dow not %eof(delival1) and not %error;                                   008300991115                                                                                008400050804       sflrrn = sflrrn + 1;                                                     008500050804       dssel = *blanks;                                                         008600050818       dsxwbdcd = xwbdcd;                                                       008700050818       dsxwgxtx = xwgxtx;                                                       008800050804       write(e) zzsf01;                                                         008900991115                                                                                009000050818       reade(e) rep delivar;                                                    009100050804       enddo;                                                                   009200991115                                                                                009300050804       if sflrrn > *zeros;                                                      009400991115                                                                                009500050804       if not sflchanged;                                                       009600050804       dsprec = 1;                                                              009700050804       endif;                                                                   009800991115                                                                                009900050804       if dsprec > sflrrn                                                       010000050804        or dsprec < 1;                                                          010100050804       dsprec = 1;                                                              010200050804       endif;                                                                   010300020423                                                                                010400050804       *in40 = *on;                                                             010500050804       *in31 = *on;                                                             010600991115                                                                                010700050804       endif;                                                                   010800991115                                                                                010900050804       endsr;                                                                   011000050804       // ******************************************************************    011100050804                                                                                011200050804       // ******************************************************************    011300050804       begsr zselect;                                                           011400050804       // ******************************************************************    011500050804       //‚Subroutine: Action selection                                          011600050804       // ******************************************************************    011700050804       sflchanged = *off;                                                       011800980126                                                                                011900050804       readc(e) zzsf01;                                                         012000980126                                                                                012100050804       //‚For each selection                                                    012200050804       dow not %eof and not %error;                                             012300980126                                                                                012400050804       sflchanged = *on;                                                        012500980126                                                                                012600050804       select;                                                                  012700020906                                                                                012800050804       //‚Display                                                               012900050804       when dssel = ' 5' or dssel = '5 ';                                       013000050804       exsr zdisplay;                                                           013100050804       dsprec = sflrrn;                                                         013200980126                                                                                013300050804       endsl;                                                                   013400980126                                                                                013500050804       dssel = *blanks;                                                         013600050804       update(e) zzsf01;                                                        013700980126                                                                                013800050804       readc(e) zzsf01;                                                         013900980126                                                                                014000050804       //‚End: For each selection                                               014100050804       enddo;                                                                   014200980126                                                                                014300050804       //‚If changes made then update display                                   014400050804       if sflchanged;                                                           014500050804       exsr zsflwrt;                                                            014600050804       endif;                                                                   014700980126                                                                                014800050804       endsr;                                                                   014900050804       // ******************************************************************    015000050804                                                                                015100050804       // ******************************************************************    015200050804       begsr zdisplay;                                                          015300050804       // ******************************************************************    015400050804       //‚Subroutine: Display record                                            015500050804       // ******************************************************************    015600050818       chain(e) dsperson delivar;                                               015700050804                                                                                015800050818       if %found(delival1);                                                     015900050804                                                                                016000050818       dsperson = person;                                                       016100050818       dsxwbdcd = xwbdcd;                                                       016200050818       dsxwgxtx = xwgxtx;                                                       016300050804                                                                                016400050804       dow not *in03 and not *in12;                                             016500050804                                                                                016600050804       *in34 = *on;                                                             016700050804       write(e) zztr01;                                                         016800050804       write(e) zzmc01;                                                         016900050804       exfmt(e) zzft01;                                                         017000050804       xbcclmsg();                                                              017100020906                                                                                017200050804       enddo;                                                                   017300020909                                                                                017400050804       endif;                                                                   017500020906                                                                                017600050804       endsr;                                                                   017700050804       // ******************************************************************    017800050804                                                                                017900050804       // ******************************************************************    018000050804       begsr zcmdkeys;                                                          018100050804       // ******************************************************************    018200050804       //‚Subroutine: Action command keys                                       018300050804       // ******************************************************************    018400050804       select;                                                                  018500050804       when *in03;                                                              018600050804       exsr zf03;                                                               018700050804       when *in12;                                                              018800050804       exsr zf12;                                                               018900050804       endsl;                                                                   019000020906                                                                                019100050804       endsr;                                                                   019200050804       // ******************************************************************    019300050804                                                                                019400050804       // ******************************************************************    019500050804       begsr zf03;                                                              019600050804       // ******************************************************************    019700050804       //‚Subroutine: F3=Exit                                                   019800050804       // ******************************************************************    019900050804       *inlr = *on;                                                             020000050804       return;                                                                  020100050804                                                                                020200050804       endsr;                                                                   020300050804       // ******************************************************************    020400050804                                                                                020500050804       // ******************************************************************    020600050804       begsr zf12;                                                              020700050804       // ******************************************************************    020800050804       //‚Subroutine: F12=Cancel                                                020900050804       // ******************************************************************    021000050804       *inlr = *on;                                                             021100050804       return;                                                                  021200050804                                                                                021300050804       endsr;                                                                   021400050804       // ******************************************************************    021500020906                                                                                021600050804       begsr *inzsr;                                                            021700050804       // ******************************************************************    021800050804       //‚Subroutine: Initialisation routines                                   021900050804       // ******************************************************************    022000021001                                                                                022100050804       //‚Initialise message subfile                                            022200050804       *in32 = *on;                                                             022300050818       zzpgm = 'WWRAREAS';                                                      022400980126                                                                                022500050804       //‚Set date                                                              022600050804       zzdate = %char(cdate);                                                   022700050826                                                                                022800050826       //‚If rep code not provided then prompt                                  022900050826       if rep = *blanks;                                                        023000050826       smensel(rep);                                                            023100050826       endif;                                                                   023200050818                                                                                023300050826       //‚Set displayed rep code                                                023400050818       dsperson = rep;                                                          023500020320                                                                                023600050804       endsr;                                                                   023700050804       // ******************************************************************    023800050804                                                                                023900050804      /end-free                                                                 024000050818                                                                                024100050818     C**********************************************************************    024200050818     C*‚N o n - E x e c u t a b l e   C o d e                                   024300050818     C**********************************************************************    024400050818     C     *entry        plist                                                  024500050818     C                   parm                    rep                            024600050818     C**********************************************************************    