000100070317     H*‚--------------------------------------------------------------------    000200070130     H*ˆCOPYRIGHT DATABOROUGH LTD 2007 - ROYMAN E. MOTA RUIZ                    000300070201     H*ˆPROGRAM:  Work with Order Details                                       000400010705     H*‚--------------------------------------------------------------------    000500070131     H DATEDIT(*YMD)                                                            000600980122     F**********************************************************************    000700990528     F*‚F i l e s                                                               000800980122     F**********************************************************************    000900070201     FWCONDETD  CF   E             WORKSTN                                      001000070130     F                                     SFILE(ZZSF01:SFLRRN)                 001100070201     FCONDET    UF A E           K DISK                                         001200070131     FCUSTS     IF   E           K DISK                                         001300070201     FSTKMAS    IF   E           K DISK                                         001400070201     FSTOMAS    IF   E           K DISK                                         001500070202     FSTKBAL    IF   E           K DISK                                         001600070202     F*-                                                                        001700070202     FCONHDR    IF   E           K DISK                                         001800070202     FSLMEN     IF   E           K DISK                                         001900070215     FORDSTS    IF   E           K DISK                                         002000070215     FTRNTYP    IF   E           K DISK                                         002100070209     D**********************************************************************    002200070209     D UM              S             11    DIM(1) CTDATA PERRCD(1)              002300070131     D RTNMTX          C                   CONST('RTNMSGTEXT')                  002400070130     I**********************************************************************    002500070201     ICUSTSR                                                                    002600070201     I              PERSON                      PERCUS                          002700070202     ISTKBALR                                                                   002800070202     I              XWA2CD                      WA2CD                           002900070130     C*****************************************************                     003000070130     C*‚D e f i n i t i o n s                                                   003100070130     C*****************************************************                     003200070130     C                   MOVE      '0'           SFLCHG            1            003300070130     C                   MOVE      *ZEROS        SFLRRN            5 0          003400070130     C*****************************************************                     003500070130     C*‚M a i n l i n e   C o d e                                               003600070130     C*****************************************************                     003700070130     C     *IN03         DOWEQ     '0'                                          003800070130     C     *IN12         ANDEQ     '0'                                          003900070219     C*‚Build subfile                                                           004000070130     C                   EXSR      SFLWRT                                       004100070219     C*‚Display screens                                                         004200070201     C                   WRITE     ZZTR01                                       004300070131     C                   EXFMT     ZZCT01                                       004400070219     C*‚Remove messages                                                         004500070130     C                   CALL      'XBCCLMSG'                                   004600070131     C     *IN03         IFEQ      '1'                                          004700070131     C     *IN12         OREQ      '1'                                          004800070131     C                   LEAVE                                                  004900070131     C                   ENDIF                                                  005000070215     C                   MOVE      *BLANKS       ZMSAGE                         005100070219     C*‚Action command keys                                                     005200070130     C     *IN28         IFEQ      '1'                                          005300070130     C                   EXSR      CMDKEY                                       005400070130     C                   ELSE                                                   005500070219     C*‚Else action selections                                                  005600070130     C                   EXSR      ZSELEC                                       005700070130     C                   ENDIF                                                  005800070130     C                   ENDDO                                                  005900070131     C                   MOVE      '1'           *INLR                          006000070131     C                   RETURN                                                 006100070130     C*****************************************************                     006200070130     C*‚L o g i c a l   E n d   o f   P r o g r a m                             006300070130     C*****************************************************                     006400070130     C*****************************************************                     006500070130     C     SFLWRT        BEGSR                                                  006600070130     C*****************************************************                     006700070130     C*‚Subroutine: Write data to subfile                                       006800070130     C*****************************************************                     006900070130     C*‚Delete subfile                                                          007000070131     C                   SETON                                        74        007100070131     C                   SETOFF                                       717231    007200070205     C                   WRITE     ZZCT01                                       007300070131     C                   SETOFF                                       74        007400070130     C*‚Write subfile                                                           007500070130     C                   MOVE      *ZEROS        SFLRRN                         007600070201     C     XWORDN        SETLL     CONDET                                       007700070306     C     XWORDN        READE     CONDET                                 31    007800070131     C     *IN31         DOWEQ     '0'                                          007900070130     C                   ADD       1             SFLRRN                         008000070130     C                   MOVE      *BLANKS       DSSEL                          008100070209     C                   MOVEL     XWABCD        SWABCD                         008200070215     C                   MOVEL     XWT8TX        SWT8TX                         008300070306     C     XWABCD        CHAIN     STKMAS                             99        008400070215     C   99              MOVEL     *ALL'-'       XWHLTX                         008500070205     C                   WRITE     ZZSF01                                       008600070306     C     XWORDN        READE     CONDET                                 31    008700070130     C                   ENDDO                                                  008800070130     C*-                                                                        008900070130     C     SFLRRN        IFGT      *ZEROS                                       009000070130     C     SFLCHG        IFEQ      '0'                                          009100070130     C                   Z-ADD     1             DSPREC                         009200070130     C                   ENDIF                                                  009300070130     C     DSPREC        IFGT      SFLRRN                                       009400070130     C     DSPREC        ORLT      1                                            009500070130     C                   Z-ADD     1             DSPREC                         009600070130     C                   ENDIF                                                  009700070131     C                   SETON                                        71        009800070130     C                   ENDIF                                                  009900070131     C                   SETON                                        72        010000070130     C                   ENDSR                                                  010100070130     C*****************************************************                     010200070130     C*****************************************************                     010300070130     C     ZSELEC        BEGSR                                                  010400070130     C*****************************************************                     010500070130     C*‚Subroutine: Action selection                                            010600070130     C*****************************************************                     010700070130     C                   MOVE      '0'           SFLCHG                         010800070130     C                   READC     ZZSF01                                 35    010900070130     C*‚For each selection                                                      011000070130     C     *IN35         DOWEQ     '0'                                          011100070130     C                   MOVE      '1'           SFLCHG                         011200070130     C                   SELECT                                                 011300070219     C*‚Change                                                                  011400070130     C     DSSEL         WHENEQ    '2'                                          011500070219     C*‚Delete                                                                  011600070201     C     DSSEL         OREQ      '4'                                          011700070219     C*‚Display                                                                 011800070201     C     DSSEL         OREQ      '5'                                          011900070201     C                   EXSR      SCR001                                       012000070130     C                   MOVE      SFLRRN        DSPREC                         012100070130     C                   ENDSL                                                  012200070130     C                   MOVE      *BLANKS       DSSEL                          012300070205     C                   UPDATE    ZZSF01                                       012400070130     C                   READC     ZZSF01                                 35    012500070219     C*‚End: For each selection                                                 012600070130     C                   ENDDO                                                  012700070130     C*‚If changes made then update display                                     012800070130     C     SFLCHG        IFEQ      '1'                                          012900070130     C                   EXSR      SFLWRT                                       013000070130     C                   ENDIF                                                  013100070130     C                   MOVE      '0'           *IN12                          013200070130     C                   ENDSR                                                  013300070130     C*****************************************************                     013400070130     C*****************************************************                     013500070201     C     SCR001        BEGSR                                                  013600070130     C*****************************************************                     013700070201     C*‚Subroutine: Process screen                                              013800070130     C*****************************************************                     013900070201     C     KEY001        KLIST                                                  014000070201     C                   KFLD                    XWORDN                         014100070201     C                   KFLD                    XWABCD                         014200070201     C*-                                                                        014300070201     C                   MOVE      '1'           *IN34                          014400070302     C                   MOVE      '0'           *IN37                          014500070201     C                   SELECT                                                 014600070219     C*‚Change                                                                  014700070201     C     DSSEL         WHENEQ    '2'                                          014800070201     C                   MOVEL     '  UPDATE'    ACTDSP                         014900070201     C                   MOVE      '0'           *IN34                          015000070219     C*‚Delete                                                                  015100070201     C     DSSEL         WHENEQ    '4'                                          015200070201     C                   MOVEL     '  DELETE'    ACTDSP                         015300070302     C                   MOVE      '1'           *IN37                          015400070219     C*‚Display                                                                 015500070201     C     DSSEL         WHENEQ    '5'                                          015600070201     C                   MOVEL     ' DISPLAY'    ACTDSP                         015700070201     C                   ENDSL                                                  015800070201     c*-                                                                        015900070212     C                   MOVE      '0'           FIRST             1            016000070212     C*-                                                                        016100070216     C     KEY001        CHAIN     CONDET                             3699      016200070216     C     *IN99         IFEQ      '1'                                          016300070216     C                   MOVE      'Y3U9999'     MSGID                          016400070216     C                   CALL      RTNMTX                                       016500070216     C                   PARM                    MSGID             7            016600070216     C                   PARM                    ERRMSG          132            016700070216     C                   MOVEL     ERRMSG        ZMSAGE                         016800070216     C                   ELSE                                                   016900070130     C     *IN36         IFEQ      '0'                                          017000070131     C                   EXSR      VALIDT                                       017100070130     C     *IN03         DOWEQ     '0'                                          017200070130     C     *IN12         ANDEQ     '0'                                          017300070205     C   99              WRITE     ZZMC01                                       017400070215     C     FIRST         IFEQ      '0'                                          017500070215     C                   EXFMT     ZZFT01                                       017600070215     C                   END                                                    017700070130     C                   CALL      'XBCCLMSG'                                   017800070215     C                   MOVE      *BLANKS       ZMSAGE                         017900070130     C     *IN03         IFEQ      '1'                                          018000070130     C     *IN12         OREQ      '1'                                          018100070130     C                   LEAVE                                                  018200070130     C                   ENDIF                                                  018300070219     C*- Prompt                                                                 018400070201     C     *IN04         IFEQ      '1'                                          018500070215     C                   EXSR      SRPROM                                       018600070201     C                   ELSE                                                   018700070219     C*‚Subroutine: Order Header                                                018800070205     C     *IN08         IFEQ      '1'                                          018900070205     C                   EXSR      ORDHED                                       019000070205     C                   MOVE      '0'           *IN12                          019100070205     C                   ELSE                                                   019200070219     C* Delete                                                                  019300070201     C                   SELECT                                                 019400070201     C     *IN23         WHENEQ    '1'                                          019500070201     C     DSSEL         ANDEQ     '4'                                          019600070201     C                   DELETE    CONDETR                              99      019700070201     C                   LEAVE                                                  019800070219     C* Validate                                                                019900070201     C     DSSEL         WHENEQ    '2'                                          020000070131     C                   EXSR      VALIDT                                       020100070212     C                   SELECT                                                 020200070212     C     *IN99         WHENEQ    '0'                                          020300070212     C     FIRST         ANDEQ     '1'                                          020400070212     C                   UPDATE    CONDETR                              99      020500070212     C     *IN99         IFEQ      '1'                                          020600070212     C                   MOVE      'Y2U0007'     MSGID                          020700070212     C                   CALL      RTNMTX                                       020800070212     C                   PARM                    MSGID             7            020900070212     C                   PARM                    ERRMSG          132            021000070219     C* Display error message                                                   021100070212     C                   MOVEL     ERRMSG        ZMSAGE                         021200070212     C                   ELSE                                                   021300070212     C                   LEAVE                                                  021400070212     C                   ENDIF                                                  021500070212     C     *IN99         WHENEQ    '0'                                          021600070212     C     FIRST         ANDEQ     '0'                                          021700070212     C                   MOVE      '1'           FIRST                          021800070215     C                   EXFMT     ZZCNF1                                       021900070215     C     *IN03         IFEQ      '1'                                          022000070215     C     *IN12         OREQ      '1'                                          022100070215     C                   MOVE      '0'           FIRST                          022200070215     C                   MOVE      '0'           *IN12                          022300070215     C                   ITER                                                   022400070215     C                   ENDIF                                                  022500070219     C* Display error message                                                   022600070212     C     *IN99         WHENEQ    '1'                                          022700070212     C                   MOVEL     ERRMSG        ZMSAGE                         022800070212     C                   ENDSL                                                  022900070201     C                   ENDSL                                                  023000070201     C                   ENDIF                                                  023100070205     C                   ENDIF                                                  023200070130     C                   ENDDO                                                  023300070130     C                   ENDIF                                                  023400070216     C                   ENDIF                                                  023500070130     C                   ENDSR                                                  023600070130     C*****************************************************                     023700070130     C*****************************************************                     023800070130     C     ZADD          BEGSR                                                  023900070130     C*****************************************************                     024000070130     C*‚Subroutine: Add record                                                  024100070130     C*****************************************************                     024200070130     C                   MOVE      '0'           *IN34                          024300070131     C                   MOVE      '1'           *IN36                          024400070302     C                   MOVE      '0'           *IN37                          024500070131     C                   MOVEL     'ADDITION'    ACTDSP                         024600070201     C                   CLEAR                   XWABCD                         024700070201     C                   CLEAR                   XWAACS                         024800070201     C                   CLEAR                   XWT8TX                         024900070209     C                   MOVE      'INV'         XWRICD                         025000070306     C     XWRICD        CHAIN     TRNTYP                             99        025100070215     C   99              MOVEL     *ALL'-'       XWTDSC                         025200070201     C                   CLEAR                   XWA5QT                         025300070209     C                   MOVE      'EAC'         XWA2CD                         025400070209     C                   MOVEL     UM(1)         UMDES                          025500070201     C                   CLEAR                   XWPRIC                         025600070205     C                   CLEAR                   XWHLTX                         025700070205     C                   CLEAR                   XWDESC                         025800070212     C                   MOVE      '0'           FIRST             1            025900070130     C     *IN03         DOWEQ     '0'                                          026000070130     C     *IN12         ANDEQ     '0'                                          026100070205     C   99              WRITE     ZZMC01                                       026200070215     C     FIRST         IFEQ      '0'                                          026300070215     C                   EXFMT     ZZFT01                                       026400070215     C                   END                                                    026500070130     C                   CALL      'XBCCLMSG'                                   026600070130     C     *IN03         IFEQ      '1'                                          026700070130     C     *IN12         OREQ      '1'                                          026800070130     C                   LEAVE                                                  026900070130     C                   ENDIF                                                  027000070219     C*- Prompt                                                                 027100070201     C     *IN04         IFEQ      '1'                                          027200070215     C                   EXSR      SRPROM                                       027300070201     C                   ELSE                                                   027400070219     C*‚Subroutine: Order Header                                                027500070205     C     *IN08         IFEQ      '1'                                          027600070205     C                   EXSR      ORDHED                                       027700070205     C                   MOVE      '0'           *IN12                          027800070205     C                   ELSE                                                   027900070131     C                   EXSR      VALIDT                                       028000070215     C  N99              Z-ADD     XWANPR        XWPRIC                         028100070212     C                   SELECT                                                 028200070212     C     *IN99         WHENEQ    '0'                                          028300070212     C     FIRST         ANDEQ     '1'                                          028400070212     C                   WRITE     CONDETR                              99      028500070212     C     *IN99         IFEQ      '1'                                          028600070212     C                   MOVE      'Y2U0004'     MSGID                          028700070212     C                   CALL      RTNMTX                                       028800070212     C                   PARM                    MSGID             7            028900070212     C                   PARM                    ERRMSG          132            029000070219     C* Display error message                                                   029100070212     C                   MOVEL     ERRMSG        ZMSAGE                         029200070212     C                   ELSE                                                   029300070212     C                   LEAVE                                                  029400070212     C                   ENDIF                                                  029500070212     C     *IN99         WHENEQ    '0'                                          029600070212     C     FIRST         ANDEQ     '0'                                          029700070212     C                   MOVE      '1'           FIRST                          029800070215     C                   EXFMT     ZZCNF1                                       029900070215     C     *IN03         IFEQ      '1'                                          030000070215     C     *IN12         OREQ      '1'                                          030100070215     C                   MOVE      '0'           FIRST                          030200070215     C                   MOVE      '0'           *IN12                          030300070215     C                   ITER                                                   030400070215     C                   ENDIF                                                  030500070219     C* Display error message                                                   030600070212     C     *IN99         WHENEQ    '1'                                          030700070212     C                   MOVEL     ERRMSG        ZMSAGE                         030800070212     C                   ENDSL                                                  030900070205     C                   ENDIF                                                  031000070201     C                   ENDIF                                                  031100070130     C                   ENDDO                                                  031200070130     C                   ENDSR                                                  031300070130     C*****************************************************                     031400070130     C*****************************************************                     031500070130     C     CMDKEY        BEGSR                                                  031600070130     C*****************************************************                     031700070130     C*‚Subroutine: Action command keys                                         031800070130     C*****************************************************                     031900070130     C                   SELECT                                                 032000070130     C     *IN06         WHENEQ    '1'                                          032100070130     C                   EXSR      ZADD                                         032200070201     C     *IN08         WHENEQ    '1'                                          032300070201     C                   EXSR      ORDHED                                       032400070130     C                   ENDSL                                                  032500070131     C                   MOVE      '0'           *IN12                          032600070130     C                   ENDSR                                                  032700070131     C*****************************************************                     032800070131     C*****************************************************                     032900070131     C     VALIDT        BEGSR                                                  033000070131     C*****************************************************                     033100070131     C*‚Subroutine: Validation                                                  033200070131     C*****************************************************                     033300070202     C     KEY002        KLIST                                                  033400070202     C                   KFLD                    XWABCD                         033500070202     C                   KFLD                    XWAACS                         033600070202     C*-                                                                        033700070131     C                   MOVE      '0'           *IN99                          033800070201     C                   MOVE      *BLANKS       ZMSAGE                         033900070201     C                   DO                                                     034000070306     C     XWABCD        CHAIN     STKMAS                             99        034100070131     C     *IN99         IFEQ      '1'                                          034200070202     C                   MOVE      'OEM0003'     MSGID                          034300070131     C                   CALL      RTNMTX                                       034400070131     C                   PARM                    MSGID             7            034500070131     C                   PARM                    ERRMSG          132            034600070212     C                   MOVEL     *ALL'-'       XWHLTX                         034700070201     C                   LEAVE                                                  034800070201     C                   ENDIF                                                  034900070219     C*- IF ADDITION, PULL THE PRICE FROM FILE                                  035000070212     C     *IN06         IFEQ      '1'                                          035100070212     C                   Z-ADD     XWANPR        XWPRIC                         035200070212     C                   END                                                    035300070219     C*-                                                                        035400070306     C     XWAACS        CHAIN     STOMAS                             99        035500070131     C     *IN99         IFEQ      '1'                                          035600070202     C                   MOVE      'OES0369'     MSGID                          035700070131     C                   CALL      RTNMTX                                       035800070131     C                   PARM                    MSGID             7            035900070131     C                   PARM                    ERRMSG          132            036000070212     C                   MOVEL     *ALL'-'       XWDESC                         036100070201     C                   LEAVE                                                  036200070201     C                   ENDIF                                                  036300070202     C     KEY002        CHAIN     STKBAL                             99        036400070202     C     *IN99         IFEQ      '1'                                          036500070202     C     XWA5QT        ORGT      XWBHQT                                       036600070202     C                   MOVE      'OES0370'     MSGID                          036700070202     C                   CALL      RTNMTX                                       036800070202     C                   PARM                    MSGID             7            036900070202     C                   PARM                    ERRMSG          132            037000070202     C                   MOVE      '1'           *IN99                          037100070202     C                   LEAVE                                                  037200070202     C                   ENDIF                                                  037300070219     C*- TRANSACTION TYPE                                                       037400070306     C     XWRICD        CHAIN     TRNTYP                             99        037500070215     C     *IN99         IFEQ      '1'                                          037600070215     C                   MOVEL     *ALL'-'       XWTDSC                         037700070212     C                   MOVE      'OES0371'     MSGID                          037800070209     C                   CALL      RTNMTX                                       037900070209     C                   PARM                    MSGID             7            038000070209     C                   PARM                    ERRMSG          132            038100070209     C                   LEAVE                                                  038200070215     C                   ENDIF                                                  038300070219     C*- UNIT OF MEASURE                                                        038400070212     C                   CLEAR                   UMDES                          038500070209     C                   SELECT                                                 038600070209     C     XWA2CD        WHENEQ    'EAC'                                        038700070209     C                   MOVEL     UM(1)         UMDES                          038800070209     C                   OTHER                                                  038900070209     C                   MOVE      '1'           *IN99                          039000070212     C                   MOVEL     *ALL'-'       UMDES                          039100070212     C                   MOVE      'OES0372'     MSGID                          039200070209     C                   CALL      RTNMTX                                       039300070209     C                   PARM                    MSGID             7            039400070209     C                   PARM                    ERRMSG          132            039500070209     C                   LEAVE                                                  039600070209     C                   ENDSL                                                  039700070201     C                   ENDDO                                                  039800070131     C                   ENDSR                                                  039900070130     C*****************************************************                     040000070130     C*****************************************************                     040100070201     C     ORDHED        BEGSR                                                  040200070130     C*****************************************************                     040300070201     C*‚Subroutine: Order Header                                                040400070130     C*****************************************************                     040500070202     C     *IN03         DOWEQ     '0'                                          040600070202     C     *IN12         ANDEQ     '0'                                          040700070202     C                   EXFMT     ZZFT02                                       040800070202     C                   ENDDO                                                  040900070201     C                   ENDSR                                                  041000070201     C*****************************************************                     041100070201     C*****************************************************                     041200070201     C     *INZSR        BEGSR                                                  041300070201     C*****************************************************                     041400070201     C*‚Subroutine: Initialisation routines                                     041500070201     C*****************************************************                     041600070201     C     *ENTRY        PLIST                                                  041700070201     C                   PARM                    XWORDN                         041800070201     C                   PARM                    XWBCCD                         041900070201     C                   PARM                    XWG4TX                         042000070130     C*‚Initialise message subfile                                              042100070130     C                   MOVE      '1'           *IN32                          042200070201     C                   MOVEL     'WWCONDET'    ZZPGM                          042300070130     C*-‚Set date                                                               042400070130     C                   MOVE      *DATE         ZZDATE                         042500070201     C*-                                                                        042600070215     C*- CONTRACT                                                               042700070306     C     XWORDN        CHAIN     CONHDR                             99        042800070215     C*- CUSTOMER                                                               042900070306     C     XWBCCD        CHAIN     CUSTS                              99        043000070215     C   99              MOVEL     *ALL'-'       XWG4TX                         043100070215     C*- REPRESENTATIVE                                                         043200070306     C     PERSON        CHAIN     SLMEN                              99        043300070215     C   99              MOVEL     *ALL'-'       PNAME                          043400070215     C*- STATUS                                                                 043500070306     C     XWSTAT        CHAIN     ORDSTS                             99        043600070215     C   99              MOVEL     *ALL'-'       XWSDSC                         043700070215     C                   ENDSR                                                  043800070215     C*****************************************************                     043900070215     C*****************************************************                     044000070215     C     SRPROM        BEGSR                                                  044100070215     C*****************************************************                     044200070215     C*‚Subroutine: prompts for F04                                             044300070215     C*****************************************************                     044400070215     C                   SELECT                                                 044500070219     C*- PRODUCT                                                                044600070215     C     SFIELD        WHENEQ    'XWABCD'                                     044700070215     C                   CALL      'STKMASEL'                                   044800070215     C                   PARM                    XWABCD                         044900070215     C                   PARM                    XWHLTX                         045000070219     C*- STORE                                                                  045100070215     C     SFIELD        WHENEQ    'XWAACS'                                     045200070215     C                   CALL      'STOMASEL'                                   045300070215     C                   PARM                    XWAACS                         045400070215     C                   PARM                    XWDESC                         045500070219     C*- TRANSACTION TYPE                                                       045600070215     C     SFIELD        WHENEQ    'XWRICD'                                     045700070215     C                   CALL      'TRNTPSEL'                                   045800070215     C                   PARM                    XWRICD                         045900070215     C                   PARM                    XWTDSC                         046000070215     C                   ENDSL                                                  046100070215     C                   ENDSR                                                  046200070209**                                                                              046300070209Each KGS                                                                        