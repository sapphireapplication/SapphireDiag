000100070317     H*‚--------------------------------------------------------------------    000200080123     H*ˆCOPYRIGHT DATABOROUGH LTD 2007                                          000300070201     H*ˆPROGRAM:  Work with Order Details                                       000400010705     H*‚--------------------------------------------------------------------    000500070131     H DATEDIT(*YMD)                                                            000600980122     F**********************************************************************    000700990528     F*‚F i l e s                                                               000800980122     F**********************************************************************    000900070201     FWCONDETD  CF   E             WORKSTN                                      001000070130     F                                     SFILE(ZZSF01:SFLRRN)                 001100070201     FCONDET    UF A E           K DISK                                         001200070131     FCUSTS     IF   E           K DISK                                         001300070813     F                                     INFDS(FILEDS)                        001400070201     FSTKMAS    IF   E           K DISK                                         001500070201     FSTOMAS    IF   E           K DISK                                         001600070202     FSTKBAL    IF   E           K DISK                                         001700070202     F*-                                                                        001800070202     FCONHDR    IF   E           K DISK                                         001900070202     FSLMEN     IF   E           K DISK                                         002000070215     FORDSTS    IF   E           K DISK                                         002100070215     FTRNTYP    IF   E           K DISK                                         002200070209     D**********************************************************************    002300070813                                                                                002400070813     d FILEDS          ds                                                       002500070813     d  FILESTS               11     15s 0                                      002600070813                                                                                002700070209     D UM              S             11    DIM(1) CTDATA PERRCD(1)              002800070131     D RTNMTX          C                   CONST('RTNMSGTEXT')                  002900070130     I**********************************************************************    003000070201     ICUSTSR                                                                    003100070201     I              PERSON                      PERCUS                          003200070202     ISTKBALR                                                                   003300070202     I              XWA2CD                      WA2CD                           003400080123     C**********************************************************************    003500070130     C*‚D e f i n i t i o n s                                                   003600080123     C**********************************************************************    003700070130     C                   MOVE      '0'           SFLCHG            1            003800070130     C                   MOVE      *ZEROS        SFLRRN            5 0          003900080123     C**********************************************************************    004000070130     C*‚M a i n l i n e   C o d e                                               004100080123     C**********************************************************************    004200070130     C     *IN03         DOWEQ     '0'                                          004300070130     C     *IN12         ANDEQ     '0'                                          004400070219     C*‚Build subfile                                                           004500070130     C                   EXSR      SFLWRT                                       004600070219     C*‚Display screens                                                         004700070201     C                   WRITE     ZZTR01                                       004800070131     C                   EXFMT     ZZCT01                                       004900070219     C*‚Remove messages                                                         005000070130     C                   CALL      'XBCCLMSG'                                   005100070131     C     *IN03         IFEQ      '1'                                          005200070131     C     *IN12         OREQ      '1'                                          005300070131     C                   LEAVE                                                  005400070131     C                   ENDIF                                                  005500070215     C                   MOVE      *BLANKS       ZMSAGE                         005501110914     C***                MOVE      *BLANKS       ZName                          005600070219     C*‚Action command keys                                                     005700070130     C     *IN28         IFEQ      '1'                                          005800070130     C                   EXSR      CMDKEY                                       005900070130     C                   ELSE                                                   006000070219     C*‚Else action selections                                                  006100070130     C                   EXSR      ZSELEC                                       006200070130     C                   ENDIF                                                  006300070130     C                   ENDDO                                                  006301110914                                                                                006400070131     C                   MOVE      '1'           *INLR                          006500070131     C                   RETURN                                                 006600080123     C**********************************************************************    006700070130     C*‚L o g i c a l   E n d   o f   P r o g r a m                             006800080123     C**********************************************************************    006900080123     C*                                                                         007000080123     C**********************************************************************    007100070130     C     SFLWRT        BEGSR                                                  007200080123     C**********************************************************************    007300070130     C*‚Subroutine: Write data to subfile                                       007400080123     C**********************************************************************    007500070130     C*‚Delete subfile                                                          007600070131     C                   SETON                                        74        007700070131     C                   SETOFF                                       717231    007800070205     C                   WRITE     ZZCT01                                       007900070131     C                   SETOFF                                       74        008000070130     C*‚Write subfile                                                           008100070130     C                   MOVE      *ZEROS        SFLRRN                         008200070201     C     XWORDN        SETLL     CONDET                                       008300080121     C     XWORDN        READE(N)  CONDET                                 31    008400070131     C     *IN31         DOWEQ     '0'                                          008500070130     C                   ADD       1             SFLRRN                         008600070130     C                   MOVE      *BLANKS       DSSEL                          008700070209     C                   MOVEL     XWABCD        SWABCD                         008800070215     C                   MOVEL     XWT8TX        SWT8TX                         008900070306     C     XWABCD        CHAIN     STKMAS                             99        009000080123     C     *IN99         IFEQ      '1'                                          009100080123     C                   MOVEL     *ALL'-'       XWHLTX                         009200080123     C                   ENDIF                                                  009300070205     C                   WRITE     ZZSF01                                       009400080121     C     XWORDN        READE(N)  CONDET                                 31    009500070130     C                   ENDDO                                                  009600070130     C*-                                                                        009700070130     C     SFLRRN        IFGT      *ZEROS                                       009800070130     C     SFLCHG        IFEQ      '0'                                          009900080123     C                   Z-ADD     1             SHWREC                         010000070130     C                   ENDIF                                                  010100080123     C     SHWREC        IFGT      SFLRRN                                       010200080123     C     SHWREC        ORLT      1                                            010300080123     C                   Z-ADD     1             SHWREC                         010400070130     C                   ENDIF                                                  010500100927                                                                                010600100927      *  Richard T: 27 Sep 2010                                                 010700100927      *  Ensure SFLDSP is on only when there are records to display:            010800100927     C                   If        SFLRRN > 0                                   010900100927     C                   Eval      *IN71 = *ON                                  011000100927     C                   Else                                                   011100100927     C                   Eval      *IN71 = *OFF                                 011200100927     C                   EndIf                                                  011300100927                                                                                011400070130     C                   ENDIF                                                  011500070131     C                   SETON                                        72        011600070130     C                   ENDSR                                                  011700080123     C**********************************************************************    011800080123     C*                                                                         011900080123     C**********************************************************************    012000070130     C     ZSELEC        BEGSR                                                  012100080123     C**********************************************************************    012200070130     C*‚Subroutine: Action selection                                            012300080123     C**********************************************************************    012400070130     C                   MOVE      '0'           SFLCHG                         012500070130     C                   READC     ZZSF01                                 35    012600070130     C*‚For each selection                                                      012700070130     C     *IN35         DOWEQ     '0'                                          012800070130     C                   MOVE      '1'           SFLCHG                         012900070130     C                   SELECT                                                 013000070219     C*‚Change                                                                  013100070130     C     DSSEL         WHENEQ    '2'                                          013200080123     C                   EXSR      CHGREC                                       013300070219     C*‚Delete                                                                  013400080123     C     DSSEL         WHENEQ    '4'                                          013500080123     C                   EXSR      DELREC                                       013600070219     C*‚Display                                                                 013700080123     C     DSSEL         WHENEQ    '5'                                          013800080123     C                   EXSR      DSPREC                                       013900080123     C                   ENDSL                                                  014000080123     C                   MOVE      SFLRRN        SHWREC                         014100070130     C                   MOVE      *BLANKS       DSSEL                          014101110914     C**                 MOVE      *BLANKS       DSTRN                          014200070205     C                   UPDATE    ZZSF01                                       014300070130     C                   READC     ZZSF01                                 35    014400070219     C*‚End: For each selection                                                 014500070130     C                   ENDDO                                                  014600070130     C                   MOVE      '0'           *IN12                          014700070130     C                   ENDSR                                                  014800080123     C**********************************************************************    014900080123     C*                                                                         015000080123     C**********************************************************************    015100080123     C     DSPSCN        BEGSR                                                  015200080123     C**********************************************************************    015300080123     C*‚Subroutine: Process screen                                              015400080123     C**********************************************************************    015500080123     C     *IN99         IFEQ      '1'                                          015600080123     C                   WRITE     ZZMC01                                       015700080123     C                   ENDIF                                                  015800080123     C                   EXFMT     ZZFT01                                       015900080123     C                   CALL      'XBCCLMSG'                                   016000080123     C                   MOVE      *BLANKS       ZMSAGE                         016100080123     C                   SELECT                                                 016200080123     C*- Prompt                                                                 016300080123     C     *IN04         WHENEQ    '1'                                          016400080123     C                   EXSR      SRPROM                                       016500080123     C                   ENDSL                                                  016600080123     C                   ENDSR                                                  016700080123     C**********************************************************************    016800080123     C*                                                                         016900080123     C**********************************************************************    017000080123     C     DSPREC        BEGSR                                                  017100080123     C**********************************************************************    017200080123     C*‚Subroutine: Display a record                                            017300080123     C**********************************************************************    017400080123     C                   MOVE      '1'           *IN34                          017500080123     C                   MOVE      '0'           *IN37                          017600080123     C                   MOVEL     ' DISPLAY'    ACTDSP                         017700080123     C                   EXSR      GETREC                                       017800080123     C     *IN03         DOWEQ     '0'                                          017900080123     C     *IN12         ANDEQ     '0'                                          018000080123     C                   EXSR      DSPSCN                                       018100080123     C                   ENDDO                                                  018200080123     C                   ENDSR                                                  018300080123     C**********************************************************************    018400080123     C*                                                                         018500080123     C**********************************************************************    018600080123     C     CHGREC        BEGSR                                                  018700080123     C**********************************************************************    018800080124     C*‚Subroutine: Change a record                                             018900080123     C**********************************************************************    019000080123     C                   MOVEL     '  UPDATE'    ACTDSP                         019100080123     C                   MOVE      '0'           *IN34                          019200080123     C                   MOVE      '0'           *IN37                          019300080123     C                   EXSR      GETREC                                       019400080123     C*                                                                         019500080123     C     *IN03         DOWEQ     '0'                                          019600080123     C     *IN12         ANDEQ     '0'                                          019700080123     C*                                                                         019800080123     C                   EXSR      DSPSCN                                       019900080123     C                   EXSR      VALIDT                                       020000080123     C     *IN99         IFEQ      '1'                                          020100080123     C                   MOVEL     ERRMSG        ZMSAGE                         020200080123     C                   ITER                                                   020300080123     C                   ENDIF                                                  020400080123     C*                                                                         020500080123     C     *IN03         IFEQ      '0'                                          020600080123     C     *IN12         ANDEQ     '0'                                          020700080123     C                   EXFMT     ZZCNF1                                       020800080123     C     *IN03         IFEQ      '0'                                          020900080123     C     *IN12         ANDEQ     '0'                                          021000080123     C                   EXSR      UPDREC                                       021100080123     C                   LEAVE                                                  021200080123     C                   ENDIF                                                  021300080123     C                   ENDIF                                                  021400080123     C*                                                                         021500080123     C                   ENDDO                                                  021600080123     C*                                                                         021700080123     C                   ENDSR                                                  021800080123     C**********************************************************************    021900080123     C*                                                                         022000080123     C**********************************************************************    022100080123     C     DELREC        BEGSR                                                  022200080123     C**********************************************************************    022300080123     C*‚Subroutine: Delete a record                                             022400080123     C**********************************************************************    022500080123     C                   MOVEL     '  DELETE'    ACTDSP                         022600080123     C                   MOVE      '1'           *IN34                          022700080123     C                   MOVE      '1'           *IN37                          022800080123     C                   EXSR      GETREC                                       022900080123     C*                                                                         023000080123     C     *IN03         DOWEQ     '0'                                          023100080123     C     *IN12         ANDEQ     '0'                                          023200080123     C                   EXSR      DSPSCN                                       023300100518     C     *IN23         IFEQ      '1'                                          023400100518     C                   LEAVE                                                  023500100518     C                   ENDIF                                                  023600100518     C                   ENDDO                                                  023700100518     C*                                                                         023800080123     C     *IN23         IFEQ      '1'                                          023900100518     C                   EXFMT     ZZCNF1                               99      024000100518     C     *IN03         IFNE      '1'                                          024100100518     C     *IN12         ANDNE     '1'                                          024200080123     C     KEY001        CHAIN     CONDET                             3666      024300080123     C     *IN36         IFEQ      *OFF                                         024400080123     C     *IN66         ANDEQ     *OFF                                         024500080123     C                   DELETE    CONDETR                              99      024600080123     C                   ENDIF                                                  024700080123     C                   ENDIF                                                  024800100518     C                   ENDIF                                                  024900080123     C*                                                                         025000080123     C                   ENDSR                                                  025100080123     C**********************************************************************    025200080123     C*                                                                         025300080123     C**********************************************************************    025400080123     C     ADDREC        BEGSR                                                  025500080123     C**********************************************************************    025600070130     C*‚Subroutine: Add record                                                  025700080123     C**********************************************************************    025800070130     C                   MOVE      '0'           *IN34                          025900070131     C                   MOVE      '1'           *IN36                          026000070302     C                   MOVE      '0'           *IN37                          026100070131     C                   MOVEL     'ADDITION'    ACTDSP                         026200070201     C                   CLEAR                   XWABCD                         026300070201     C                   CLEAR                   XWAACS                         026400070201     C                   CLEAR                   XWT8TX                         026500070209     C                   MOVE      'INV'         XWRICD                         026600070306     C     XWRICD        CHAIN     TRNTYP                             99        026700080123     C     *IN99         IFEQ      '1'                                          026800080123     C                   MOVEL     *ALL'-'       XWTDSC                         026900080123     C                   ENDIF                                                  027000070201     C                   CLEAR                   XWA5QT                         027100070209     C                   MOVE      'EAC'         XWA2CD                         027200070209     C                   MOVEL     UM(1)         UMDES                          027300070201     C                   CLEAR                   XWPRIC                         027400070205     C                   CLEAR                   XWHLTX                         027500070205     C                   CLEAR                   XWDESC                         027501110914     C**                 CLEAR                   XWNAME                         027600080123     C*                                                                         027700070130     C     *IN03         DOWEQ     '0'                                          027800070130     C     *IN12         ANDEQ     '0'                                          027900080123     C*                                                                         028000080123     C                   EXSR      DSPSCN                                       028100070131     C                   EXSR      VALIDT                                       028200080123     C     *IN99         IFEQ      '0'                                          028300080123     C                   Z-ADD     XWANPR        XWPRIC                         028400080123     C                   ENDIF                                                  028500080123     C     *IN99         IFEQ      '1'                                          028600080123     C                   MOVEL     ERRMSG        ZMSAGE                         028700080123     C                   ITER                                                   028800080123     C                   ENDIF                                                  028900080123     C*                                                                         029000080123     C     *IN03         IFEQ      '0'                                          029100080123     C     *IN12         ANDEQ     '0'                                          029200080123     C                   EXFMT     ZZCNF1                                       029300080123     C     *IN03         IFEQ      '0'                                          029400080123     C     *IN12         ANDEQ     '0'                                          029500080123     C                   WRITE     CONDETR                              99      029600080123     C     *IN99         IFEQ      '1'                                          029700080123     C                   MOVE      'Y2U0004'     MSGID                          029800080123     C                   CALL      RTNMTX                                       029900080123     C                   PARM                    MSGID             7            030000080123     C                   PARM                    ERRMSG          132            030100080123     C* Display error message                                                   030200080123     C                   MOVEL     ERRMSG        ZMSAGE                         030300080123     C                   ENDIF                                                  030400080123     C                   LEAVE                                                  030500080123     C                   ENDIF                                                  030600080123     C                   ENDIF                                                  030700080123     C*                                                                         030800080123     C                   ENDDO                                                  030900080123     C*                                                                         031000070130     C                   ENDSR                                                  031100080123     C**********************************************************************    031200080123     C*                                                                         031300080123     C**********************************************************************    031400070130     C     CMDKEY        BEGSR                                                  031500080123     C**********************************************************************    031600070130     C*‚Subroutine: Action command keys                                         031700080123     C**********************************************************************    031800070130     C                   SELECT                                                 031900070130     C     *IN06         WHENEQ    '1'                                          032000080123     C                   EXSR      ADDREC                                       032100070130     C                   ENDSL                                                  032200070131     C                   MOVE      '0'           *IN12                          032300070130     C                   ENDSR                                                  032400080123     C**********************************************************************    032500080123     C*                                                                         032600080123     C**********************************************************************    032700070131     C     VALIDT        BEGSR                                                  032800080123     C**********************************************************************    032900070131     C*‚Subroutine: Validation                                                  033000080123     C**********************************************************************    033100070202     C     KEY002        KLIST                                                  033200070202     C                   KFLD                    XWABCD                         033300070202     C                   KFLD                    XWAACS                         033400070202     C*-                                                                        033500070131     C                   MOVE      '0'           *IN99                          033600070201     C                   MOVE      *BLANKS       ZMSAGE                         033700070201     C                   DO                                                     033800070306     C     XWABCD        CHAIN     STKMAS                             99        033900070131     C     *IN99         IFEQ      '1'                                          034000070202     C                   MOVE      'OEM0003'     MSGID                          034100070131     C                   CALL      RTNMTX                                       034200070131     C                   PARM                    MSGID             7            034300070131     C                   PARM                    ERRMSG          132            034400070212     C                   MOVEL     *ALL'-'       XWHLTX                         034500070201     C                   LEAVE                                                  034501110914     C**                 iter                                                   034600070201     C                   ENDIF                                                  034700070219     C*- IF ADDITION, PULL THE PRICE FROM FILE                                  034800070212     C     *IN06         IFEQ      '1'                                          034900070212     C                   Z-ADD     XWANPR        XWPRIC                         035000070212     C                   END                                                    035100070219     C*-                                                                        035200070306     C     XWAACS        CHAIN     STOMAS                             99        035300070131     C     *IN99         IFEQ      '1'                                          035400070202     C                   MOVE      'OES0369'     MSGID                          035500070131     C                   CALL      RTNMTX                                       035600070131     C                   PARM                    MSGID             7            035700070131     C                   PARM                    ERRMSG          132            035800070212     C                   MOVEL     *ALL'-'       XWDESC                         035900070201     C                   LEAVE                                                  036000070201     C                   ENDIF                                                  036100070202     C     KEY002        CHAIN     STKBAL                             99        036200070202     C     *IN99         IFEQ      '1'                                          036300070202     C     XWA5QT        ORGT      XWBHQT                                       036400070202     C                   MOVE      'OES0370'     MSGID                          036500070202     C                   CALL      RTNMTX                                       036600070202     C                   PARM                    MSGID             7            036700070202     C                   PARM                    ERRMSG          132            036800070202     C                   MOVE      '1'           *IN99                          036900070202     C                   LEAVE                                                  036901110914     C**                 iter                                                   037000070202     C                   ENDIF                                                  037100070219     C*- TRANSACTION TYPE                                                       037200070306     C     XWRICD        CHAIN     TRNTYP                             99        037300070215     C     *IN99         IFEQ      '1'                                          037400070215     C                   MOVEL     *ALL'-'       XWTDSC                         037500070212     C                   MOVE      'OES0371'     MSGID                          037600070209     C                   CALL      RTNMTX                                       037700070209     C                   PARM                    MSGID             7            037800070209     C                   PARM                    ERRMSG          132            037900070209     C                   LEAVE                                                  038000070215     C                   ENDIF                                                  038100070219     C*- UNIT OF MEASURE                                                        038200070212     C                   CLEAR                   UMDES                          038300070209     C                   SELECT                                                 038400070209     C     XWA2CD        WHENEQ    'EAC'                                        038500070209     C                   MOVEL     UM(1)         UMDES                          038600070209     C                   OTHER                                                  038700070209     C                   MOVE      '1'           *IN99                          038800070212     C                   MOVEL     *ALL'-'       UMDES                          038900070212     C                   MOVE      'OES0372'     MSGID                          039000070209     C                   CALL      RTNMTX                                       039100070209     C                   PARM                    MSGID             7            039200070209     C                   PARM                    ERRMSG          132            039300070209     C                   LEAVE                                                  039400070209     C                   ENDSL                                                  039500070201     C                   ENDDO                                                  039600070131     C                   ENDSR                                                  039700080123     C**********************************************************************    039800080123     C*                                                                         039900080123     C**********************************************************************    040000080123     C     GETREC        BEGSR                                                  040100080123     C**********************************************************************    040200080123     C*‚Subroutine: Retrieve record                                             040300080123     C**********************************************************************    040400080123     C     KEY001        CHAIN(N)  CONDET                             3666      040500080123     C     *IN36         IFEQ      '1'                                          040600080123     C                   MOVE      'OES0115'     MSGID                          040700080123     C                   CALL      RTNMTX                                       040800080123     C                   PARM                    MSGID             7            040900080123     C                   PARM                    ERRMSG          132            041000080123     C                   MOVEL     ERRMSG        ZMSAGE                         041100080123     C                   ELSE                                                   041200080123     C     *IN66         IFEQ      *ON                                          041300080123     C     FILESTS       IFEQ      1218                                         041400080123     C                   MOVE      'Y3U9999'     MSGID                          041500080123     C                   CALL      RTNMTX                                       041600080123     C                   PARM                    MSGID             7            041700080123     C                   PARM                    ERRMSG          132            041800080123     C                   MOVEL     ERRMSG        ZMSAGE                         041900080123     C                   ELSE                                                   042000080123     C                   MOVE      'OEM0004'     MSGID                          042100080123     C                   CALL      RTNMTX                                       042200080123     C                   PARM                    MSGID             7            042300080123     C                   PARM                    ERRMSG          132            042400080123     C                   MOVEL     ERRMSG        ZMSAGE                         042500080123     C                   ENDIF                                                  042600080123     C                   ELSE                                                   042700080123     C                   EXSR      VALIDT                                       042800080123     C                   ENDIF                                                  042900080123     C                   ENDIF                                                  043000080123     C                   ENDSR                                                  043100080123     C**********************************************************************    043200080123     C*                                                                         043300080123     C**********************************************************************    043400080123     C     UPDREC        BEGSR                                                  043500080123     C**********************************************************************    043600080123     C*‚Subroutine: Update record                                               043700080123     C**********************************************************************    043800080123     C                   EXSR      SAVEDATA                                     043900080123     C     KEY001        CHAIN     CONDET                             3666      044000080123     C     *IN36         IFEQ      *OFF                                         044100080123     C     *IN66         ANDEQ     *OFF                                         044200080123     C                   EXSR      RESTOREDATA                                  044300080123     C                   UPDATE    CONDETR                              99      044400080123     C     *IN99         IFEQ      '1'                                          044500080123     C                   MOVE      'Y2U0007'     MSGID                          044600080123     C                   CALL      RTNMTX                                       044700080123     C                   PARM                    MSGID             7            044800080123     C                   PARM                    ERRMSG          132            044900080123     C* Display error message                                                   045000080123     C                   MOVEL     ERRMSG        ZMSAGE                         045100080123     C                   ENDIF                                                  045200080123     C                   ELSE                                                   045300080123     C                   MOVE      'Y2U0007'     MSGID                          045400080123     C                   CALL      RTNMTX                                       045500080123     C                   PARM                    MSGID             7            045600080123     C                   PARM                    ERRMSG          132            045700080123     C* Display error message                                                   045800080123     C                   MOVEL     ERRMSG        ZMSAGE                         045900080123     C                   ENDIF                                                  046000080123     C                   ENDSR                                                  046100080123     C**********************************************************************    046200080123     C*                                                                         046300080123     C**********************************************************************    046400080123     C     *INZSR        BEGSR                                                  046500080123     C**********************************************************************    046600080123     C*‚Subroutine: Initialisation routines                                     046700080123     C**********************************************************************    046800070201     C     *ENTRY        PLIST                                                  046900070201     C                   PARM                    XWORDN                         047000070201     C                   PARM                    XWBCCD                         047100070201     C                   PARM                    XWG4TX                         047200070130     C*‚Initialise message subfile                                              047300070130     C                   MOVE      '1'           *IN32                          047400070201     C                   MOVEL     'WWCONDET'    ZZPGM                          047500070130     C*-‚Set date                                                               047600070130     C                   MOVE      *DATE         ZZDATE                         047700070201     C*-                                                                        047800070215     C*- CONTRACT                                                               047900070306     C     XWORDN        CHAIN     CONHDR                             99        048000070215     C*- CUSTOMER                                                               048100070306     C     XWBCCD        CHAIN     CUSTS                              99        048200080123     C     *IN99         IFEQ      '1'                                          048300080123     C                   MOVEL     *ALL'-'       XWG4TX                         048400080123     C                   ENDIF                                                  048500070215     C*- REPRESENTATIVE                                                         048600070306     C     PERSON        CHAIN     SLMEN                              99        048700080123     C     *IN99         IFEQ      '1'                                          048800080123     C                   MOVEL     *ALL'-'       PNAME                          048900080123     C                   ENDIF                                                  049000070215     C*- STATUS                                                                 049100070306     C     XWSTAT        CHAIN     ORDSTS                             99        049200080123     C     *IN99         IFEQ      '1'                                          049300080123     C                   MOVEL     *ALL'-'       XWSDSC                         049400080123     C                   ENDIF                                                  049500080123     C*-                                                                        049600080123     C     KEY001        KLIST                                                  049700080123     C                   KFLD                    XWORDN                         049800080123     C                   KFLD                    XWABCD                         049900080123     C*-                                                                        050000070215     C                   ENDSR                                                  050100080123     C**********************************************************************    050200080123     C*                                                                         050300080123     C**********************************************************************    050400070215     C     SRPROM        BEGSR                                                  050500080123     C**********************************************************************    050600070215     C*‚Subroutine: prompts for F04                                             050700080123     C**********************************************************************    050800070215     C                   SELECT                                                 050900070219     C*- PRODUCT                                                                051000070215     C     SFIELD        WHENEQ    'XWABCD'                                     051100070215     C                   CALL      'STKMASEL'                                   051200070215     C                   PARM                    XWABCD                         051300070215     C                   PARM                    XWHLTX                         051400070219     C*- STORE                                                                  051500070215     C     SFIELD        WHENEQ    'XWAACS'                                     051600070215     C                   CALL      'STOMASEL'                                   051700070215     C                   PARM                    XWAACS                         051800070215     C                   PARM                    XWDESC                         051900070219     C*- TRANSACTION TYPE                                                       052000070215     C     SFIELD        WHENEQ    'XWRICD'                                     052100070215     C                   CALL      'TRNTPSEL'                                   052200070215     C                   PARM                    XWRICD                         052300070215     C                   PARM                    XWTDSC                         052400070215     C                   ENDSL                                                  052500070215     C                   ENDSR                                                  052600080123     C**********************************************************************    052700080121     C     SAVEDATA      BEGSR                                                  052800080123     C**********************************************************************    052900080121     C*‚Subroutine: Save current data                                           053000080123     C**********************************************************************    053100080121     C                   MOVE      XWORDN        ZWORDN                         053200080121     C                   MOVE      XWABCD        ZWABCD                         053300080121     C                   MOVE      XWAACS        ZWAACS                         053400080121     C                   MOVE      XWT8TX        ZWT8TX                         053500080121     C                   MOVE      XWRICD        ZWRICD                         053600080121     C                   MOVE      XWA5QT        ZWA5QT                         053700080121     C                   MOVE      XWA2CD        ZWA2CD                         053800080121     C                   MOVE      XWPRIC        ZWPRIC                         053900080121                                                                                054000080121     C     *LIKE         DEFINE    XWORDN        ZWORDN                         054100080121     C     *LIKE         DEFINE    XWABCD        ZWABCD                         054200080121     C     *LIKE         DEFINE    XWAACS        ZWAACS                         054300080121     C     *LIKE         DEFINE    XWT8TX        ZWT8TX                         054400080121     C     *LIKE         DEFINE    XWRICD        ZWRICD                         054500080121     C     *LIKE         DEFINE    XWA5QT        ZWA5QT                         054600080121     C     *LIKE         DEFINE    XWA2CD        ZWA2CD                         054700080121     C     *LIKE         DEFINE    XWPRIC        ZWPRIC                         054800080121                                                                                054900080121     C                   ENDSR                                                  055000080123     C**********************************************************************    055100080121                                                                                055200080123     C**********************************************************************    055300080121     C     RESTOREDATA   BEGSR                                                  055400080123     C**********************************************************************    055500080121     C*‚Subroutine: Restore current data                                        055600080123     C**********************************************************************    055700080121     C                   MOVE      ZWORDN        XWORDN                         055800080121     C                   MOVE      ZWABCD        XWABCD                         055900080121     C                   MOVE      ZWAACS        XWAACS                         056000080121     C                   MOVE      ZWT8TX        XWT8TX                         056100080121     C                   MOVE      ZWRICD        XWRICD                         056200080121     C                   MOVE      ZWA5QT        XWA5QT                         056300080121     C                   MOVE      ZWA2CD        XWA2CD                         056400080121     C                   MOVE      ZWPRIC        XWPRIC                         056500080121                                                                                056600080121     C                   ENDSR                                                  056700080123     C**********************************************************************    056800070209**                                                                              056900070209Each KGS                                                                        